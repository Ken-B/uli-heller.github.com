<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Was ich so treibe...]]></title>
  <link href="http://uli-heller.github.com/atom.xml" rel="self"/>
  <link href="http://uli-heller.github.com/"/>
  <updated>2013-07-27T09:55:12+02:00</updated>
  <id>http://uli-heller.github.com/</id>
  <author>
    <name><![CDATA[Uli Heller]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
    <entry>
      




<title type="html"><![CDATA[Subversion 1.8.1 für Ubuntu-12.04]]></title>
<link href="http://uli-heller.github.com/2013/07/27/subversion_1.8.1/"/>
<updated>2013-07-27T10:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/07/27/subversion_1.8.1</id>

      <content type="html"><![CDATA[<p>Vor ein paar Tagen wurde Subversion-1.8.1 veröffentlicht.
Hier meine Versuche, ein Paket für Ubuntu-12.04 zu bauen.
Eingeflossen sind dabei auch die gescheiterten Versuche
mit Subversion-1.8.0. Schlußendlich kommt eine für mich funktionierende
Version von Subversion-1.8.1 heraus.</p>

<!-- more -->


<h2>Ausgangpunkt: Subversion-1.8.0</h2>

<p>Mein Ausgangspunkt sind meine kaputten Pakete für Subversion-1.8.0.</p>

<pre><code>$ cd subversion-1.8.0
$ uupdate -u ../subversion-1.8.1
$ cd ../subversion-1.8.1
</code></pre>

<p>Nun habe ich folgende Generierungs-Abhängigkeiten (build dependencies)
festgelegt:</p>

<ul>
<li>subversion: serf-1.2.1 und sqlite-3.7.15</li>
<li>serf: sqlite-3.7.15</li>
</ul>


<h2>Erste Hürde: Sqlite3-3.7.15</h2>

<p>Subversion benötigt eine relativ aktuelle Version von Sqlite3. Die
Standard-Version von Ubuntu-12.04 ist zu alt. Ich habe mir so beholfen:</p>

<ul>
<li>Quellpakete von sqlite3-3.7.15.2 aus &#8220;raring&#8221; runtergeladen</li>
<li>Ein paar kleine Anpassungen an debian/rules vorgenommen, damit
tcl85 an der richtigen Stelle ausgelesen wird</li>
<li>Pakete erzeugen mit <code>dpkg-buildpackage</code></li>
<li>Pakete installieren</li>
</ul>


<h2>Zweite Hürde: Serf-1.2.1</h2>

<ul>
<li>Diverse Umstellungen nötig, damit die Generierung durchläuft</li>
<li>Pakete erzeugen mit <code>dpkg-buildpackage</code></li>
<li>Pakete installieren</li>
</ul>


<h2>Subversion-1.8.1</h2>

<ul>
<li>Kann nun wie üblich mit <code>dpkg-buildpackage</code> erzeugt werden</li>
</ul>


<h2>Kurztests: Installation und Funktionsweise</h2>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$ sudo dpkg -i subversion_1.8.1-3dp12~precise1_amd64.deb libsvn1_1.8.1-3dp12~precise1_amd64.deb libserf1_1.2.1-0dp01~precise1_amd64.deb
</span><span class='line'>$ sudo dpkg -i sqlite3_3.7.15.2-1dp01~precise1_amd64.deb libsqlite3-0_3.7.15.2-1dp01~precise1_amd64.deb
</span><span class='line'>$ svn --version
</span><span class='line'>svn, Version 1.8.1 (r1503906)
</span><span class='line'>   übersetzt am Jul 26 2013, um 15:38:27 auf x86_64-pc-linux-gnu
</span><span class='line'>
</span><span class='line'>Copyright (C) 2013 The Apache Software Foundation.
</span><span class='line'>Diese Software besteht aus Beiträgen vieler Personen;
</span><span class='line'>siehe Datei NOTICE für weitere Informationen.
</span><span class='line'>Subversion ist Open Source Software, siehe http://subversion.apache.org/
</span><span class='line'>
</span><span class='line'>Die folgenden ZugriffsModule (ZM) für Projektarchive stehen zur Verfügung:
</span><span class='line'>
</span><span class='line'>* ra_svn : Modul zum Zugriff auf ein Projektarchiv über das svn-Netzwerkprotokoll.
</span><span class='line'>  - mit Cyrus-SASL-Authentifizierung
</span><span class='line'>  - behandelt Schema »svn«
</span><span class='line'>* ra_local : Modul zum Zugriff auf ein Projektarchiv auf der lokalen Festplatte
</span><span class='line'>  - behandelt Schema »file«
</span><span class='line'>* ra_serf : Modul zum Zugriff auf ein Projektarchiv über das Protokoll WebDAV mittels serf.
</span><span class='line'>  - behandelt Schema »http«
</span><span class='line'>  - behandelt Schema »https«
</span><span class='line'>$ cd svn/my-project
</span><span class='line'>$ svn status
</span><span class='line'>svn: E155036: Please see the 'svn upgrade' command
</span><span class='line'>svn: E155036: The working copy at '/home/uli/svn/my-project'
</span><span class='line'>is too old (format 29) to work with client version '1.8.1 (r1503906)' (expects format 31). You need to upgrade the working copy first.
</span><span class='line'>$ svn upgrade
</span><span class='line'>Upgraded '.'
</span><span class='line'>$ svn status
</span><span class='line'>$ svn update
</span><span class='line'>Updating '.':
</span><span class='line'>A    minianwendungjsf/.classpath
</span><span class='line'>A    minianwendungjsf/ant
</span><span class='line'>A    minianwendungjsf/ant/build.xml
</span><span class='line'>A    minianwendungjsf/.project
</span><span class='line'>...
</span><span class='line'>A    EJB3.1_Test/login.config
</span><span class='line'>Updated to revision 13.
</span><span class='line'>$ svn checkout https://.....
</span><span class='line'>A    my-project2/git-test
</span><span class='line'>A    my-project2/git-test/Hello.txt
</span><span class='line'>A    my-project2/git-test/01-git-neu.txt
</span><span class='line'>...
</span><span class='line'>A    my-project2/testfolder2
</span><span class='line'>A    my-project2/testfolder2/testbin-ticket9.odt
</span><span class='line'>Checked out revision 78.</span></code></pre></td></tr></table></div></figure>


<p>Also: Grobtest ist OK.</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/07/27/subversion_1.8.1/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[LXC: Probleme mit 3.10-er-Kernel -  Das Dateisystem ist nur lesbar]]></title>
<link href="http://uli-heller.github.com/2013/07/27/lxc-kernel-310/"/>
<updated>2013-07-27T09:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/07/27/lxc-kernel-310</id>

      <content type="html"><![CDATA[<p>Seit einiger Zeit verwende ich LXC als Ergänzung zu VirtualBox.
Bislang läuft das weitgehend problemlos. Merkwürdigerweise
bekomme ich seit ein paar Tagen immer wieder Fehlermeldungen
bezüglich BTRFS: &#8220;Das Dateisystem ist nur lesbar&#8221;.</p>

<p>Erst dachte ich, BTRFS hätte &#8216;nen Schuß. Detailliertere Tests zeigen,
dass der 3.10-er-Kernel wohl &#8220;Schuld&#8221; ist.</p>

<!-- more -->


<h2>Meine LXC-Umgebung</h2>

<ul>
<li>Ubuntu 12.04</li>
<li>3.8-er-Kernel oder auch 3.10-er-Kernel</li>
<li>/dev/mapper/datavg-lxlv ist eingebunden unter /lxc und ist ein
BTRFS-Dateisystem</li>
<li>Alle LXC-Container liegen unter /lxc, also auf einem BTRFS-Dateisystem</li>
</ul>


<h2>Runterfahren eines LXC-Containers unter 3.8</h2>

<p>Beim 3.8-er-Kernel sieht man eine Fehlermeldung bzgl.
meiner BTRFS-Partition: Sie kann <em>nicht</em> umgehängt werden mit
Nur-Lesen-Zugriff.</p>

<figure class='code'><figcaption><span>Runterfahren mit Kernel 3.8 </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>~<span class="nv">$ </span>sudo poweroff
</span><span class='line'>...
</span><span class='line'>umount: /run/lock: not mounted
</span><span class='line'>umount: /run/shm: not mounted
</span><span class='line'>mount: cannot mount block device /dev/mapper/datavg-lxclv <span class="nb">read</span>-only
</span><span class='line'> * Will now halt
</span><span class='line'>~<span class="nv">$ </span>sudo touch  /lxc/x
</span><span class='line'>~<span class="nv">$ </span>sudo rm  /lxc/x
</span></code></pre></td></tr></table></div></figure>


<h2>Runterfahren eines LXC-Containers unter 3.10</h2>

<p>Beim 3.10-er-Kernel sieht man keine Fehlermeldung bzgl.
meiner BTRFS-Partition, also kann sie vermutlich umgehängt werden mit
Nur-Lesen-Zugriff. Dementsprechend ist sie danach &#8220;nur-lesend&#8221;
eingehängt und der Inhalt von /lxc kann nicht mehr modifiziert
werden.</p>

<figure class='code'><figcaption><span>Runterfahren mit Kernel 3.10 </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>~<span class="nv">$ </span>sudo poweroff
</span><span class='line'>...
</span><span class='line'>umount: /run/lock: not mounted
</span><span class='line'>umount: /run/shm: not mounted
</span><span class='line'> * Will now halt
</span><span class='line'>~<span class="nv">$ </span>sudo touch /lxc/x
</span><span class='line'>touch: »/lxc/x“ kann nicht berührt werden: Das Dateisystem ist nur lesbar
</span><span class='line'>~<span class="nv">$ LANG</span><span class="o">=</span>C sudo touch /lxc/x
</span><span class='line'>touch: cannot touch <span class="sb">`</span>/lxc/x<span class="err">&#39;</span>: Read-only file system
</span></code></pre></td></tr></table></div></figure>


<h2>Dateisysteme innerhalb der LXC-Container</h2>

<figure class='code'><figcaption><span>Dateisysteme </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>container~<span class="nv">$ </span>df
</span><span class='line'>Filesystem               1K-blocks     Used Available Use% Mounted on
</span><span class='line'>/dev/mapper/datavg-lxclv  41943040 13871816  26684544  35% /
</span><span class='line'>none                        816864       76    816788   1% /run
</span><span class='line'>none                          5120        0      5120   0% /run/lock
</span><span class='line'>none                       4084308        0   4084308   0% /run/shm
</span></code></pre></td></tr></table></div></figure>


<h2>Korrekturen</h2>

<ul>
<li>Bei Verwendung des 3.10-er-Kernels nach dem Stoppen eines Containers: <code>sudo mount -o remount,rw /dev/mapper/datavg-lxclv</code> ausführen</li>
<li>Immer nur den 3.8-er-Kernel verwenden</li>
<li>Innerhalb des Containers /etc/init.d/umountroot &#8220;abklemmen&#8221;</li>
</ul>


<figure class='code'><figcaption><span>Container: /etc/init.d/umountroot </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'>container:~$ diff -u /etc/init.d/umountroot.orig /etc/init.d/umountroot
</span><span class='line'><span class="gd">--- /etc/init.d/umountroot.orig  2012-04-14 09:26:31.000000000 +0000</span>
</span><span class='line'><span class="gi">+++ /etc/init.d/umountroot   2013-07-27 06:57:20.487486654 +0000</span>
</span><span class='line'><span class="gu">@@ -8,6 +8,7 @@</span>
</span><span class='line'> # Default-Stop:      0 6
</span><span class='line'> # Short-Description: Mount the root filesystem read-only.
</span><span class='line'> ### END INIT INFO
</span><span class='line'><span class="gi">+exit 0</span>
</span><span class='line'>
</span><span class='line'> PATH=/sbin:/bin
</span><span class='line'> . /lib/init/vars.sh
</span></code></pre></td></tr></table></div></figure>



<p><a rel="bookmark" href="http://uli-heller.github.com/2013/07/27/lxc-kernel-310/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[LXC: Probleme bei der Initialisierung des Netzwerkes]]></title>
<link href="http://uli-heller.github.com/2013/07/26/lxc-networking/"/>
<updated>2013-07-26T15:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/07/26/lxc-networking</id>

      <content type="html"><![CDATA[<p>Seit einiger Zeit verwende ich LXC als Ergänzung zu VirtualBox.
Bislang läuft das weitgehend problemlos.
Merkwürdigerweise habe einige LXC-Container seit heute ein
Problem beim Start: Es dauert endlos, bis der Login-Prompt erscheint
und das Netzwerk funktioniert nicht. Betroffen sind auch Container,
die früher anstandslos gelaufen sind.</p>

<!-- more -->


<h2>Logs</h2>

<h3>Host: /var/Log/syslog</h3>

<figure class='code'><figcaption><span>Host:/var/log/syslog </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>Jul 26 13:12:53 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPDISCOVER(lxcbr0) 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:12:53 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPOFFER(lxcbr0) 10.0.3.14 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:13:13 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPDISCOVER(lxcbr0) 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:13:13 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPOFFER(lxcbr0) 10.0.3.14 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:13:24 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPDISCOVER(lxcbr0) 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:13:24 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPOFFER(lxcbr0) 10.0.3.14 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:13:35 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPDISCOVER(lxcbr0) 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:13:35 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPOFFER(lxcbr0) 10.0.3.14 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:13:53 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPDISCOVER(lxcbr0) 00:16:3e:84:7a:82</span></code></pre></td></tr></table></div></figure>


<h3>Container: /var/log/syslog</h3>

<figure class='code'><figcaption><span>Container:/var/log/syslog </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>Jul 26 11:12:53 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 17
</span><span class='line'>Jul 26 11:12:53 localhost dhclient: 5 bad udp checksums in 5 packets
</span><span class='line'>Jul 26 11:13:10 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 14
</span><span class='line'>Jul 26 11:13:24 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 11
</span><span class='line'>Jul 26 11:13:35 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 15
</span><span class='line'>Jul 26 11:13:50 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 11
</span><span class='line'>Jul 26 11:14:01 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 10
</span><span class='line'>Jul 26 11:14:01 localhost dhclient: 5 bad udp checksums in 5 packets
</span><span class='line'>Jul 26 11:14:11 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 15
</span><span class='line'>Jul 26 11:14:26 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port</span></code></pre></td></tr></table></div></figure>


<h2>Abhilfe</h2>

<h3>Temporäre Abhilfe</h3>

<p>Abhilfe schafft die Ausführung vom nachfolgenden Befehl auf dem Host:</p>

<p><code>
sudo iptables -A POSTROUTING -t mangle -p udp --dport bootpc -j CHECKSUM --checksum-fill
</code></p>

<p>Die Abhilfe ist hier beschrieben: <a href="https://bugs.launchpad.net/ubuntu/+source/isc-dhcp/+bug/930962/comments/14">https://bugs.launchpad.net/ubuntu/+source/isc-dhcp/+bug/930962/comments/14</a></p>

<h3>Dauerhafte Abhilfe</h3>

<p>Eine dauerhafte Abhilfe schafft die Aktualisierung des Paketes
&#8220;isc-dhcp-client&#8221; auf Version 4.1.ESV-R4-0ubuntu5.8 oder neuer.
Das geht ganz normal mit <code>apt-get update; apt-get upgrade</code>.
Ich hatte zuvor 4.1.ESV-R4-0ubuntu5.5 im Container.</p>

<h2>Nachtrag: Ursache</h2>

<p>Das Problem wurde ziemlich sicher verursacht durch den Einsatz von
einem 3.10-er Kernel auf dem Host. Nach dem &#8220;Runterschalten&#8221; auf 3.8
laufen die Container auch wieder ohne Aktualisierung von
&#8220;isc-dhcp-client&#8221;.</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/07/26/lxc-networking/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Git Fork]]></title>
<link href="http://uli-heller.github.com/2013/07/21/git-fork/"/>
<updated>2013-07-21T09:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/07/21/git-fork</id>

      <content type="html"><![CDATA[<h1>Git Fork</h1>

<p>Hier kurz meine Notizen zum Arbeiten mit GitHub Forks:</p>

<ul>
<li>Bestehendes Projekt &#8220;forken&#8221; -> einfach via GitHub-Webseite</li>
<li>Lokalen Clone hiervon anlegen: <code>git clone ...</code></li>
<li>Lokale Änderungen an GitHub schicken:
<code>git push origin master</code></li>
<li>Original-Projekt als &#8220;upstream&#8221; definieren:
<code>git remote add upstream ...</code></li>
<li>Lokale Kopie des Original-Projektes aktualisieren:
<code>git fetch upstream</code></li>
<li>Lokale Kopie des Original-Projektes &#8220;einarbeiten&#8221;:

<ul>
<li><code>git merge --no-commit upstream/master</code></li>
<li><code>git mergetool</code></li>
<li><code>git commit -m ...</code></li>
</ul>
</li>
</ul>


<p>Mehr Details: <a href="https://help.github.com/articles/fork-a-repo">https://help.github.com/articles/fork-a-repo</a>.</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/07/21/git-fork/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Octopress - Liquid error: can’t convert nil into String]]></title>
<link href="http://uli-heller.github.com/2013/07/20/octopress-fehler/"/>
<updated>2013-07-20T07:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/07/20/octopress-fehler</id>

      <content type="html"><![CDATA[<p>Beim Einbinden von Dateien in einen Octopress-Blog-Eintrag sehe ich immer mal wieder
Fehlermeldungen wie diese:</p>

<pre><code>Liquid error: can’t convert nil into String
</code></pre>

<p>Sie tauchen immer dann auf, wenn ich Dateien ohne Extension mittels <code>include_code</code>
einbinde:</p>

<pre><code>{% include_code redmine/passenger/passenger %}
</code></pre>

<!-- more -->


<h2>Einige Tests</h2>

<h3>Wie sieht&#8217;s mit der Version von Github/master aus?</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>git clone https://github.com/imathis/octopress.git
</span><span class='line'>Klone nach <span class="s1">&#39;octopress&#39;</span>...
</span><span class='line'>remote: Counting objects: 10661, <span class="k">done</span>.
</span><span class='line'>remote: Compressing objects: 100% <span class="o">(</span>4588/4588<span class="o">)</span>, <span class="k">done</span>.
</span><span class='line'>remote: Total 10661 <span class="o">(</span>delta 5839<span class="o">)</span>, reused 9830 <span class="o">(</span>delta 5212<span class="o">)</span>
</span><span class='line'>Empfange Objekte: 100% <span class="o">(</span>10661/10661<span class="o">)</span>, 2.30 MiB | 773.00 KiB/s, <span class="k">done</span>.
</span><span class='line'>Löse Unterschiede auf: 100% <span class="o">(</span>5839/5839<span class="o">)</span>, <span class="k">done</span>.
</span><span class='line'>Checking connectivity... <span class="k">done</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span><span class="nb">cd </span>octopress/
</span><span class='line'>You are using <span class="s1">&#39;.rvmrc&#39;</span>, it requires trusting, it is slower and it is not compatible with other ruby managers,
</span><span class='line'>you can switch to <span class="s1">&#39;.ruby-version&#39;</span> using <span class="s1">&#39;rvm rvmrc to [.]ruby-version&#39;</span>
</span><span class='line'>or ignore this warnings with <span class="s1">&#39;rvm rvmrc warning ignore .../octopress/.rvmrc&#39;</span>,
</span><span class='line'><span class="s1">&#39;.rvmrc&#39;</span> will <span class="k">continue </span>to be the default project file in RVM 1 and RVM 2,
</span><span class='line'>to ignore the warning <span class="k">for </span>all files run <span class="s1">&#39;rvm rvmrc warning ignore all.rvmrcs&#39;</span>.
</span><span class='line'>
</span><span class='line'>********************************************************************************
</span><span class='line'>* NOTICE                                                                       *
</span><span class='line'>********************************************************************************
</span><span class='line'>* RVM has encountered a new or modified .rvmrc file in the current directory,  *
</span><span class='line'>* this is a shell script and therefore may contain any shell commands.         *
</span><span class='line'>*                                                                              *
</span><span class='line'>* Examine the contents of this file carefully to be sure the contents are      *
</span><span class='line'>* safe before trusting it!                                                     *
</span><span class='line'>* Do you wish to trust <span class="s1">&#39;.../octopress/.rvmrc&#39;</span>?                                 *
</span><span class='line'>* Choose v<span class="o">[</span>iew<span class="o">]</span> below to view the contents                                     *
</span><span class='line'>********************************************************************************
</span><span class='line'>y<span class="o">[</span>es<span class="o">]</span>, n<span class="o">[</span>o<span class="o">]</span>, v<span class="o">[</span>iew<span class="o">]</span>, c<span class="o">[</span>ancel<span class="o">]</span>&gt; yes
</span><span class='line'>Using .../.rvm/gems/ruby-1.9.3-p392
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>bundle install
</span><span class='line'>Fetching gem metadata from https://rubygems.org/........
</span><span class='line'>Fetching gem metadata from https://rubygems.org/..
</span><span class='line'>Resolving dependencies...
</span><span class='line'>Using rake <span class="o">(</span>0.9.2.2<span class="o">)</span>
</span><span class='line'>Using RedCloth <span class="o">(</span>4.2.9<span class="o">)</span>
</span><span class='line'>Using chunky_png <span class="o">(</span>1.2.5<span class="o">)</span>
</span><span class='line'>Using fast-stemmer <span class="o">(</span>1.0.1<span class="o">)</span>
</span><span class='line'>Using classifier <span class="o">(</span>1.3.3<span class="o">)</span>
</span><span class='line'>Using fssm <span class="o">(</span>0.2.9<span class="o">)</span>
</span><span class='line'>Installing sass <span class="o">(</span>3.2.9<span class="o">)</span>
</span><span class='line'>Installing compass <span class="o">(</span>0.12.2<span class="o">)</span>
</span><span class='line'>Using directory_watcher <span class="o">(</span>1.4.1<span class="o">)</span>
</span><span class='line'>Installing haml <span class="o">(</span>3.1.7<span class="o">)</span>
</span><span class='line'>Installing kramdown <span class="o">(</span>0.13.8<span class="o">)</span>
</span><span class='line'>Using liquid <span class="o">(</span>2.3.0<span class="o">)</span>
</span><span class='line'>Using syntax <span class="o">(</span>1.0.0<span class="o">)</span>
</span><span class='line'>Installing maruku <span class="o">(</span>0.6.1<span class="o">)</span>
</span><span class='line'>Using posix-spawn <span class="o">(</span>0.3.6<span class="o">)</span>
</span><span class='line'>Installing yajl-ruby <span class="o">(</span>1.1.0<span class="o">)</span>
</span><span class='line'>Installing pygments.rb <span class="o">(</span>0.3.4<span class="o">)</span>
</span><span class='line'>Installing jekyll <span class="o">(</span>0.12.0<span class="o">)</span>
</span><span class='line'>Installing rack <span class="o">(</span>1.5.2<span class="o">)</span>
</span><span class='line'>Installing rack-protection <span class="o">(</span>1.5.0<span class="o">)</span>
</span><span class='line'>Using rb-fsevent <span class="o">(</span>0.9.1<span class="o">)</span>
</span><span class='line'>Installing rdiscount <span class="o">(</span>2.0.7.3<span class="o">)</span>
</span><span class='line'>Using rubypants <span class="o">(</span>0.2.0<span class="o">)</span>
</span><span class='line'>Installing sass-globbing <span class="o">(</span>1.0.0<span class="o">)</span>
</span><span class='line'>Installing tilt <span class="o">(</span>1.3.7<span class="o">)</span>
</span><span class='line'>Installing sinatra <span class="o">(</span>1.4.2<span class="o">)</span>
</span><span class='line'>Using stringex <span class="o">(</span>1.4.0<span class="o">)</span>
</span><span class='line'>Using bundler <span class="o">(</span>1.3.5<span class="o">)</span>
</span><span class='line'>Your bundle is <span class="nb">complete</span>!
</span><span class='line'>Use <span class="sb">`</span>bundle show <span class="o">[</span>gemname<span class="o">]</span><span class="sb">`</span> to see where a bundled gem is installed.
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>rake install
</span><span class='line'><span class="c">## Copying classic theme into ./source and ./sass</span>
</span><span class='line'>mkdir -p <span class="nb">source</span>
</span><span class='line'>cp -r .themes/classic/source/. <span class="nb">source</span>
</span><span class='line'>mkdir -p sass
</span><span class='line'>cp -r .themes/classic/sass/. sass
</span><span class='line'>mkdir -p <span class="nb">source</span>/_posts
</span><span class='line'>mkdir -p public
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>rake generate
</span><span class='line'><span class="c">## Generating Site with Jekyll</span>
</span><span class='line'>directory <span class="nb">source</span>/stylesheets/
</span><span class='line'>   create <span class="nb">source</span>/stylesheets/screen.css
</span><span class='line'>Configuration from .../octopress/_config.yml
</span><span class='line'>Building site: <span class="nb">source</span> -&gt; public
</span><span class='line'>Successfully generated site: <span class="nb">source</span> -&gt; public
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>mkdir -p <span class="nb">source</span>/downloads/code
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;Uli war da&quot;</span> &gt;source/downloads/code/mytest
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>mkdir -p <span class="nb">source</span>/downloads/code/redmine/passenger
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>cp .../source/downloads/code/redmine/passenger/passenger <span class="nb">source</span>/downloads/code/redmine/passenger/.
</span></code></pre></td></tr></table></div></figure>


<p>Jetzt noch ein Testdokument anlegen:</p>

<figure class='code'><figcaption><span>&#8230;/source/_posts/2013-07-20-octopress.md </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>---
</span><span class='line'>layout: post
</span><span class='line'>author: Uli Heller
</span><span class='line'>published: yes
</span><span class='line'>title: "Octopress-Test"
</span><span class='line'>date: 2013-07-20 07:00
</span><span class='line'>comments: true
</span><span class='line'>---
</span><span class='line'>
</span><span class='line'>Test:
</span><span class='line'>
</span><span class='line'>{% include_code mytest %}
</span><span class='line'>
</span><span class='line'>Test2:
</span><span class='line'>
</span><span class='line'>{% include_code redmine/passenger/passenger %}</span></code></pre></td></tr></table></div></figure>


<p>Sichten mit</p>

<ul>
<li><code>rake preview</code></li>
<li>Browser: <a href="http://localhost:4000">http://localhost:4000</a></li>
</ul>


<p>Sieht absolut OK aus, der Fehler tritt nicht auf!</p>

<h3>Wie sieht&#8217;s mit der Version von Github/site-2.1 aus?</h3>

<p>Mit der Version von Github/site-2.1 tritt der Fehler genauso auf wie bei mir.
Er ist dort also nicht korrigiert.</p>

<h3>Wie sieht&#8217;s mit der Version von Github/3.0 aus?</h3>

<p>Scheint komplett andersartig zu funktionieren - komme damit momentan nicht klar.</p>

<h3>Wie sieht&#8217;s mit der Version von Github/source-2.1 aus?</h3>

<p>Der Zweig &#8220;source-2.1&#8221; existiert auf Github nicht mehr!</p>

<h2>Weiteres Vorgehen</h2>

<p>Für mich sieht&#8217;s so aus, als wäre das Aufsetzen auf &#8220;source-2.1&#8221; eine echt blöde
Entscheidung gewesen. Werde mein Octopress wohl in nächster Zeit umstellen müssen
auf &#8220;master&#8221;.</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/07/20/octopress-fehler/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Redmine: Von FCGI zu Passenger]]></title>
<link href="http://uli-heller.github.com/2013/07/19/redmine-passenger/"/>
<updated>2013-07-19T15:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/07/19/redmine-passenger</id>

      <content type="html"><![CDATA[<p>Bislang habe ich Redmine hinter einem Apache HTTPD via FCGI betrieben.
Bei meinen Tests mit Redmine-2.3.2 gibt es bei dieser Konstellation aber
viele Probleme mit der Selektion des Rails-Environments. Es wird immer
&#8220;development&#8221; verwendet, &#8220;production&#8221; kann nicht mehr &#8220;wie früher&#8221; über
&#8220;environment.rb&#8221; und <code>ENV['RAILS_ENV'] ||= 'production'</code> selektiert werden.</p>

<!-- more -->


<h2>Sichtung der Alt-Version</h2>

<p>Zunächst muß sichergestellt werden, dass die alte Version hinreichend
gut funktioniert:</p>

<ul>
<li>Redmine-VM starten</li>
<li>LDAP-VM starten</li>
<li>Browser: <a href="http://192.168.56.97">http://192.168.56.97</a> -> &#8220;It works&#8221;</li>
<li>Browser: <a href="http://192.168.56.97/redmine">http://192.168.56.97/redmine</a> -> Begrüssung von Redmine</li>
<li>Browser: <a href="http://192.168.56.97/redmine/issues/1">http://192.168.56.97/redmine/issues/1</a> -> Anmeldungseite wird angezeigt; Anmeldung funktioniert</li>
</ul>


<p>Soweit sieht alles ganz OK aus. Nun: Sichtung der Programmstände.</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>ruby -v
</span><span class='line'>ruby 1.8.7 <span class="o">(</span>2010-01-10 patchlevel 249<span class="o">)</span> <span class="o">[</span>i486-linux<span class="o">]</span>
</span><span class='line'><span class="nv">$ </span>gem list
</span><span class='line'>
</span><span class='line'>*** LOCAL GEMS ***
</span><span class='line'>
</span><span class='line'>actionmailer <span class="o">(</span>2.3.17<span class="o">)</span>
</span><span class='line'>actionpack <span class="o">(</span>2.3.17<span class="o">)</span>
</span><span class='line'>activerecord <span class="o">(</span>2.3.17<span class="o">)</span>
</span><span class='line'>activeresource <span class="o">(</span>2.3.17<span class="o">)</span>
</span><span class='line'>activesupport <span class="o">(</span>2.3.17<span class="o">)</span>
</span><span class='line'>i18n <span class="o">(</span>0.4.2<span class="o">)</span>
</span><span class='line'>mysql <span class="o">(</span>2.8.1<span class="o">)</span>
</span><span class='line'>rack <span class="o">(</span>1.1.3<span class="o">)</span>
</span><span class='line'>rails <span class="o">(</span>2.3.17<span class="o">)</span>
</span><span class='line'>rake <span class="o">(</span>0.8.7<span class="o">)</span>
</span><span class='line'>rubygems-update <span class="o">(</span>1.6.2<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Ruby-Gems herunterladen und installieren</h2>

<p>Mit diesen Befehlen werden die Ruby-Gems heruntergeladen:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>gem fetch passenger
</span><span class='line'><span class="c"># gem fetch passenger -v 4.0.10</span>
</span><span class='line'>gem fetch daemon_controller -v <span class="s2">&quot;&gt;= 1.1.0&quot;</span>
</span><span class='line'><span class="c"># gem fetch daemon_controller -v 1.1.4</span>
</span></code></pre></td></tr></table></div></figure>


<p>Die *.gem-Dateien müssen auf die Redmine-VM übertragen werden, am besten
mit <code>scp</code>. Danach spielt man sie ein mit</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>gem install passenger-4.0.10.gem
</span></code></pre></td></tr></table></div></figure>


<h2>Apache-Modul installieren</h2>

<p>Mit nachfolgendem Befehl wird das Passenger-Modul für Apache2
installiert und auch gleich aktiviert:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>apt-get install libapache2-mod-passenger
</span></code></pre></td></tr></table></div></figure>


<h2>Apache konfigurieren</h2>

<ul>
<li>Konfigurationsdatei kopieren und anpassen:
<code>cp /etc/apache2/sites-available/default /etc/apache2/sites-available/passenger</code></li>
</ul>


<figure class='code'><figcaption><span>/etc/apache2/sites-available/passenger </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>#NameVirtualHost *:80
</span><span class='line'>&lt;VirtualHost *:80>
</span><span class='line'>        ServerAdmin webmaster@localhost
</span><span class='line'>
</span><span class='line'>        PassengerDefaultUser www-data
</span><span class='line'>        RailsEnv production
</span><span class='line'>#        RailsBaseURI /redmine
</span><span class='line'>
</span><span class='line'>        DocumentRoot /srv/redmine-1.2.1/public/
</span><span class='line'>#        DocumentRoot /var/www/
</span><span class='line'>        Alias /redmine "/srv/redmine-1.2.1/public/"
</span><span class='line'>        &lt;Directory "/srv/redmine-1.2.1/public/">   
</span><span class='line'>         Options FollowSymLinks -MultiViews  
</span><span class='line'>          AllowOverride none  
</span><span class='line'>          Order allow,deny
</span><span class='line'>          allow from all
</span><span class='line'>        &lt;/Directory>
</span><span class='line'>
</span><span class='line'>        ErrorLog /var/log/apache2/error.log
</span><span class='line'>
</span><span class='line'>        # Possible values include: debug, info, notice, warn, error, crit,
</span><span class='line'>        # alert, emerg.
</span><span class='line'>        LogLevel warn  
</span><span class='line'>
</span><span class='line'>        CustomLog /var/log/apache2/access.log combined
</span><span class='line'>        ServerSignature On
</span><span class='line'>&lt;/VirtualHost></span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>Alte Datei &#8220;abklemmen&#8221;: <code>a2dissite default</code></p></li>
<li><p>Neue Datei aktivieren: <code>a2ensite passenger</code></p></li>
<li><p>Apache neu starten: <code>/etc/init.d/apache2 restart</code></p></li>
</ul>


<h2>Sichtung der Neu-Version</h2>

<p>Zunächst muß sichergestellt werden, dass die alte Version hinreichend
gut funktioniert:</p>

<ul>
<li>Redmine-VM starten (&#8230; läuft vermutlich eh&#8217; noch)</li>
<li>LDAP-VM starten (&#8230; läuft vermutlich eh&#8217; noch)</li>
<li>Browser: <a href="http://192.168.56.97">http://192.168.56.97</a>  -> Begrüssung von Redmine</li>
<li>Browser: <a href="http://192.168.56.97/redmine">http://192.168.56.97/redmine</a> -> Begrüssung von Redmine</li>
<li>Browser: <a href="http://192.168.56.97/redmine/issues/1">http://192.168.56.97/redmine/issues/1</a> -> Anmeldungseite wird angezeigt; Anmeldung funktioniert</li>
</ul>

<p><a rel="bookmark" href="http://uli-heller.github.com/2013/07/19/redmine-passenger/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Analyse des Systemstarts]]></title>
<link href="http://uli-heller.github.com/2013/07/18/bootchart/"/>
<updated>2013-07-18T10:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/07/18/bootchart</id>

      <content type="html"><![CDATA[<p>Mein Samsung-Laptop benötigt sehr lange für den Systemstart.
Gefühlt dauert&#8217;s 5 Minuten vom Einschalten bis zum Login-Prompt.
Das sollte doch irgendwie schneller gehen - nur wie?</p>

<!-- more -->


<h2>Bootchart</h2>

<h3>Installieren</h3>

<p><code>
sudo apt-get install bootchart pybootchartgui
</code></p>

<h3>Neustart</h3>

<p><code>
sudo reboot
</code></p>

<h3>Sichten</h3>

<ul>
<li>Verzeichnis: /var/log/bootchart</li>
<li>Dateien: uli-samsung-precise-20130718-1.tgz und uli-samsung-precise-20130718-1.png</li>
</ul>


<p><img src="http://uli-heller.github.com/images/bootchart/uli-samsung-precise-20130718-1.png" alt="Bootchart vom Samsung-Laptop" /></p>

<p>Es fällt auf, dass ein Großteil der Zeit in IOWAIT verbracht wird (dicke rotbraune Balken). Somit liegt die Vermutung nahe, dass die interne Festplatte wohl schnarchlahm ist. Das deckt sich auch wunderbar mit meinen Beobachtungen bei der täglichen Arbeit:</p>

<ul>
<li>Editieren eines Shell-Skriptes</li>
<li>Speichern</li>
<li>Fenster-Wechsel + Start des Skriptes</li>
<li>Start scheitert mit einer Fehlermeldung (sinngemäß: &#8220;Skript gesperrt&#8221;)</li>
<li>2 Sekunden warten + nochmaliger Start</li>
<li>Start klappt</li>
</ul>


<h3>Versuch: SSD an USB-3</h3>

<p>Eine externe SSD angeschlossen an die USB-3-Schnittstelle startet &#8220;schnell&#8221; (&#8230; gefühlt dauert&#8217;s ähnlich lang wie beim Macbook Air 2013).</p>

<p>Also: Scheint wirklich an der lahmen Platte zu liegen.</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/07/18/bootchart/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Experimente mit ZFS unter Ubuntu-12.04]]></title>
<link href="http://uli-heller.github.com/2013/07/12/zfs/"/>
<updated>2013-07-12T08:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/07/12/zfs</id>

      <content type="html"><![CDATA[<h2>DEBs installieren</h2>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo apt-get install make build-essential dpkg-dev
</span><span class='line'>sudo apt-get install -f
</span><span class='line'>sudo dpkg -i zfs-dkms_0.6.1-1~precise_amd64.deb <span class="se">\</span>
</span><span class='line'>  spl-dkms_0.6.1-1~precise_all.deb              <span class="se">\</span>
</span><span class='line'>  dkms_2.2.0.3-1ubuntu3.1+zfs6~precise1_all.deb
</span><span class='line'>sudo dpkg -i zfsutils_0.6.1-1~precise_amd64.deb <span class="se">\</span>
</span><span class='line'>  libnvpair1_0.6.1-1~precise_amd64.deb          <span class="se">\</span>
</span><span class='line'>  libuutil1_0.6.1-1~precise_amd64.deb           <span class="se">\</span>
</span><span class='line'>  libzfs1_0.6.1-1~precise_amd64.deb             <span class="se">\</span>
</span><span class='line'>  libzpool1_0.6.1-1~precise_amd64.deb
</span><span class='line'>sudo dpkg -i ubuntu-zfs_7~precise1_amd64.deb    <span class="se">\</span>
</span><span class='line'>  spl_0.6.1-1~precise_amd64.deb
</span><span class='line'>sudo dpkg -i mountall_2.48build1-zfs2_amd64.deb
</span></code></pre></td></tr></table></div></figure>


<h2>Kurzexperimente mit ZPOOL</h2>

<h4>Pool anlegen</h4>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool create -f zfsdata /dev/sda
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: none requested
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    sda       ONLINE       0     0     0
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool destroy zfsdata
</span></code></pre></td></tr></table></div></figure>


<h3>Pool mit RaidZ anlegen</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool create -f zfsdata raidz /dev/sda /dev/sdb
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: none requested
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sda     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool destroy zfsdata
</span></code></pre></td></tr></table></div></figure>


<h3>Pool und Reboot</h3>

<p>Dieser Test soll sicherstellen, dass ein ZPOOL auch nach einem Reboot verfügbar ist.</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool create -f zfsdata raidz /dev/sda /dev/sdb
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: none requested
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sda     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>df|grep zfs
</span><span class='line'>zfsdata                  2873622144    128 2873622016   1% /zfsdata
</span><span class='line'><span class="nv">$ </span>sudo reboot
</span><span class='line'>...
</span><span class='line'><span class="nv">$ </span>df|grep zfs
</span><span class='line'>zfsdata                  2873622144    128 2873622016   1% /zfsdata
</span><span class='line'><span class="nv">$ </span>sudo zpool destroy zfsdata
</span></code></pre></td></tr></table></div></figure>


<p>Das funktioniert offenbar nur dann, wenn das &#8220;mountall&#8221;-Paket installiert ist!</p>

<h3>Pool mit RaidZ und Spare Disk (manuell)</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool create -f zfsdata raidz /dev/sda /dev/sdb spare /dev/sdc
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: none requested
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sda     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sdc       AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<p>Jetzt habe ich die Platte /dev/sda rausgezogen. Ideal wäre nun, wenn sich das RAIDZ
automatisch auf /dev/sdc verlagern würde&#8230;</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool scrub zfsdata
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: DEGRADED
</span><span class='line'>status: One or more devices could not be used because the label is missing or
</span><span class='line'>  invalid.  Sufficient replicas exist <span class="k">for </span>the pool to <span class="k">continue</span>
</span><span class='line'><span class="k">  </span>functioning in a degraded state.
</span><span class='line'>action: Replace the device using <span class="s1">&#39;zpool replace&#39;</span>.
</span><span class='line'>   see: http://zfsonlinux.org/msg/ZFS-8000-4J
</span><span class='line'>  scan: scrub repaired 0 in 0h0m with 0 errors on Sat Jul 20 11:07:11 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     DEGRADED     0     0     0
</span><span class='line'>    raidz1-0  DEGRADED     0     0     0
</span><span class='line'>      sda     UNAVAIL      0     0     0  corrupted data
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sdc       AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool replace zfsdata sda sdc
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: DEGRADED
</span><span class='line'>status: One or more devices could not be used because the label is missing or
</span><span class='line'>  invalid.  Sufficient replicas exist <span class="k">for </span>the pool to <span class="k">continue</span>
</span><span class='line'><span class="k">  </span>functioning in a degraded state.
</span><span class='line'>action: Replace the device using <span class="s1">&#39;zpool replace&#39;</span>.
</span><span class='line'>   see: http://zfsonlinux.org/msg/ZFS-8000-4J
</span><span class='line'>  scan: resilvered 532K in 0h0m with 0 errors on Sat Jul 20 11:12:19 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME         STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata      DEGRADED     0     0     0
</span><span class='line'>    raidz1-0   DEGRADED     0     0     0
</span><span class='line'>      spare-0  UNAVAIL      0     0     0
</span><span class='line'>        sda    UNAVAIL      0     0     0  corrupted data
</span><span class='line'>        sdc    ONLINE       0     0     0
</span><span class='line'>      sdb      ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sdc        INUSE     currently in use
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool detach zfsdata sda
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: resilvered 532K in 0h0m with 0 errors on Sat Jul 20 11:12:19 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sdc     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<p>Jetzt habe ich /dev/sda wieder eingebaut und mit <code>fdisk</code> geprüft, ob sie auch ansprechbar ist.</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool add zfsdata spare sda
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: resilvered 532K in 0h0m with 0 errors on Sat Jul 20 11:12:19 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sdc     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sda       AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<h3>Pool mit RaidZ und Spare Disk (automatisch)</h3>

<p>Nachfolgend meine Versuche mit &#8220;autoreplace&#8221; - leider wenig erfolgreich.
Hier <a href="http://forums.nas4free.org/viewtopic.php?f=66&amp;t=3873">http://forums.nas4free.org/viewtopic.php?f=66&amp;t=3873</a> werden die
gleichen Probleme mit FreeBSD beschrieben. Anscheinend unterstützt FreeBSD
dieses Feature nicht richtig, vermutlich ist&#8217;s bei Linux ebenso.</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool create -f zfsdata raidz /dev/sda /dev/sdb spare /dev/sdc
</span><span class='line'><span class="nv">$ </span>sudo zpool <span class="nb">set </span><span class="nv">autoreplace</span><span class="o">=</span>on zfsdata
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: none requested
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sda     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sdc       AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<p>Jetzt habe ich die Platte /dev/sda rausgezogen. Ideal wäre nun, wenn sich das RAIDZ
automatisch auf /dev/sdc verlagern würde&#8230;</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool scrub zfsdata
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: DEGRADED
</span><span class='line'>status: One or more devices has been removed by the administrator.
</span><span class='line'>  Sufficient replicas exist <span class="k">for </span>the pool to <span class="k">continue </span>functioning in a
</span><span class='line'>  degraded state.
</span><span class='line'>action: Online the device using <span class="s1">&#39;zpool online&#39;</span> or replace the device with
</span><span class='line'>  <span class="s1">&#39;zpool replace&#39;</span>.
</span><span class='line'>  scan: scrub repaired 0 in 0h0m with 0 errors on Sat Jul 20 11:25:59 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     DEGRADED     0     0     0
</span><span class='line'>    raidz1-0  DEGRADED     0     0     0
</span><span class='line'>      sda     REMOVED      0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sdc       AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool replace zfsdata sda sdc
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: DEGRADED
</span><span class='line'>status: One or more devices is currently being resilvered.  The pool will
</span><span class='line'>  <span class="k">continue </span>to <span class="k">function</span>, possibly in a degraded state.
</span><span class='line'>action: Wait <span class="k">for </span>the resilver to complete.
</span><span class='line'>  scan: resilver in progress since Sat Jul 20 11:33:09 2013
</span><span class='line'>    146M scanned out of 1,03G at 8,61M/s, 0h1m to go
</span><span class='line'>    72,9M resilvered, 13,94% <span class="k">done</span>
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME         STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata      DEGRADED     0     0     0
</span><span class='line'>    raidz1-0   DEGRADED     0     0     0
</span><span class='line'>      spare-0  UNAVAIL      0     0     0
</span><span class='line'>        sda    UNAVAIL      0     0     0  corrupted data
</span><span class='line'>        sdc    ONLINE       0     0     0  <span class="o">(</span>resilvering<span class="o">)</span>
</span><span class='line'>      sdb      ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sdc        INUSE     currently in use
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: DEGRADED
</span><span class='line'>status: One or more devices could not be used because the label is missing or
</span><span class='line'>  invalid.  Sufficient replicas exist <span class="k">for </span>the pool to <span class="k">continue</span>
</span><span class='line'><span class="k">  </span>functioning in a degraded state.
</span><span class='line'>action: Replace the device using <span class="s1">&#39;zpool replace&#39;</span>.
</span><span class='line'>   see: http://zfsonlinux.org/msg/ZFS-8000-4J
</span><span class='line'>  scan: resilvered 526M in 0h1m with 0 errors on Sat Jul 20 11:34:28 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME         STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata      DEGRADED     0     0     0
</span><span class='line'>    raidz1-0   DEGRADED     0     0     0
</span><span class='line'>      spare-0  UNAVAIL      0     0     0
</span><span class='line'>        sda    UNAVAIL      0     0     0  corrupted data
</span><span class='line'>        sdc    ONLINE       0     0     0
</span><span class='line'>      sdb      ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sdc        INUSE     currently in use
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool detach zfsdata sda
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: resilvered 526M in 0h1m with 0 errors on Sat Jul 20 11:34:28 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sdc     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<p>Jetzt habe ich /dev/sda wieder eingebaut und mit <code>fdisk</code> geprüft, ob sie auch ansprechbar ist.</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool add zfsdata spare sda
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: resilvered 526M in 0h1m with 0 errors on Sat Jul 20 11:34:28 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sdc     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sda       AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<h2>Platten-IDs ermitteln</h2>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>ls /dev/disk/by-id/scsi-SATA_WDC*|grep -v part
</span><span class='line'>/dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0755994
</span><span class='line'>/dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511
</span><span class='line'>/dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577
</span><span class='line'>/dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>ls /dev/disk/by-id/scsi-SATA_WDC*|grep -v part|xargs --verbose -n1 udevadm info -q path -n
</span><span class='line'>udevadm info -q path -n /dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0755994
</span><span class='line'>/devices/pci0000:00/0000:00:11.0/host3/target3:0:0/3:0:0:0/block/sdd
</span><span class='line'>udevadm info -q path -n /dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511
</span><span class='line'>/devices/pci0000:00/0000:00:11.0/host2/target2:0:0/2:0:0:0/block/sdc
</span><span class='line'>udevadm info -q path -n /dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577
</span><span class='line'>/devices/pci0000:00/0000:00:11.0/host0/target0:0:0/0:0:0:0/block/sda
</span><span class='line'>udevadm info -q path -n /dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780
</span><span class='line'>/devices/pci0000:00/0000:00:11.0/host1/target1:0:0/1:0:0:0/block/sdb
</span></code></pre></td></tr></table></div></figure>


<p>Aus den Ausgaben kann man diese Zuordnung erkennen:</p>

<ul>
<li>sda - scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577</li>
<li>sdb - scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780</li>
<li>sdc - scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511</li>
<li>sdd - scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0755994</li>
</ul>


<p>Die Platten-IDs sollten am besten auch auf den jeweiligen Einbaurahmen geschrieben
werden, damit es zu keinen Verwechslungen kommen kann.</p>

<h2>ZPool über Platten-IDs</h2>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool create -f zfsdata raidz scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577 <span class="se">\</span>
</span><span class='line'>   scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780 <span class="se">\</span>
</span><span class='line'>   spare scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: none requested
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME                                           STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata                                        ONLINE       0     0     0
</span><span class='line'>    raidz1-0                                     ONLINE       0     0     0
</span><span class='line'>      scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577  ONLINE       0     0     0
</span><span class='line'>      scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780  ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511    AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool scrub zfsdata
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: DEGRADED
</span><span class='line'>status: One or more devices could not be used because the label is missing or
</span><span class='line'>  invalid.  Sufficient replicas exist <span class="k">for </span>the pool to <span class="k">continue</span>
</span><span class='line'><span class="k">  </span>functioning in a degraded state.
</span><span class='line'>action: Replace the device using <span class="s1">&#39;zpool replace&#39;</span>.
</span><span class='line'>   see: http://zfsonlinux.org/msg/ZFS-8000-4J
</span><span class='line'>  scan: scrub repaired 0 in 0h0m with 0 errors on Sat Jul 20 12:19:07 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME                                           STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata                                        DEGRADED     0     0     0
</span><span class='line'>    raidz1-0                                     DEGRADED     0     0     0
</span><span class='line'>      scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577  UNAVAIL      0     0     0  corrupted data
</span><span class='line'>      scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780  ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511    AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>sudo zpool replace zfsdata scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577 scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511
</span><span class='line'><span class="nv">$ </span>sudo zpool detach zfsdata scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: resilvered 532K in 0h0m with 0 errors on Sat Jul 20 12:19:36 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME                                           STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata                                        ONLINE       0     0     0
</span><span class='line'>    raidz1-0                                     ONLINE       0     0     0
</span><span class='line'>      scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511  ONLINE       0     0     0
</span><span class='line'>      scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780  ONLINE       0     0     0
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<h2>Finale</h2>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool create -o <span class="nv">ashift</span><span class="o">=</span>12 -f zfsdata scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577 scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780 scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: none requested
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME                                         STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata                                      ONLINE       0     0     0
</span><span class='line'>    scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577  ONLINE       0     0     0
</span><span class='line'>    scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780  ONLINE       0     0     0
</span><span class='line'>    scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511  ONLINE       0     0     0
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<p>Die Platte &#8220;scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0755994&#8221; bleibt auf Vorrat
nicht eingesteckt im Rahmen. Beim Ausfall einer Platte wird sie eingesteckt und
mittels <code>zpool replace zfsdata {kaputte_platte} scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0755994</code>
aktiviert.</p>

<h2>Probleme</h2>

<h3>Dateisystem nach Neustart nicht eingebunden</h3>

<p>Nachdem ich den Kernel aktualisiert habe von 3.2 nach 3.5 klappt das automatische
Einhängen des ZFS-Dateisystems nicht mehr.</p>

<p>Abhilfe: Standard-Paket &#8220;mountall&#8221; wieder installieren und ZFS umkonfigurieren!</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo apt-get install <span class="nv">mountall</span><span class="o">=</span>2.36.4
</span><span class='line'>sudo sed -i s/ZFS_MOUNT<span class="o">=</span><span class="s1">&#39;no&#39;</span>/ZFS_MOUNT<span class="o">=</span><span class="s1">&#39;yes&#39;</span>/ /etc/default/zfs
</span></code></pre></td></tr></table></div></figure>


<h2>Änderungen</h2>

<h3>2013-07-20</h3>

<ul>
<li>Formatierung korrigiert</li>
<li>Reboot-Test</li>
<li>Tests mit Spare Disk</li>
<li>Tests mit Platten-IDs</li>
<li>Finale</li>
</ul>

<p><a rel="bookmark" href="http://uli-heller.github.com/2013/07/12/zfs/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Subversion 1.8.0 für Ubuntu-12.04]]></title>
<link href="http://uli-heller.github.com/2013/07/10/subversion_1.8.0/"/>
<updated>2013-07-10T10:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/07/10/subversion_1.8.0</id>

      <content type="html"><![CDATA[<p>Vor ein paar Tagen wurde Subversion-1.8.0 veröffentlicht.
Hier meine Versuche, ein Paket für Ubuntu-12.04 zu bauen.</p>

<p>Aktuell kann ich die DEB-Pakete zwar erzeugen und installieren,
leider funktionieren sie aber nicht richtig!</p>

<!-- more -->


<h2>Ausgangpunkt: Subversion-1.7.10</h2>

<p>Mein Ausgangspunkt sind die Pakete für Subversion-1.7.10.</p>

<pre><code>$ cd subversion-1.7.10
$ uupdate -u ../subversion-1.8.0
$ cd ../subversion-1.8.0
$ dpkg-buildpackage
</code></pre>

<h2>Erste Hürde: Serf-1.2.1</h2>

<h2>Zweite Hürde: Sqlite3-3.7.15</h2>

<p>Subversion benötigt eine relativ aktuelle Version von Sqlite3. Die
Standard-Version von Ubuntu-12.04 ist zu alt. Ich habe mir so beholfen:</p>

<ul>
<li>Quellpakete von sqlite3-3.7.15.2 aus &#8220;raring&#8221; runtergeladen</li>
<li>Ein paar kleine Anpassungen an debian/rules vorgenommen, damit
tcl85 an der richtigen Stelle ausgelesen wird</li>
<li>Pakete erzeugen mit <code>dpkg-buildpackage</code></li>
</ul>


<h2>Dritte Hürde: Python-Test bricht ab</h2>

<p>Bei der Ausführung von <code>dpkg-buildpackage</code> in &#8220;subversion-1.8.0&#8221;
werden die Tests mit einer Fehlermeldung abgebrochen:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>...
</span><span class='line'>Running testsuite - may take a while.  To disable,
</span><span class='line'>use DEB_BUILD_OPTIONS=nocheck or edit debian/rules.
</span><span class='line'>
</span><span class='line'>/usr/bin/make -f debian/rules check-swig-py check-swig-pl check-swig-rb
</span><span class='line'>make[1]: Entering directory `/home/ubuntu/build/subversion/subversion-1.8.0'
</span><span class='line'>set -e; for v in 2.7; do rm -f BUILD/subversion/bindings/swig/python; ln -fs python$v BUILD/subversion/bindings/swig/python; pylib=$(python$v -c 'from distutils import sysconfig; print sysconfig.get_python_lib()');  /usr/bin/make -C BUILD check-swig-py PYTHON=python$v PYVER=$v CLEANUP=1 LC_ALL=C; done
</span><span class='line'>make[2]: Entering directory `/home/ubuntu/build/subversion/subversion-1.8.0/BUILD'
</span><span class='line'>if [ "LD_LIBRARY_PATH" = "DYLD_LIBRARY_PATH" ]; then for d in ./subversion/bindings/swig/python/libsvn_swig_py ./subversion/bindings/swig/python/../../../libsvn_*; do if [ -n "$DYLD_LIBRARY_PATH" ]; then LD_LIBRARY_PATH="$LD_LIBRARY_PATH:$d/.libs"; else LD_LIBRARY_PATH="$d/.libs"; fi; done; export LD_LIBRARY_PATH; fi; \
</span><span class='line'>  cd ./subversion/bindings/swig/python; \
</span><span class='line'>    python2.7 /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/python/tests/run_all.py
</span><span class='line'>...........................................................................................................................
</span><span class='line'>----------------------------------------------------------------------
</span><span class='line'>Ran 123 tests in 301.417s
</span><span class='line'>
</span><span class='line'>OK
</span><span class='line'>make[2]: Leaving directory `/home/ubuntu/build/subversion/subversion-1.8.0/BUILD'
</span><span class='line'>set -e; for v in 2.7; do rm -f BUILD/subversion/bindings/swig/python; ln -fs python$v-dbg BUILD/subversion/bindings/swig/python; pylib=$(python$v -c 'from distutils import sysconfig; print sysconfig.get_python_lib()');  /usr/bin/make -C BUILD check-swig-py PYTHON=python$v-dbg PYVER=${v}_d PYTHON_INCLUDES=-I/usr/include/python${v}_d CLEANUP=1 LC_ALL=C; done
</span><span class='line'>make[2]: Entering directory `/home/ubuntu/build/subversion/subversion-1.8.0/BUILD'
</span><span class='line'>if [ "LD_LIBRARY_PATH" = "DYLD_LIBRARY_PATH" ]; then for d in ./subversion/bindings/swig/python/libsvn_swig_py ./subversion/bindings/swig/python/../../../libsvn_*; do if [ -n "$DYLD_LIBRARY_PATH" ]; then LD_LIBRARY_PATH="$LD_LIBRARY_PATH:$d/.libs"; else LD_LIBRARY_PATH="$d/.libs"; fi; done; export LD_LIBRARY_PATH; fi; \
</span><span class='line'>  cd ./subversion/bindings/swig/python; \
</span><span class='line'>    python2.7-dbg /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/python/tests/run_all.py
</span><span class='line'>........................Fatal Python error: subversion/bindings/swig/python/svn_client.c:23145 object at 0x399b498 has negative ref count -2604246222170760230
</span><span class='line'>/bin/bash: line 2: 16967 Aborted                 (core dumped) python2.7-dbg /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/python/tests/run_all.py
</span><span class='line'>make[2]: *** [check-swig-py] Error 134
</span><span class='line'>make[2]: Leaving directory `/home/ubuntu/build/subversion/subversion-1.8.0/BUILD'
</span><span class='line'>make[1]: *** [check-swig-py] Error 2
</span><span class='line'>make[1]: Leaving directory `/home/ubuntu/build/subversion/subversion-1.8.0'
</span><span class='line'>make: *** [debian/stamp-build-arch] Error 2
</span><span class='line'>dpkg-buildpackage: error: debian/rules build gave error exit status 2</span></code></pre></td></tr></table></div></figure>


<p>Quercheck: subversion-1.8.0.tar.bz2 entpacken und dort dann</p>

<ul>
<li><code>./configure</code></li>
<li><code>make</code> &#8230; keine Probleme</li>
<li><code>make test</code> &#8230; &#8220;nothing to be done&#8221;</li>
<li><p><code>make check</code> &#8230; &#8220;All tests successful.&#8221;</p>

<pre><code>XFAIL: wc_tests.py 6: add file with not-parent symlink
Summary of test results:
 1909 tests PASSED
 55 tests SKIPPED
 28 tests XFAILED (1 WORK-IN-PROGRESS)
SUMMARY: All tests successful.
</code></pre></li>
<li><p><code>make check-swig-py</code> &#8230; keine Probleme</p></li>
</ul>


<p>Ich editiere debian/rules und deaktiviere &#8220;call allpydbg&#8221; in &#8220;check-swig-py&#8221;.</p>

<h2>Vierte Hürde: Ruby-Tests brechen ab</h2>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>...
</span><span class='line'>/usr/bin/make -C BUILD check-swig-rb CLEANUP=1 LC_ALL=C
</span><span class='line'>make[2]: Entering directory `/home/ubuntu/build/subversion/subversion-1.8.0/BUILD'
</span><span class='line'>if [ "LD_LIBRARY_PATH" = "DYLD_LIBRARY_PATH" ]; then for d in ./subversion/bindings/swig/python/libsvn_swig_rb ./subversion/bindings/swig/python/../../../libsvn_*; do if [ -n "$DYLD_LIBRARY_PATH" ]; then LD_LIBRARY_PATH="$LD_LIBRARY_PATH:$d/.libs"; else LD_LIBRARY_PATH="$d/.libs"; fi; done; export LD_LIBRARY_PATH; fi; \
</span><span class='line'>  cd ./subversion/bindings/swig/ruby; \
</span><span class='line'>          if [ "1" -eq 1 -a "8" -lt 9 ] ; then \
</span><span class='line'>            /usr/bin/ruby1.8 -I /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby \
</span><span class='line'>              /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby/test/run-test.rb \
</span><span class='line'>        --verbose=normal; \
</span><span class='line'>          else \
</span><span class='line'>      /usr/bin/ruby1.8 -I /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby \
</span><span class='line'>        /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby/test/run-test.rb; \
</span><span class='line'>          fi
</span><span class='line'>/home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby/test/util.rb:22:in `require': no such file to load -- ./svn/util (LoadError)
</span><span class='line'>  from /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby/test/util.rb:22
</span><span class='line'>  from /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby/test/run-test.rb:37:in `require'
</span><span class='line'>  from /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby/test/run-test.rb:37
</span><span class='line'>make[2]: *** [check-swig-rb] Error 1
</span><span class='line'>make[2]: Leaving directory `/home/ubuntu/build/subversion/subversion-1.8.0/BUILD'
</span><span class='line'>make[1]: *** [check-swig-rb] Error 2
</span><span class='line'>make[1]: Leaving directory `/home/ubuntu/build/subversion/subversion-1.8.0'
</span><span class='line'>make: *** [debian/stamp-build-arch] Error 2
</span><span class='line'>dpkg-buildpackage: error: debian/rules build gave error exit status 2</span></code></pre></td></tr></table></div></figure>


<p>Das habe ich korrigiert durch Änderungen an ./subversion/bindings/swig/ruby/test/run-test.rb:</p>

<figure class='code'><figcaption><span>run-test.rb </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gd">--- subversion/bindings/swig/ruby/test/util.rb~ 2013-05-29 04:00:11.000000000 +0000</span>
</span><span class='line'><span class="gi">+++ subversion/bindings/swig/ruby/test/util.rb   2013-07-10 09:22:24.845441319 +0000</span>
</span><span class='line'><span class="gu">@@ -19,7 +19,7 @@</span>
</span><span class='line'>
</span><span class='line'> require &quot;fileutils&quot;
</span><span class='line'> require &quot;pathname&quot;
</span><span class='line'><span class="gd">-require &quot;./svn/util&quot;</span>
</span><span class='line'><span class="gi">+require &quot;svn/util&quot;</span>
</span><span class='line'> require &quot;tmpdir&quot;
</span><span class='line'>
</span><span class='line'> require &quot;my-assertions&quot;
</span></code></pre></td></tr></table></div></figure>


<h2>Fünfte Hürde: Verpacken bricht ab wegen fehlenjder Dateien</h2>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>...
</span><span class='line'>make[1]: Leaving directory `/home/ubuntu/build/subversion/subversion-1.8.0/BUILD'
</span><span class='line'>find debian/tmp/usr/lib/ruby \( -name \*.a -o -name \*.la \) -exec rm -f {} +
</span><span class='line'>cd debian/tmp//usr/lib/x86_64-linux-gnu; for lib in ra fs auth swig; do \
</span><span class='line'>      rm -f libsvn_${lib}_*.so libsvn_${lib}_*.la; \
</span><span class='line'>  done
</span><span class='line'>cd debian/tmp//usr/lib/x86_64-linux-gnu; rm -f libsvn_swig*.a libsvnjavahl.a libsvnjavahl.la
</span><span class='line'># Intermediate hack, until we can remove the rest of the .la files.
</span><span class='line'>sed -i  "/dependency_libs/s/=.*/=''/" debian/tmp//usr/lib/x86_64-linux-gnu/*.la
</span><span class='line'>dh_install -s
</span><span class='line'>dh_install: libapache2-svn missing files (debian/tmp/usr/lib/apache2/modules/*.so), aborting
</span><span class='line'>make: *** [debian/stamp-install-arch] Error 2
</span><span class='line'>dpkg-buildpackage: error: fakeroot debian/rules binary gave error exit status 2</span></code></pre></td></tr></table></div></figure>


<p>Das habe ich korrigiert durch Änderungen an ./debian/libapache2-svn.install:</p>

<figure class='code'><figcaption><span>libapache2-svn.install </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'>ubuntu@ubuntu1204-64-build:~/build/subversion/subversion-1.8.0$ diff -u debian/libapache2-svn.install~ debian/libapache2-svn.install
</span><span class='line'><span class="gd">--- debian/libapache2-svn.install~   2013-07-06 06:31:05.000000000 +0000</span>
</span><span class='line'><span class="gi">+++ debian/libapache2-svn.install    2013-07-10 11:08:06.525738591 +0000</span>
</span><span class='line'><span class="gu">@@ -1,4 +1,4 @@</span>
</span><span class='line'><span class="gd">-debian/tmp/usr/lib/apache2/modules/*.so     usr/lib/apache2/modules</span>
</span><span class='line'><span class="gi">+debian/tmp/usr/libexec/*.so         usr/lib/apache2/modules</span>
</span><span class='line'> debian/dav_svn.conf                             etc/apache2/mods-available
</span><span class='line'> debian/dav_svn.load                             etc/apache2/mods-available
</span><span class='line'> debian/authz_svn.load                           etc/apache2/mods-available
</span></code></pre></td></tr></table></div></figure>


<p>Danach kann dann mit <code>fakeroot debian/rules binary</code> die Verpackung ohne erneute Kompilierung getestet werden.</p>

<h2>Nochmals komplett: Paketerzeugung läuft durch</h2>

<p>Nach den vorigen Änderungen kann die Paketerzeugung mit</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>dpkg-buildpackage</span></code></pre></td></tr></table></div></figure>


<p>komplett erfolgreich durchgezogen werden!</p>

<h2>Kurztests: Installation und Funktionsweise</h2>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$ sudo dpkg -i subversion_1.8.0-3dp12~precise1_amd64.deb libsvn1_1.8.0-3dp12~precise1_amd64.deb libserf1_1.2.1-0dp01~precise1_amd64.deb
</span><span class='line'>$ sudo dpkg -i sqlite3_3.7.15.2-1dp01~precise1_amd64.deb libsqlite3-0_3.7.15.2-1dp01~precise1_amd64.deb
</span><span class='line'>$ svn --version
</span><span class='line'>svn, Version 1.8.0 (r1490375)
</span><span class='line'>   übersetzt am Jul 10 2013, um 11:15:47 auf x86_64-pc-linux-gnu
</span><span class='line'>
</span><span class='line'>Copyright (C) 2013 The Apache Software Foundation.
</span><span class='line'>Diese Software besteht aus Beiträgen vieler Personen;
</span><span class='line'>siehe Datei NOTICE für weitere Informationen.
</span><span class='line'>Subversion ist Open Source Software, siehe http://subversion.apache.org/
</span><span class='line'>
</span><span class='line'>Die folgenden ZugriffsModule (ZM) für Projektarchive stehen zur Verfügung:
</span><span class='line'>
</span><span class='line'>* ra_svn : Modul zum Zugriff auf ein Projektarchiv über das svn-Netzwerkprotokoll.
</span><span class='line'>  - mit Cyrus-SASL-Authentifizierung
</span><span class='line'>  - behandelt Schema »svn«
</span><span class='line'>* ra_local : Modul zum Zugriff auf ein Projektarchiv auf der lokalen Festplatte
</span><span class='line'>  - behandelt Schema »file«
</span><span class='line'>* ra_serf : Modul zum Zugriff auf ein Projektarchiv über das Protokoll WebDAV mittels serf.
</span><span class='line'>  - behandelt Schema »http«
</span><span class='line'>  - behandelt Schema »https«
</span><span class='line'>$ cd svn/my-project
</span><span class='line'>$ svn status
</span><span class='line'>svn: E155036: Please see the 'svn upgrade' command
</span><span class='line'>svn: E155036: The working copy at '/home/uli/svn/my-project'
</span><span class='line'>is too old (format 29) to work with client version '1.8.0 (r1490375)' (expects format 31). You need to upgrade the working copy first.
</span><span class='line'>$ svn upgrade
</span><span class='line'>$ svn status
</span><span class='line'>$ svn update
</span><span class='line'>svn: E175009: XML parsing failed: (411 Length Required)
</span><span class='line'>$ svn checkout https://.....
</span><span class='line'>svn: E235000: In file '/home/ubuntu/build/subversion/subversion-1.8.0/subversion/libsvn_client/ra.c' line 647: assertion failed (peg_revnum != SVN_INVALID_REVNUM)
</span><span class='line'>Aborted (core dumped)</span></code></pre></td></tr></table></div></figure>


<p>Also: Leider funktioniert&#8217;s nicht.</p>

<h2>Zurück zur alten Version</h2>

<p>Auf dem Rechner, den ich zum Testen verwendet habe, geht&#8217;s
so zurück zu den alten Versionen:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$ sudo apt-get install libsqlite3-0=3.7.9* sqlite3=3.7.9*
</span><span class='line'>$ sudo apt-get install subversion=1.7.10* libsvn1=1.7.10*
</span><span class='line'>$ sudo apt-get install libserf1=1.0*</span></code></pre></td></tr></table></div></figure>


<p>Auf dem Rechner, den ich zum Bauen verwendet habe, geht&#8217;s
so zurück zu den alten Versionen:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$ sudo apt-get install libsqlite3-0=3.7.9* sqlite3=3.7.9*
</span><span class='line'>$ sudo apt-get install libserf1=1.0*</span></code></pre></td></tr></table></div></figure>



<p><a rel="bookmark" href="http://uli-heller.github.com/2013/07/10/subversion_1.8.0/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Lesegeschwindigkeit von USB-Sticks]]></title>
<link href="http://uli-heller.github.com/2013/07/10/usb_speed/"/>
<updated>2013-07-10T08:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/07/10/usb_speed</id>

      <content type="html"><![CDATA[<p>Nachfolgend ein Vergleich der Lesegeschwindigkeiten von 3 USB-Sticks,
die ich hier rumliegen habe:</p>

<ul>
<li>ein etwas älterer USB-3.0-Stick</li>
<li>ein neuer und ganz kleiner USB-2.0-Stick</li>
<li>ein neuer USB-3.0-Stick</li>
</ul>


<p>Die Lesegeschwindigkeiten messe ich mit <code>hdparm</code> unter Linux auf</p>

<ul>
<li>meinem Samsung-Laptop mit USB-2.0 und USB-3.0</li>
<li>meinem HP-Desktop mit USB-2.0</li>
<li>meinem Macbook Air mit USB-3.0</li>
</ul>


<!-- more -->


<h2>USB-Sticks</h2>

<h3>Sony Micro Vault 64 GB USB 3.0</h3>

<p>Vom Format her ein etwas größerer USB-Stick, ist auch schon etwas älter.
Bei Amazon: <a href="http://www.amazon.de/Sony-Micro-Vault-Match-Speicherstick/dp/B006EK0LZO">http://www.amazon.de/Sony-Micro-Vault-Match-Speicherstick/dp/B006EK0LZO</a></p>

<h3>Sandisk Cruzer Fit 32 GB USB 2.0</h3>

<p>Ein sehr kleiner USB-Stick, recht billig (16€ bei MediaMarkt)
aber wahrscheinlich auch etwas langsam.
Bei Amazon: <a href="http://www.amazon.de/Sandisk-Cruzer-Fit-Speicherstick-32GB/dp/B00812F7O8">http://www.amazon.de/Sandisk-Cruzer-Fit-Speicherstick-32GB/dp/B00812F7O8</a></p>

<h3>Sandisk Extreme 64 GB USB 3.0</h3>

<p>Vom Format her ein etwas größerer USB-Stick. Laut Packung</p>

<ul>
<li>bis zu 190 MB/s lesend</li>
<li>bis zu 170 MB/s schreibend</li>
</ul>


<p>Bei Amazon: <a href="http://www.amazon.de/SanDisk-Cruzer-Extreme-Speicherstick-64GB/dp/B007YXA5SI">http://www.amazon.de/SanDisk-Cruzer-Extreme-Speicherstick-64GB/dp/B007YXA5SI</a></p>

<h2>Samsung Notebook</h2>

<h3>USB-3.0</h3>

<h4>Sony</h4>

<pre><code>~$ sudo hdparm -tT /dev/sdb

/dev/sdb:
 Timing cached reads:   3894 MB in  2.00 seconds = 1947.79 MB/sec
 Timing buffered disk reads: 304 MB in  3.00 seconds = 101.20 MB/sec
</code></pre>

<h4>Sandisk 32GB</h4>

<pre><code>~$ sudo hdparm -tT /dev/sdb

/dev/sdb:
 Timing cached reads:   3878 MB in  2.00 seconds = 1939.72 MB/sec
 Timing buffered disk reads:  64 MB in  3.04 seconds =  21.08 MB/sec
</code></pre>

<h4>Sandisk 64GB</h4>

<pre><code>~$ sudo hdparm -tT /dev/sdb

/dev/sdb:
 Timing cached reads:   3994 MB in  2.00 seconds = 1997.93 MB/sec
 Timing buffered disk reads: 414 MB in  3.01 seconds = 137.37 MB/sec
</code></pre>

<h3>USB-2.0</h3>

<h4>Sony</h4>

<pre><code>~$ sudo hdparm -tT /dev/sdb

/dev/sdb:
 Timing cached reads:   3728 MB in  2.00 seconds = 1864.37 MB/sec
 Timing buffered disk reads:  96 MB in  3.00 seconds =  31.98 MB/sec
</code></pre>

<h4>Sandisk 32GB</h4>

<pre><code>~$ sudo hdparm -tT /dev/sdb

/dev/sdb:
 Timing cached reads:   3732 MB in  2.00 seconds = 1867.17 MB/sec
 Timing buffered disk reads:  62 MB in  3.02 seconds =  20.53 MB/sec
</code></pre>

<h4>Sandisk 64GB</h4>

<pre><code>~$ sudo hdparm -tT /dev/sdb

/dev/sdb:
 Timing cached reads:   3810 MB in  2.00 seconds = 1905.59 MB/sec
 Timing buffered disk reads:  96 MB in  3.01 seconds =  31.89 MB/sec
</code></pre>

<h2>HP Desktop</h2>

<p>Nur USB-2.0 verfügbar!</p>

<h3>Sony</h3>

<pre><code>~$ sudo hdparm -tT /dev/sdh

/dev/sdh:
 Timing cached reads:   19494 MB in  2.00 seconds = 9756.41 MB/sec
 Timing buffered disk reads:  98 MB in  3.04 seconds =  32.23 MB/sec
</code></pre>

<h3>Sandisk 32GB</h3>

<pre><code>~$ sudo hdparm -tT /dev/sdh

/dev/sdh:
 Timing cached reads:   19098 MB in  2.00 seconds = 9557.98 MB/sec
 Timing buffered disk reads:  64 MB in  3.06 seconds =  20.92 MB/sec
</code></pre>

<h3>Sandisk 64GB</h3>

<pre><code>~$ sudo hdparm -tT /dev/sdh

/dev/sdh:
 Timing cached reads:   19272 MB in  2.00 seconds = 9645.16 MB/sec
 Timing buffered disk reads:  98 MB in  3.01 seconds =  32.58 MB/sec
</code></pre>

<h2>Macbook Air 2013</h2>

<p>Nur USB-3.0 verfügbar!</p>

<h3>Sony</h3>

<pre><code>~$ sudo hdparm -tT /dev/sdc

/dev/sdc:
 Timing cached reads:   8598 MB in  2.00 seconds = 4302.41 MB/sec
 Timing buffered disk reads: 382 MB in  3.00 seconds = 127.20 MB/sec
</code></pre>

<h3>Sandisk 32GB</h3>

<pre><code>~$ sudo hdparm -tT /dev/sdc

/dev/sdc:
 Timing cached reads:   8518 MB in  2.00 seconds = 4262.42 MB/sec
 Timing buffered disk reads:  66 MB in  3.03 seconds =  21.78 MB/sec
</code></pre>

<h3>Sandisk 64GB</h3>

<pre><code>~$ sudo hdparm -tT /dev/sdc

/dev/sdc:
 Timing cached reads:   8834 MB in  2.00 seconds = 4421.16 MB/sec
 Timing buffered disk reads: 482 MB in  3.01 seconds = 160.34 MB/sec
</code></pre>

<h2>Fazit</h2>

<p>Der kleine billige Sandisk-USB-Ministick ist erwartungsgemäß recht langsam.
Wenn man keine USB-3.0-Schnittstelle zur Verfügung hat, fällt das nicht
sonderlich in&#8217;s Gewicht (20 MB/sec vs 30 MB/sec). Hat man aber eine
USB-3.0-Schnittstelle, so erreichen die größeren Sticks grob mehr als
5-fachen Durchsatz vom Ministick.</p>

<p>Der neue Sandisk-Stick ist etwa 25% schneller als der alte Sony-Stick.
Das Macbook Air 2013 erreicht bei USB-3.0 auch etwa 25% höheren Durchsatz
wie mein altes Samsung-Notebook.</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/07/10/usb_speed/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Markdowneditor in Eclipse]]></title>
<link href="http://uli-heller.github.com/2013/07/03/eclipse_markdown/"/>
<updated>2013-07-03T08:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/07/03/eclipse_markdown</id>

      <content type="html"><![CDATA[<p>Gemäß <a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=329528">https://bugs.eclipse.org/bugs/show_bug.cgi?id=329528</a>
sollte Markdown von Eclipse unterstützt werden. Leider gibt&#8217;s
in Eclipse-4.3 (Kepler) keine Spur davon&#8230;</p>

<!-- more -->


<p>Ich verwende die meiste Zeit die &#8220;Eclipse IDE for Java EE Developers&#8221;.
Da sind die Wiki-Edit-Tools gleich mit enthalten. Eine Datei im
.textile-Format kann problemlos editiert werden, leider aber keine
im .markdown-Format.</p>

<p>Abhilfe schafft die Installation der &#8220;Mylyn Docs&#8221; von
<a href="http://download.eclipse.org/mylyn/snapshots/nightly/docs/">http://download.eclipse.org/mylyn/snapshots/nightly/docs/</a>.
Ich habe einfach alle &#8220;Mylyn Docs Features&#8221; installiert, Eclipse neu
gestartet und danach wird bei &#8220;Rechts-Klick&#8221; in &#8220;Markup Language&#8221;
auch Markdown angezeigt.</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/07/03/eclipse_markdown/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Experimente mit CentOS-6.4]]></title>
<link href="http://uli-heller.github.com/2013/06/27/centos/"/>
<updated>2013-06-27T08:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/06/27/centos</id>

      <content type="html"><![CDATA[<p>Heute habe ich mir vorgenommen, ein paar Experimente mit CentOS
durchzuführen. CentOS ist eine Linux-Distribution, die den Anspruch
hat, weitgehend kompatibel zu RedHat Enterprise Linux (RHEL) ist.
Meine Hoffnung ist, dass sich die Erkenntnisse, die ich heute sammle,
auch in einem anstehenden Kundenprojekt anwenden lassen, bei dem RHEL
zum Einsatz kommen wird.</p>

<!-- more -->


<h2>Grundinstallation</h2>

<p><a href="http://uli-heller.github.com/images/centos">Foto-Gallerie</a></p>

<h2>Netzwerk konfigurieren</h2>

<p>Hierzu muß die Datei /etc/sysconfig/network-scripts/ifcfg-eth0
angepasst werden:</p>

<figure class='code'><figcaption><span>/etc/sysconfig/network-scripts/ifcfg-eth0 </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gd">- ONBOOT=no</span>
</span><span class='line'><span class="gi">+ ONBOOT=yes</span>
</span></code></pre></td></tr></table></div></figure>


<p>Nach einem Reboot oder nach <code>/etc/init.d/network restart</code>
 wird die Schnittstelle dann automatisch konfiguriert
via DHCP. Mit <code>ifconfig eth0</code> kann man auch die IP-Adresse abfragen.</p>

<h2>Aktualisierungen einspielen</h2>

<p>Nachdem das Netzwerk konfiguriert ist, können mit <code>yum update</code>
die Aktualisierungen eingespielt werden.</p>

<h2>Zusatzpakete einspielen</h2>

<h3>EPEL</h3>

<ul>
<li>Sichten von <a href="http://dl.fedoraproject.org/pub/epel/6/i386">http://dl.fedoraproject.org/pub/epel/6/i386</a></li>
<li>Neueste Version von EPEL identifizieren: epel-release-6-8.noarch.rpm</li>
<li>EPEL runterladen: <code>curl http://dl.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm &gt;epel-release-6-8.noarch.rpm</code></li>
<li>EPEL installieren: <code>rpm -Uvh epel-release-6-8.noarch.rpm</code></li>
</ul>


<h3>Zusatzpakete</h3>

<figure class='code'><figcaption><span>Zusatzpakete einspielen </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>yum install openssh-clients
</span><span class='line'>yum install joe
</span><span class='line'>yum install httpd # apache httpd 2.2.15</span></code></pre></td></tr></table></div></figure>


<h2>Sichtung von Apache HTTPD</h2>

<h3>Version</h3>

<p>Schon bei der Einspielung der Zusatzpakete wurde klar, dass vom
Apache HTTPD die Version 2.2.15 verfügbar ist - ist also eine etwas ältere
Version.</p>

<h3>Module</h3>

<p>Nun interessieren noch die verfügbaren Erweiterungsmodule. Diese liegen
unter /etc/httpd/modules:</p>

<ul>
<li>mod_actions.so</li>
<li>mod_alias.so</li>
<li>mod_asis.so</li>
<li>mod_auth_basic.so</li>
<li>mod_auth_digest.so</li>
<li>mod_authn_alias.so</li>
<li>mod_authn_anon.so</li>
<li>mod_authn_dbd.so</li>
<li>mod_authn_dbm.so</li>
<li>mod_authn_default.so</li>
<li>mod_authn_file.so</li>
<li>mod_authnz_ldap.so</li>
<li>mod_authz_dbm.so</li>
<li>mod_authz_default.so</li>
<li>mod_authz_groupfile.so</li>
<li>mod_authz_host.so</li>
<li>mod_authz_owner.so</li>
<li>mod_authz_user.so</li>
<li>mod_autoindex.so</li>
<li>mod_cache.so</li>
<li>mod_cern_meta.so</li>
<li>mod_cgid.so</li>
<li>mod_cgi.so</li>
<li>mod_dav_fs.so</li>
<li>mod_dav.so</li>
<li>mod_dbd.so</li>
<li>mod_deflate.so</li>
<li>mod_dir.so</li>
<li>mod_disk_cache.so</li>
<li>mod_dumpio.so</li>
<li>mod_env.so</li>
<li>mod_expires.so</li>
<li>mod_ext_filter.so</li>
<li>mod_filter.so</li>
<li>mod_headers.so</li>
<li>mod_ident.so</li>
<li>mod_include.so</li>
<li>mod_info.so</li>
<li>mod_ldap.so</li>
<li>mod_log_config.so</li>
<li>mod_log_forensic.so</li>
<li>mod_logio.so</li>
<li>mod_mime_magic.so</li>
<li>mod_mime.so</li>
<li>mod_negotiation.so</li>
<li>mod_proxy_ajp.so</li>
<li>mod_proxy_balancer.so</li>
<li>mod_proxy_connect.so</li>
<li>mod_proxy_ftp.so</li>
<li>mod_proxy_http.so</li>
<li>mod_proxy_scgi.so</li>
<li>mod_proxy.so</li>
<li>mod_reqtimeout.so</li>
<li>mod_rewrite.so</li>
<li>mod_setenvif.so</li>
<li>mod_speling.so</li>
<li>mod_status.so</li>
<li>mod_substitute.so</li>
<li>mod_suexec.so</li>
<li>mod_unique_id.so</li>
<li>mod_userdir.so</li>
<li>mod_usertrack.so</li>
<li>mod_version.so</li>
<li>mod_vhost_alias.so</li>
</ul>


<h3>Automatischer Start</h3>

<figure class='code'><figcaption><span>Automatischer Start </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># chkconfig | grep httpd</span>
</span><span class='line'>httpd             0:off   1:off   2:off   3:off   4:off   5:off   6:off
</span><span class='line'><span class="c"># chkconfig httpd on</span>
</span><span class='line'><span class="c"># chkconfig | grep httpd</span>
</span><span class='line'>httpd             0:off   1:off   2:on    3:on    4:on    5:on    6:off
</span></code></pre></td></tr></table></div></figure>


<p>Danach: Reboot und Test, ob der Prozess &#8220;httpd&#8221; läuft.</p>

<h3>Firewall öffnen</h3>

<figure class='code'><figcaption><span>/etc/sysconfig/iptables </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gd">--- iptables~   2013-06-26 08:07:03.000000000 +0200</span>
</span><span class='line'><span class="gi">+++ iptables 2013-06-26 09:34:09.638267508 +0200</span>
</span><span class='line'><span class="gu">@@ -8,6 +8,8 @@</span>
</span><span class='line'> -A INPUT -p icmp -j ACCEPT
</span><span class='line'> -A INPUT -i lo -j ACCEPT
</span><span class='line'> -A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT
</span><span class='line'><span class="gi">+-A INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT</span>
</span><span class='line'><span class="gi">+-A INPUT -m state --state NEW -m tcp -p tcp --dport 443 -j ACCEPT</span>
</span><span class='line'> -A INPUT -j REJECT --reject-with icmp-host-prohibited
</span><span class='line'> -A FORWARD -j REJECT --reject-with icmp-host-prohibited
</span><span class='line'> COMMIT
</span></code></pre></td></tr></table></div></figure>


<p>Danach dann Neustart der Firewall mit <code>/etc/init.d/iptables restart</code>.
Jetzt sollte man im Browser die Begrüßungsseite sehen können:
<a href="http://192.168.56.101">http://192.168.56.101</a>.</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/06/27/centos/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Gallerie - Installation von CentOS-6.4 in einer VM]]></title>
<link href="http://uli-heller.github.com/2013/06/26/gallery/"/>
<updated>2013-06-26T08:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/06/26/gallery</id>

      <content type="html"><![CDATA[<p>Die nachfolgende Gallerie zeigt, wie ich CentOS-6.4 in einer
VM installiert habe.</p>

<!-- more -->




<script src="http://uli-heller.github.com/javascripts/fotorama/jquery-1.10.1.min.js"></script>


<p><link href="http://uli-heller.github.com/javascripts/fotorama/fotorama.css" rel="stylesheet"><script src="http://uli-heller.github.com/javascripts/fotorama/fotorama.js"></script><div class="fotorama" data-autoplay="3000" data-transition="dissolve" data-nav="thumbs" data-allow-full-screen="true" data-keyboard="true" data-width="80%" data-thumb-with="64" data-thumb-height="48"><a href="http://uli-heller.github.com/images/galleries/centos/001-new-vm.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/001-new-vm.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/002-new-vm.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/002-new-vm.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/003-new-vm.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/003-new-vm.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/004-new-vm-harddisk.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/004-new-vm-harddisk.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/005-new-vm-harddisk.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/005-new-vm-harddisk.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/006-new-vm-harddisk.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/006-new-vm-harddisk.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/007-vm.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/007-vm.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/008-vm-boot-dvd.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/008-vm-boot-dvd.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/009-boot-dvd.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/009-boot-dvd.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/010-booting-from-dvd.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/010-booting-from-dvd.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/011-skip-check.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/011-skip-check.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/012-welcome.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/012-welcome.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/013-language.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/013-language.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/014-keyboard.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/014-keyboard.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/015-init-hd.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/015-init-hd.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/016-timezone.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/016-timezone.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/017-root.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/017-root.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/018-root-is-too-short.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/018-root-is-too-short.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/019-rootroot.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/019-rootroot.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/020-use-anyway.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/020-use-anyway.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/021-partitioning.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/021-partitioning.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/022-write-to-disk.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/022-write-to-disk.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/023-installing.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/023-installing.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/024-booting.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/024-booting.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/025-login.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/025-login.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/026-root-rootroot.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/026-root-rootroot.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/027-network.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/027-network.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/028-yum-update.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/028-yum-update.png"/></a><a href="http://uli-heller.github.com/images/galleries/centos/029-yum-update.png"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/029-yum-update.png"/></a></div> <!--class="fotorama" data-nav="thumbs" --></p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/06/26/gallery/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Ubuntu auf einem Macbook Air 2013]]></title>
<link href="http://uli-heller.github.com/2013/06/24/macbook-air/"/>
<updated>2013-06-24T05:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/06/24/macbook-air</id>

      <content type="html"><![CDATA[<p>Bedingt durch die Probleme mit meinem Samsung-Notebook habe ich
mir nun ein Macbook Air 2013 11 Zoll gegönnt. Erste Eindrücke habe
ich mit Live-CDs und Ad-Hoc-Installationen gesammelt. Hier nun
mein Weg zu einem &#8220;richtig&#8221; funktionierenden System.</p>

<!-- more -->


<h2>Erstellung eines Installationsmediums</h2>

<p>Einfach das Mac-Iso von &#8220;Ubuntu-12.04.2, 64bit für Mac&#8221;
auf einen USB-Stick schreiben mittels <code>dd</code>.</p>

<h2>Anschließen der Test-Platte</h2>

<p>Für die Installationstests habe ich eine externe USB-Festplatte
angeschlossen. Es handelt sich dabei um eine etwas ältere SSD in
einem USB3-Festplattengehäuse.</p>

<h2>Starten der Installation</h2>

<p>Den Stick an&#8217;s Macbook anschließen und beim Neustart die &#8220;Alt&#8221;-Taste
gedrückt halten. Es erscheint eine Auswahl, bei der ich den Punkt
&#8220;Windows&#8221; mit dem stilisierten USB-Medium angewählt habe. Danach startet
das Installationsmedium wie gewohnt.</p>

<h2>Durchführen der Installation</h2>

<p>Die Installation läuft problemlos durch. Ich habe einfach darauf geachtet,
dass</p>

<ul>
<li>die Installation die externe Platte als Ziel hat</li>
<li>der Boot-Block von GRUB in den MasterBootRecord der externen Platte
geschrieben wird</li>
</ul>


<h2>Durchführen der Aktualisierung</h2>

<p>Zur Durchführung der Aktualisierung benötigt man eine Verbindung in&#8217;s
Internet. Zunächst habe ich mit USB-WLAN-Karten rumgespielt:</p>

<ul>
<li>TP-Link TL-WN275N &#8230; hat auch nach längeren Experimenten nicht funktioniert</li>
<li>ISY &#8230; hat sofort funktioniert, aber nach ein paar Minuten dann den
Geist aufgegeben - jetzt funktioniert er auch an anderen Rechnern nicht mehr</li>
</ul>


<p>Dann bin ich auf einen USB-2-Ethernet-Adapter ausgewichen. Damit klappt&#8217;s
ohne Probleme.</p>

<h2>Inbetriebnahme des WLAN-Adapters</h2>

<p>Mein Hauptproblem mit dem Macbook Air 2013 war der WLAN-Adapter.
Die Standard-Varianten wie &#8220;Zusätzliche Treiber laden&#8221; haben bei
mir nicht funktioniert.</p>

<h3>Herunterladen der Quelldateien für &#8220;bcmwl-kernel-sources&#8221; von Saucy</h3>

<p>Hier der <a href="https://launchpad.net/ubuntu/+source/bcmwl/6.30.223.30+bdcom-0ubuntu2">Link</a> zum Herunterladen. Es müssen 3 Dateien geladen werden:</p>

<ul>
<li>*.tar.gz</li>
<li>*.diff.gz</li>
<li>*.dsc</li>
</ul>


<h3>Erzeugen des DEB-Paketes</h3>

<ul>
<li><code>sudo apt-get build-dep bcmwl</code></li>
<li><code>dpkg-source -x bcmwl*dsc</code></li>
<li><code>cd bcmwl*bdcom</code></li>
<li><code>dpkg-buildpackage</code></li>
</ul>


<h3>Einspielen des DEB-Paketes</h3>

<p>Das DEB-Paket habe ich eingespielt mit <code>dpkg -i bcmwl-kernel-source_6.30.223.30+bdcom-0ubuntu2_amd64.deb</code>. Die Installation blieb
hängen bei &#8220;DKMS: install completed&#8221;, also habe ich sie abgebrochen mit Strg-C.</p>

<p>Zur Sicherheit habe ich noch folgende Kommandos &#8220;nachgeschoben&#8221;:</p>

<ul>
<li><code>sudo update-initramfs -u</code></li>
<li><code>sudo update-grub2</code></li>
</ul>


<p>Dann ein Neustart des Rechners, danach wird der WLAN-Adapter erkannt und
kann konfiguriert werden.</p>

<p>Hinweis: Beim zweiten Installieren hat&#8217;s ohne Hänger geklappt.</p>

<h2>Probleme</h2>

<h3>Systemstart mit &#8220;linux-generic-lts-raring&#8221; klappt nicht</h3>

<p>Mit dem Kernel &#8220;linux-generic-lts-raring&#8221; habe ich beobachtet,
dass der Start nicht klappt. Der Rechner bleibt hängen bei
&#8220;Initiale Ramdisk wird geladen&#8230;&#8221;.</p>

<p>Diesen Hänger habe ich auch einmal mit &#8220;linux-generic-lts-quantal&#8221;
beobachtet.
Danach habe ich den Raring-Kernel nochmal ausprobiert und
er hat problemlos funktioniert.</p>

<p>Eventuell liegt&#8217;s auch an der externen USB-Platte, die ich
aktuell für meine Tests verwende. Der Start ist eh&#8217; etwas langsam
- üblicherweise sieht man die ersten beiden Startzeilen ja kaum,
bei mir verharrt der Boot-Vorgang hierbei aber grob 2 Sekunden.</p>

<h3>Normaler Systemstart klappt nicht - &#8220;Wiederherstellungsmodus&#8221; ist angesagt</h3>

<p>Der normale Systemstart funktioniert nicht,
der Rechner bleibt mit schwarzem Bildschirm hängen.</p>

<h4>Wiederherstellungsmodus</h4>

<p>Die Auswahl des Wiederherstellungsmodus mit anschließendem &#8220;RESUME&#8221;
funktioniert.</p>

<h4>Textmodus</h4>

<p>Die wohl bessere Lösung ist das Umstellen auf Textmodus.</p>

<ul>
<li>/etc/default/grub editieren - Zeile mit &#8220;#GRUB_TERMINAL=console&#8221; bearbeiten, genauer: Raute &#8216;#&#8217; entfernen</li>
<li><code>sudo update-grub2</code> ausführen</li>
<li><code>sudo reboot</code> - Neustart sollte nun klappen</li>
</ul>


<h3>Installation von bcmwl-kernel-source_6.30.223.30+bdcom-0ubuntu2_amd64.deb bleibt hängen</h3>

<ul>
<li>Abbrechen mit Strg-C</li>
<li><code>sudo update-initramfs -u</code></li>
<li><code>sudo update-grub2</code></li>
</ul>


<h3>WLAN ist erst nach einer Minute betriebsbereit</h3>

<p>Dieses Problem habe ich bislang erst einmal beobachtet. Irgendwo
habe ich auch schonmal eine Lösung entdeckt. Wenn&#8217;s häufiger auftritt,
dann beschreibe ich die Korrektur hier.</p>

<h3>Vertauschte Tasten</h3>

<p>Diese Tasten sind vertauscht:</p>

<ul>
<li>&#8220;Kleiner-Größer-Pipe&#8221; - links neben dem &#8220;Y&#8221;</li>
<li>&#8220;Dächlein-Kreis&#8221; - links neben der &#8220;1&#8221;</li>
</ul>


<p>Ich habe einige Hinweise gefunden, wie man das korrigieren kann:</p>

<ul>
<li><a href="http://wiki.ubuntuusers.de/Apple_Computer/Einrichtung">http://wiki.ubuntuusers.de/Apple_Computer/Einrichtung</a> &#8230; scheint veraltet zu sein</li>
<li><a href="https://help.ubuntu.com/community/AppleKeyboard#Correcting_swapped_keys_and_wrong_keymaps_for_international_.28non-US.29_keyboards">https://help.ubuntu.com/&#8230;/AppleKeyboard</a> &#8230; funktioniert bei mir nicht, weil &#8220;hid_apple&#8221; nicht existiert</li>
<li><a href="http://forum.ubuntuusers.de/topic/macbook-und-vertauscht-rechte-maustaste-ueber-/#post-2780335">http://forum.ubuntuusers.de/topic/macbook-und-vertauscht-rechte-maustaste-ueber-/#post-2780335</a> &#8230; hat geklappt, korrigiert&#8217;s aber wahrscheinlich nur im X-Desktop und nicht in der Konsole und im Anmeldeschirm</li>
</ul>


<h4>Analysen</h4>

<p>Analog zu <a href="https://bugs.launchpad.net/ubuntu/+source/linux/+bug/942184">https://bugs.launchpad.net/ubuntu/+source/linux/+bug/942184</a>:</p>

<figure class='code'><figcaption><span>dmesg|grep hid </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>uli@uli-MacBookAir-11:~$ dmesg|grep hid
</span><span class='line'>[    3.956709] usbcore: registered new interface driver usbhid
</span><span class='line'>[    3.956715] usbhid: USB HID core driver
</span><span class='line'>[    4.056298] hid-generic 0003:05AC:0290.0001: hiddev0,hidraw0: USB HID v1.10 Device [Apple Inc. Apple Internal Keyboard / Trackpad] on usb-0000:00:14.0-5/input0
</span><span class='line'>[    4.056947] hid-generic 0003:05AC:0290.0002: input,hiddev0,hidraw1: USB HID v1.10 Keyboard [Apple Inc. Apple Internal Keyboard / Trackpad] on usb-0000:00:14.0-5/input1
</span><span class='line'>[    4.057971] hid-generic 0003:05AC:0290.0003: input,hiddev0,hidraw2: USB HID v1.10 Mouse [Apple Inc. Apple Internal Keyboard / Trackpad] on usb-0000:00:14.0-5/input2
</span><span class='line'>[    4.287766] hid-generic 0003:05AC:820A.0004: input,hidraw3: USB HID v1.11 Keyboard [HID 05ac:820a] on usb-0000:00:14.0-3.1/input0
</span><span class='line'>[    4.379176] hid-generic 0003:05AC:820B.0005: input,hidraw4: USB HID v1.11 Mouse [HID 05ac:820b] on usb-0000:00:14.0-3.2/input0</span></code></pre></td></tr></table></div></figure>


<p>Sieht so aus, als wäre bei meiner Tastatur die &#8220;0290&#8221; die magische Konstante. Mit einem Patch
analog zu <a href="https://launchpadlibrarian.net/94610947/alu2011.patch">https://launchpadlibrarian.net/94610947/alu2011.patch</a>
oder auch <a href="https://github.com/kui/hid-apple">https://github.com/kui/hid-apple</a>
oder auch <a href="https://bugzilla.kernel.org/show_bug.cgi?id=60181">https://bugzilla.kernel.org/show_bug.cgi?id=60181</a> sollte das dann wohl korrigierbar sein.</p>

<h3>Enttäuschende Akku-Laufzeit</h3>

<p>Zur Akku-Laufzeit kann ich momentan noch keine richtig fundierte Aussage
treffen, weil ich</p>

<ul>
<li>das Gerät noch nicht zur täglichen Arbeit einsetze und</li>
<li>ich aktuell immer eine externe Festplatte verwende und</li>
<li>ich bislang nur &#8220;Installationsspielereien&#8221; gemacht habe</li>
</ul>


<p>Rein vom subjektiven Eindruck her würde ich sagen, dass ich bei weitem
nicht auf 9 Stunden Laufzeit komme. Ob ich die mit OSX erreiche, weiß ich
auch nicht - ich habe OSX noch kein einziges mal gestartet.</p>

<h2>Änderungen</h2>

<ul>
<li>2013-07-26 &#8230; Verweis auf Kernel-Bug 60181 aufgenommen (Tasten + Touchpad)</li>
<li>2013-07-05 &#8230; Logs zum Problem &#8220;Vertauschte Tasten&#8221;</li>
<li>2013-07-03 &#8230; Abschnitt zur Akku-Laufzeit aufgenommen</li>
</ul>

<p><a rel="bookmark" href="http://uli-heller.github.com/2013/06/24/macbook-air/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[150Mbps Wireless N Nano USB Adapter TP-Link TL-WN725N]]></title>
<link href="http://uli-heller.github.com/2013/06/19/tl-wn725n/"/>
<updated>2013-06-19T12:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/06/19/tl-wn725n</id>

      <content type="html"><![CDATA[<p>Da bei meinem Macbook Air 2013 das WLAN nicht funktioniert, habe ich
mir einen Nano-USB-Adapter gekauft und plane, damit die Zeit zu überbrücken
bis ein Treiber für den internen WLAN-Adapter verfügbar ist. Leider
funktioniert der USB-Adapter erstmal auch nicht.</p>

<!-- more -->


<h2>Einstecken und Sichten</h2>

<p>Einfaches Einstecken und Sichten bringt leider keinen sonderlich tollen
Erfolg.</p>

<ul>
<li><code>ifconfig -a</code> &#8230; zeigt keine neue Schnittstelle an</li>
<li><code>tail /var/log/syslog</code> &#8230; ist auch wenig aussagekräftig</li>
</ul>


<figure class='code'><figcaption><span>/var/log/syslog </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>Jun 19 06:54:46 . usb 2-1.2: new high-speed USB device number 5 using ehci-pci
</span><span class='line'>Jun 19 06:54:46 . usb 2-1.2: New USB device found, idVendor=0bda, idProduct=8179
</span><span class='line'>Jun 19 06:54:46 . usb 2-1.2: New USB device strings: Mfr=1, Product=2, SerialNumJur=3
</span><span class='line'>Jun 19 06:54.46 . usb 2-1.2: Product: 802.11n NIC
</span><span class='line'>Jun 19 06:54:46 . usb 2-1.2: Manufacturer: Realtek
</span><span class='line'>Jun 19 06:54:46 . usb 2-1.2: SerialNumber: 00E04C0001</span></code></pre></td></tr></table></div></figure>


<h2>Zusätzliche Treiber</h2>

<p>Der nächste Versuch: &#8220;Zusätzliche Treiber&#8221; bei den Systemeinstellungen.
Leider wird auch bei eingestecktem Adapter kein zusätzlicher Treiber angezeigt.</p>

<h2>Bestehendes Kernel-Modul r8192u_usb</h2>

<p>Sichtung der geladenen und der verfügbaren Kernel-Module. Ich &#8220;weiß&#8221;, dass
die RALINK-Module üblicherweise mit &#8220;r8&#8221; im Namen beginnen:</p>

<ul>
<li>`lsmod|grep r8&#8217; &#8230; r8169</li>
<li><p><code>cd /lib/modules; find . -name "r8*"</code></p>

<pre><code>./3.8.0-25-generic/kernel/drivers/mtd/nand/r852.ko
./3.8.0-25-generic/kernel/drivers/net/ethernet/realtek/r8169.ko
./3.8.0-25-generic/kernel/drivers/usb/gadget/r8a66597-udc.ko
./3.8.0-25-generic/kernel/drivers/usb/host/r8a66597-hcd.ko
./3.8.0-25-generic/kernel/drivers/staging/rtl8192e/rtl8192e/r8192e_pci.ko
./3.8.0-25-generic/kernel/drivers/staging/rtl8187se/r8187se.ko
./3.8.0-25-generic/kernel/drivers/staging/rtl8192u/r8192u_usb.ko
./3.8.0-25-generic/kernel/drivers/staging/rtl8712/r8712u.ko
</code></pre></li>
</ul>


<p>Hiervon sieht der &#8220;r8192u_usb.ko&#8221; am vielversprechendsten aus.
Ich lade ihn manuell mit <code>sudo modprobe r8192u_usb</code>. Leider bringt
das keine Verbesserung, der WLAN-Adapter bleibt &#8220;unsichtbar&#8221; - auch
nach erneutem Aus- und Einstecken.</p>

<h2>Bestehendes Kernel-Modul rtl8192cu</h2>

<p>Keine Besserung.</p>

<h2>Bestehendes Kernel-Modul rtl8150</h2>

<p>Keine Besserung.</p>

<h2>Treiber von der Realtek-Webseite</h2>

<ul>
<li><a href="http://www.r-statistics.com/2011/11/edimax-ew-7811un-usb-wireless-connecting-to-a-network-on-ubuntu-11-10/">Anleitung</a></li>
<li><a href="http://www.realtek.com.tw/downloads/downloadsView.aspx?Langid=1&amp;PNid=48&amp;PFid=48&amp;Level=5&amp;Conn=4&amp;DownTypeID=3&amp;GetDown=false&amp;Downloads=true#2742">Realtek</a></li>
<li>Datei: RTL8192xC_USB_linux_v3.4.4_4749.20121105.zip</li>
</ul>


<p>Die Kompilierung bricht unter dem 3.8-er-Kernel ab mit Fehlermeldungen.</p>

<h2>Treiber von GitHub</h2>

<ul>
<li><a href="http://forum.ubuntuusers.de/topic/problem-mit-usb-adapter-tp-link-tl-wn725n-v2/#post-5536902">Anleitung</a></li>
</ul>


<p>Die Kompilierung bricht unter dem 3.8-er-Kernel ab mit Fehlermeldungen. Diese Fehlermeldungen kann man noch umgehen, indem man die Quelltexte leicht variiert. Leider kann das frisch erzeugte Modul anschließend nicht geladen werden wegen unaufgelöster Referenzen (&#8220;daemonize&#8221; und &#8220;kernel_thread&#8221;).</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/06/19/tl-wn725n/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Ubuntu auf einem Macbook Air - erste Eindrücke]]></title>
<link href="http://uli-heller.github.com/2013/06/16/macbook-air/"/>
<updated>2013-06-16T12:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/06/16/macbook-air</id>

      <content type="html"><![CDATA[<p>Bedingt durch die Probleme mit meinem Samsung-Notebook habe ich
mir nun ein Macbook Air 2013 11 Zoll gegönnt.</p>

<!-- more -->


<h2>Ubuntu-12.04.2 Live CD auf Macbook Air 2011</h2>

<p>Einfach das Mac-Iso auf einen USB-Stick schreiben mittels @dd@,
den Stick an&#8217;s Macbook anschließen und beim Neustart die &#8220;Alt&#8221;-Taste
gedrückt halten.</p>

<p>Das Macbook startet völlig problemlos. Alles scheint zu funktionieren,
sogar die WLAN-Karte.</p>

<h2>Ubuntu-12.04.2 Live CD auf Macbook Air 2013</h2>

<p>Vorgehen wie zuvor. Bereits beim Start fällt auf, dass der &#8220;Splash-Screen&#8221;
mit dem Ubuntu-Logo nur in Textdarstellung erscheint. WLAN funktioniert
nicht und beim Versuch, den proprietären Treiber zu aktivieren stürzt der
Kernel ab.</p>

<h2>Ubuntu-13.04 Live CD auf Macbook Air 2013</h2>

<p>Vorgehen wie zuvor, nur mit der 13.04-CD. Der Start sieht wesentlich besser
aus - eigentlich genauso, wie bei 12.04.2 mit dem alten Macbook Air. Der
&#8220;Splash Screen&#8221; erscheint in graphischer Form.</p>

<p>Leider funktioniert die WLAN-Karte im Live-CD-Modus nicht. Der proprietäre
Treiber wird auch nicht zum Nachladen angeboten.</p>

<h2>Ubuntu-12.04.2 Test-Installation auf Macbook Air 2013</h2>

<p>Die Test-Installation verläuft weitgehend problemlos.
Der Start des installierten Systems funktioniert aber erstmal nicht, der
Bildschirm bleibt nach dem Grub-Menü einfach schwarz.
Über den Zwischenschritt &#8220;recovery mode&#8221; läßt sich der Desktop
aber normal starten.</p>

<p>Im Desktop fällt auf:</p>

<ul>
<li>die &#8220;Kleiner-Größer-Pipe-Taste&#8221; ist vertauscht mit der
&#8220;Kreis-Dächlein-Taste&#8221; links neben der &#8220;1&#8221;.</li>
<li>die Funktionstasten zur Änderung der Helligkeit, &#8230; funktionieren
nicht</li>
</ul>


<p>Da der WLAN-Adapter nicht funktioniert, kann ich aber</p>

<ul>
<li>keine Updates einspielen</li>
<li>keine proprietären Treiber installieren</li>
</ul>


<p>Bin also erstmal &#8220;ausgebremst&#8221;.</p>

<h2>Ubuntu-12.04.2 Test-Installation auf Macbook Air 2011</h2>

<p>Hierfür habe ich einfach die Test-Installation vom Macbook Air 2013
genommen und an das ältere Macbook Air drangestöpselt.</p>

<ul>
<li>Der Start ist ähnlich wie beim 2013-er-Modell: Bildschirm bleibt schwarz</li>
<li><p>Recovery-Mode: Bleibt hängen mit</p>

<pre><code>Loading Linux 3.5.0-23-generic ...
Loading initial ramdisk
</code></pre></li>
</ul>


<p>Die Laufwerkslampe blinkt dabei permanent. Nachdem sich in 15 Minuten keine
Änderung getan hat, habe ich den Boot-Vorgang abgebrochen.</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/06/16/macbook-air/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[WLAN-Konfiguration beim Ubuntu-Server]]></title>
<link href="http://uli-heller.github.com/2013/06/14/ubuntu-server-wlan/"/>
<updated>2013-06-14T12:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/06/14/ubuntu-server-wlan</id>

      <content type="html"><![CDATA[<p>Meinen alten EEEPC würde ich gerne als DHCP-Server weiterverwenden.
Also: Ubuntu-12.04-Server drauf und los geht&#8217;s. Dumm nur:
Aktuell ist unklar, wie ich die WLAN-Konfiguration hinbekomme.
Auf Desktop-Systemen macht man das ja mit dem NetworkManager,
was auf dem Server ohne graphische Benutzerschnittstelle schwierig ist.</p>

<!-- more -->


<h2>Vorbereitungen</h2>

<p>Auf dem EEEPC habe ich diese Grundinstallation vorgenommen:</p>

<ul>
<li>Ubuntu-12.04.2 Server, 32 bit</li>
<li>Raring-Kernel</li>
<li>Alle Aktualisierungen vom heutigen Tage (2013-06-14)</li>
</ul>


<h2>Grundtests</h2>

<p>Die Grundtests habe ich von hier: <a href="http://ubuntuforums.org/showthread.php?t=1094204">http://ubuntuforums.org/showthread.php?t=1094204</a></p>

<figure class='code'><figcaption><span>Grundtests </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$ sudo -s
</span><span class='line'># ifconfig wlan0 up
</span><span class='line'># iwlist scan
</span><span class='line'>wlan0     Scan completed :
</span><span class='line'>          Cell 01 - Address: 00:3f:c6:3c:dd:a2
</span><span class='line'>                    Channel:1
</span><span class='line'>                    Frequency:2.412 GHz (Channel 1)
</span><span class='line'>                    Quality=37/70  Signal level=-73 dBm  
</span><span class='line'>                    Encryption key:on
</span><span class='line'>                    ESSID:"SiegfriedUndRoy"
</span><span class='line'>...</span></code></pre></td></tr></table></div></figure>


<h2>Konfiguration als WLAN-Client</h2>

<p>Die Konfiguration habe ich hierher:
<a href="http://ubuntuforums.org/showthread.php?t=2007475">http://ubuntuforums.org/showthread.php?t=2007475</a>.
Sie ist gegenüber der Vorlage leicht abgewandelt.</p>

<figure class='code'><figcaption><span>/etc/network/interfaces </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>...
</span><span class='line'>auto wlan0
</span><span class='line'>iface wlan0 inet dhcp
</span><span class='line'>  wpa-ssid SiegfriedUndRoy
</span><span class='line'>  wpa-psk  SharpTiger</span></code></pre></td></tr></table></div></figure>


<p>Hierbei muß nach &#8220;wpa-ssid&#8221; der Name des zu verwendenden Funknetzwerkes
eingetragen werden und bei &#8220;wpa-psk&#8221; das dabei zu verwendende Kennwort.
Bevor Fragen aufkommen: &#8220;SiegfriedUndRoy&#8221; und &#8220;SharpTiger&#8221; sind erfundene
Werte.</p>

<p>Nun muß nur noch das WLAN-Interface aktiviert werden.</p>

<figure class='code'><figcaption><span>WLAN-Interface aktivieren </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># ifdown wlan0 # Fehlermeldung ignorieren</span>
</span><span class='line'><span class="c"># ifup wlan0   # Hier darf keine Fehlermeldung erscheinen</span>
</span><span class='line'>ssh stop/waiting
</span><span class='line'>ssh start/running, process 1202
</span><span class='line'><span class="c"># ifconfig wlan0</span>
</span><span class='line'>wlan0     Link encap:Ethernet  HWaddr 00:3f:c6:3c:dd:a2
</span><span class='line'>          inet addr:192.168.178.27  Bcast:192.168.178.255  Mask:255.255.255.0
</span><span class='line'>          inet6 addr: fe80::215:afff:fe88:ab6d/64 Scope:Link
</span><span class='line'>          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
</span><span class='line'>          RX packets:696 errors:0 dropped:0 overruns:0 frame:0
</span><span class='line'>          TX packets:496 errors:0 dropped:0 overruns:0 carrier:0
</span><span class='line'>          collisions:0 txqueuelen:1000
</span><span class='line'>          RX bytes:526709 <span class="o">(</span>526.7 KB<span class="o">)</span>  TX bytes:66404 <span class="o">(</span>66.4 KB<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Wichtig ist, dass bei &#8220;inet addr:&#8221; eine IP-Adresse ähnlich der bei
mir angezeigten 192.168.178.27 steht. Wie&#8217;s aussieht funktioniert&#8217;s schon!</p>

<h2>Konfiguration als Access-Point</h2>

<p>Grob gehe ich nach dieser Anleitung vor: <a href="http://wiki.ubuntuusers.de/WLAN_Router">http://wiki.ubuntuusers.de/WLAN_Router</a></p>

<h3>Zusatzpakete installieren</h3>

<figure class='code'><figcaption><span>Zusatzpakete installieren </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo apt-get install -y hostapd dnsmasq
</span><span class='line'>Paketlisten werden gelesen... Fertig
</span><span class='line'>Abhängigkeitsbaum wird aufgebaut
</span><span class='line'>Statusinformationen werden eingelesen... Fertig
</span><span class='line'>Die folgenden Pakete wurden automatisch installiert und werden nicht mehr benötigt:
</span><span class='line'>  crda wireless-regdb
</span><span class='line'>Verwenden Sie »apt-get autoremove«, um sie zu entfernen.
</span><span class='line'>Die folgenden zusätzlichen Pakete werden installiert:
</span><span class='line'>  dnsmasq-base libnetfilter-conntrack3
</span><span class='line'>Die folgenden NEUEN Pakete werden installiert:
</span><span class='line'>  dnsmasq dnsmasq-base hostapd libnetfilter-conntrack3
</span><span class='line'>...
</span><span class='line'>hostapd <span class="o">(</span>1:0.7.3-4ubuntu1<span class="o">)</span> wird eingerichtet ...
</span><span class='line'>Trigger für libc-bin werden verarbeitet ...
</span><span class='line'>ldconfig deferred processing now taking place
</span></code></pre></td></tr></table></div></figure>


<h3>Konfiguration von hostapd</h3>

<p>Zunächst muß die Datei /etc/default/hostapd
wie folgt modifiziert werden:</p>

<figure class='code'><figcaption><span>/etc/default/hostapd </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'># diff -u /etc/default/hostapd.orig /etc/default/hostapd
</span><span class='line'><span class="gd">--- hostapd.orig 2013-06-14 13:26:20.390584872 +0200</span>
</span><span class='line'><span class="gi">+++ hostapd  2013-06-14 13:27:14.698854220 +0200</span>
</span><span class='line'><span class="gu">@@ -7,7 +7,8 @@</span>
</span><span class='line'> # file and hostapd will be started during system boot. An example configuration
</span><span class='line'> # file can be found at /usr/share/doc/hostapd/examples/hostapd.conf.gz
</span><span class='line'> #
</span><span class='line'><span class="gd">-#DAEMON_CONF=&quot;&quot;</span>
</span><span class='line'><span class="gi">+DAEMON_CONF=&quot;/etc/hostapd.conf&quot;</span>
</span><span class='line'><span class="gi">+RUN_DAEMON=yes</span>
</span><span class='line'>
</span><span class='line'> # Additional daemon options to be appended to hostapd command:-
</span><span class='line'> #    -d   show more debug messages (-dd for even more)
</span></code></pre></td></tr></table></div></figure>


<p>Dann brauchen wir zusätzlich noch die Konfigurationsdatei
/etc/hostapd.conf. Das Grundgerüst habe ich von hier:
<a href="http://wiki.ubuntuusers.de/WLAN_Router">http://wiki.ubuntuusers.de/WLAN_Router</a></p>

<p>Liquid error: undefined method `match&#8217; for nil:NilClass</p>

<h3>Konfiguration der Netzwerkschnittstelle</h3>

<figure class='code'><figcaption><span>/etc/network/interfaces </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>...
</span><span class='line'>auto wlan0
</span><span class='line'>iface wlan0 inet static
</span><span class='line'>  address 192.168.3.1
</span><span class='line'>  netmask 255.255.255.0
</span><span class='line'>  broadcast 192.168.3.255
</span><span class='line'>
</span><span class='line'># hostap und dnsmasq neu starten
</span><span class='line'>up /etc/init.d/hostapd restart
</span><span class='line'>up /etc/init.d/dnsmasq restart</span></code></pre></td></tr></table></div></figure>


<h3>Konfiguration von dnsmasq</h3>

<figure class='code'><figcaption><span>/etc/dnsmasq.conf </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'># diff -u /etc/dnsmasq.conf.orig /etc/dnsmasq.conf
</span><span class='line'><span class="gd">--- /etc/dnsmasq.conf.orig   2013-06-14 13:57:34.856639712 +0200</span>
</span><span class='line'><span class="gi">+++ /etc/dnsmasq.conf    2013-06-14 13:58:18.400855636 +0200</span>
</span><span class='line'><span class="gu">@@ -142,7 +142,7 @@</span>
</span><span class='line'> # a lease time. If you have more than one network, you will need to
</span><span class='line'> # repeat this for each network on which you want to supply DHCP
</span><span class='line'> # service.
</span><span class='line'><span class="gd">-#dhcp-range=192.168.0.50,192.168.0.150,12h</span>
</span><span class='line'><span class="gi">+dhcp-range=192.168.3.50,192.168.3.150,12h</span>
</span><span class='line'>
</span><span class='line'> # This is an example of a DHCP range where the netmask is given. This
</span><span class='line'> # is needed for networks we reach the dnsmasq DHCP server via a relay
</span></code></pre></td></tr></table></div></figure>


<h3>Test</h3>

<p>Nach der Konfiguration erfolgt ein Neustart mit <code>sudo reboot</code>. Danach
kann man sich am WLAN &#8220;HaeberleUndPfleiderer&#8221; mit
dem Kennwort &#8220;ScharfesTigerle&#8221; anmelden.</p>

<ul>
<li>IP-Adresse: <code>ifconfig wlan0</code> - 192.168.3.115</li>
<li>SSH-Zugriff: <code>ssh 192.168.3.1</code> - klappt</li>
</ul>

<p><a rel="bookmark" href="http://uli-heller.github.com/2013/06/14/ubuntu-server-wlan/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[LXC: Clonen eines Containers mit Namen 'x']]></title>
<link href="http://uli-heller.github.com/2013/06/10/lxc-clone-x/"/>
<updated>2013-06-10T17:40:00+02:00</updated>
<id>http://uli-heller.github.com/2013/06/10/lxc-clone-x</id>

      <content type="html"><![CDATA[<p>Seit ich BTRFS-Subvolumes und -Snapshots zum Clonen von
LXC-Containern verwende, erzeuge ich viel mehr dieser
Clones - es geht einfach <em>sehr</em> schnell und verbraucht
fast keine Resourcen.</p>

<p>Beim Rum-Clonen bin ich über einen blöden Fehler gestolpert:
Man kann keinen Container clonen, der &#8220;x&#8221; heißt. Der Vorgang
bricht ab mit der Meldung &#8220;ERROR: can&#8217;t access to &#8216;/var/lib/lyc/x&#8217;&#8221;.</p>

<!-- more -->




<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gh">diff -u /usr/bin/lxc-clone~ /usr/bin/lxc-clone</span>
</span><span class='line'><span class="gd">--- lxc-clone~   2013-06-01 16:16:01.000000000 +0200</span>
</span><span class='line'><span class="gi">+++ lxc-clone    2013-06-10 17:46:19.520162107 +0200</span>
</span><span class='line'><span class="gu">@@ -193,7 +193,7 @@</span>
</span><span class='line'>
</span><span class='line'> echo &quot;Copying rootfs...&quot;
</span><span class='line'> oldroot=`grep lxc.rootfs $lxc_path/$lxc_orig/config | awk -F&#39;[= \t]+&#39; &#39;{ print $2 }&#39;`
</span><span class='line'><span class="gd">-rootfs=`echo $oldroot |sed &quot;s/$lxc_orig/$lxc_new/&quot;`</span>
</span><span class='line'><span class="gi">+rootfs=`echo $oldroot |sed &quot;s@$lxc_path/$lxc_orig@$lxc_path/$lxc_new@&quot;`</span>
</span><span class='line'>
</span><span class='line'> container_running=True
</span><span class='line'> lxc-info -n $lxc_orig --state-is RUNNING || container_running=False
</span></code></pre></td></tr></table></div></figure>



<p><a rel="bookmark" href="http://uli-heller.github.com/2013/06/10/lxc-clone-x/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Perl: CPAN ohne Root]]></title>
<link href="http://uli-heller.github.com/2013/06/10/cpan-ohne-root/"/>
<updated>2013-06-10T06:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/06/10/cpan-ohne-root</id>

      <content type="html"><![CDATA[<p>Manchmal möchte man Perl-Module auf einem Rechner installieren,
ohne dass man Root-Rechte dafür hat - oder umgekehrt: Man
möchte Leuten ermöglichen, auf einem Rechner mit Perl-Modulen
rumzuspielen, für den sie keinen Root-Zugriff haben. Die nachfolgende
Beschreibung bezieht sich auf Ubuntu-12.04.</p>

<!-- more -->


<h2>Vorbereitung: Diverse Pakete installieren</h2>

<p>Für diesen Abschnitt wird &#8220;root&#8221;-Zugriff benötigt!</p>

<pre><code>sudo apt-get install perl-modules
sudo apt-get install liblocal-lib-perl
sudo apt-get install make
sudo apt-get install build-essential
</code></pre>

<h2>Grundeinrichtung von CPAN</h2>

<p>Für die Grundeinrichtung von CPAN wird als &#8220;normaler&#8221; Benutzer
das Kommando <code>cpan</code> ausgeführt. Bei der Ersteinrichtung werden
viele Fragen gestellt, die man am besten einfach &#8220;Abnickt&#8221;.
Wenn was schief läuft: <code>rm -rf ~/.cpan</code> und erneut starten!</p>

<p>Hier das Konsolen-Log der Grundeinrichtung:</p>

<figure class='code'><figcaption><span>Grundeinrichtung von CPAN </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>Sorry, we have to rerun the configuration dialog for CPAN.pm due to
</span><span class='line'>some missing parameters. Configuration will be written to
</span><span class='line'> &lt;&lt;/home/ubuntu/.cpan/CPAN/MyConfig.pm>>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>CPAN.pm requires configuration, but most of it can be done automatically.
</span><span class='line'>If you answer 'no' below, you will enter an interactive dialog for each
</span><span class='line'>configuration option instead.
</span><span class='line'>
</span><span class='line'>Would you like to configure as much as possible automatically? [yes] 
</span><span class='line'>
</span><span class='line'> &lt;install_help>
</span><span class='line'>
</span><span class='line'>Warning: You do not have write permission for Perl library directories.
</span><span class='line'>
</span><span class='line'>To install modules, you need to configure a local Perl library directory or
</span><span class='line'>escalate your privileges.  CPAN can help you by bootstrapping the local::lib
</span><span class='line'>module or by configuring itself to use 'sudo' (if available).  You may also
</span><span class='line'>resolve this problem manually if you need to customize your setup.
</span><span class='line'>
</span><span class='line'>What approach do you want?  (Choose 'local::lib', 'sudo' or 'manual')
</span><span class='line'> [local::lib] 
</span><span class='line'>
</span><span class='line'>ALERT: 'make' is an essential tool for building perl Modules.
</span><span class='line'>Please make sure you have 'make' (or some equivalent) working.
</span><span class='line'>
</span><span class='line'>Autoconfigured everything but 'urllist'.
</span><span class='line'>
</span><span class='line'>Now you need to choose your CPAN mirror sites.  You can let me
</span><span class='line'>pick mirrors for you, you can select them from a list or you
</span><span class='line'>can enter them by hand.
</span><span class='line'>
</span><span class='line'>Would you like me to automatically choose some CPAN mirror
</span><span class='line'>sites for you? (This means connecting to the Internet) [yes] 
</span><span class='line'>
</span><span class='line'>Trying to fetch a mirror list from the Internet
</span><span class='line'>Fetching with HTTP::Tiny:
</span><span class='line'>http://www.perl.org/CPAN/MIRRORED.BY
</span><span class='line'>
</span><span class='line'>Looking for CPAN mirrors near you (please be patient)
</span><span class='line'>.................................. done!
</span><span class='line'>
</span><span class='line'>New urllist
</span><span class='line'>  http://httpupdate37.cpanel.net/CPAN/
</span><span class='line'>  http://cpan.mirrors.uk2.net/
</span><span class='line'>  http://ftp.spbu.ru/CPAN/
</span><span class='line'>
</span><span class='line'>Autoconfiguration complete.
</span><span class='line'>
</span><span class='line'>Attempting to bootstrap local::lib...
</span><span class='line'>
</span><span class='line'>Writing /home/ubuntu/.cpan/CPAN/MyConfig.pm for bootstrap...
</span><span class='line'>commit: wrote '/home/ubuntu/.cpan/CPAN/MyConfig.pm'
</span><span class='line'>Fetching with HTTP::Tiny:
</span><span class='line'>http://httpupdate37.cpanel.net/CPAN/authors/01mailrc.txt.gz
</span><span class='line'>Going to read '/home/ubuntu/.cpan/sources/authors/01mailrc.txt.gz'
</span><span class='line'>............................................................................DONE
</span><span class='line'>Fetching with HTTP::Tiny:
</span><span class='line'>http://httpupdate37.cpanel.net/CPAN/modules/02packages.details.txt.gz
</span><span class='line'>Going to read '/home/ubuntu/.cpan/sources/modules/02packages.details.txt.gz'
</span><span class='line'>  Database was generated on Mon, 10 Jun 2013 03:53:02 GMT
</span><span class='line'>  HTTP::Date not available
</span><span class='line'>..............
</span><span class='line'>  New CPAN.pm version (v2.00) available.
</span><span class='line'>  [Currently running version is v1.960001]
</span><span class='line'>  You might want to try
</span><span class='line'>    install CPAN
</span><span class='line'>    reload cpan
</span><span class='line'>  to both upgrade CPAN.pm and run the new version without leaving
</span><span class='line'>  the current session.
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>..............................................................DONE
</span><span class='line'>Fetching with HTTP::Tiny:
</span><span class='line'>http://httpupdate37.cpanel.net/CPAN/modules/03modlist.data.gz
</span><span class='line'>Going to read '/home/ubuntu/.cpan/sources/modules/03modlist.data.gz'
</span><span class='line'>............................................................................DONE
</span><span class='line'>Going to write /home/ubuntu/.cpan/Metadata
</span><span class='line'>Running make for E/ET/ETHER/local-lib-1.008010.tar.gz
</span><span class='line'>Fetching with HTTP::Tiny:
</span><span class='line'>http://httpupdate37.cpanel.net/CPAN/authors/id/E/ET/ETHER/local-lib-1.008010.tar.gz
</span><span class='line'>Fetching with HTTP::Tiny:
</span><span class='line'>http://httpupdate37.cpanel.net/CPAN/authors/id/E/ET/ETHER/CHECKSUMS
</span><span class='line'>Checksum for /home/ubuntu/.cpan/sources/authors/id/E/ET/ETHER/local-lib-1.008010.tar.gz ok
</span><span class='line'>---- Unsatisfied dependencies detected during ----
</span><span class='line'>----      ETHER/local-lib-1.008010.tar.gz     ----
</span><span class='line'>    ExtUtils::MakeMaker [build_requires]
</span><span class='line'>Running make test
</span><span class='line'>  Make had some problems, won't test
</span><span class='line'>  Delayed until after prerequisites
</span><span class='line'>Running make install
</span><span class='line'>  Make had some problems, won't install
</span><span class='line'>  Delayed until after prerequisites
</span><span class='line'>Tried to deactivate inactive local::lib '/home/ubuntu/perl5'
</span><span class='line'>
</span><span class='line'>local::lib is installed. You must now add the following environment variables
</span><span class='line'>to your shell configuration files (or registry, if you are on Windows) and
</span><span class='line'>then restart your command line shell and CPAN before installing modules:
</span><span class='line'>
</span><span class='line'>Use of uninitialized value $deactivating in numeric eq (==) at /usr/share/perl5/local/lib.pm line 354.
</span><span class='line'>Use of uninitialized value $deactivating in numeric eq (==) at /usr/share/perl5/local/lib.pm line 356.
</span><span class='line'>Use of uninitialized value $interpolate in numeric eq (==) at /usr/share/perl5/local/lib.pm line 366.
</span><span class='line'>export PERL_LOCAL_LIB_ROOT="/home/ubuntu/perl5";
</span><span class='line'>export PERL_MB_OPT="--install_base /home/ubuntu/perl5";
</span><span class='line'>export PERL_MM_OPT="INSTALL_BASE=/home/ubuntu/perl5";
</span><span class='line'>export PERL5LIB="/home/ubuntu/perl5/lib/perl5/i686-linux-gnu-thread-multi-64int:/home/ubuntu/perl5/lib/perl5";
</span><span class='line'>export PATH="/home/ubuntu/perl5/bin:$PATH";
</span><span class='line'>
</span><span class='line'>Would you like me to append that to /home/ubuntu/.bashrc now? [yes] 
</span><span class='line'>
</span><span class='line'>commit: wrote '/home/ubuntu/.cpan/CPAN/MyConfig.pm'
</span><span class='line'>
</span><span class='line'>You can re-run configuration any time with 'o conf init' in the CPAN shell
</span><span class='line'>Terminal does not support AddHistory.
</span><span class='line'>
</span><span class='line'>cpan shell -- CPAN exploration and modules installation (v1.960001)
</span><span class='line'>Enter 'h' for help.
</span><span class='line'>
</span><span class='line'>cpan[1]> quit</span></code></pre></td></tr></table></div></figure>


<h2>Moose installieren</h2>

<p>Nun installiere ich das Perl-Modul Moose via CPAN. Läuft ohne Probleme durch!</p>

<figure class='code'><figcaption><span>Moose installieren mit CPAN </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>cpan install Moose
</span><span class='line'>...
</span><span class='line'>Installing /home/ubuntu/perl5/man/man3/Moose::Manual::Classes.3pm
</span><span class='line'>Installing /home/ubuntu/perl5/bin/moose-outdated
</span><span class='line'>Appending installation info to /home/ubuntu/perl5/lib/perl5/i686-linux-gnu-thread-multi-64int/perllocal.pod
</span><span class='line'>  ETHER/Moose-2.0802.tar.gz
</span><span class='line'>  /usr/bin/make install  -- OK
</span></code></pre></td></tr></table></div></figure>



<p><a rel="bookmark" href="http://uli-heller.github.com/2013/06/10/cpan-ohne-root/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[LXC: Schnelles Clonen mit BTRFS-Snapshots]]></title>
<link href="http://uli-heller.github.com/2013/06/09/lxc-snapshots/"/>
<updated>2013-06-09T10:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/06/09/lxc-snapshots</id>

      <content type="html"><![CDATA[<p>Seit einiger Zeit verwende ich LXC als Ergänzung zu VirtualBox.
Meine LXC-Installation läuft unter BTRFS, so dass der Einsatz von
<code>lxc-clone ... -s</code> zum schnellen und resourcensparenden Clonen
von LXC-Containern eigentlich kein Problem sein sollte. Leider bricht
das aber immer ab mit der Meldung &#8220;cannot snapshot a directory&#8221;:</p>

<pre><code>$ sudo lxc-clone -o my-lxc-container -n cloned-lxc-container -s
Tweaking configuration
Copying rootfs...
lxc-clone: cannot snapshot a directory
lxc-clone: aborted
</code></pre>

<!-- more -->


<h2>Analyse</h2>

<p>Zur Analyse baut man am besten in &#8220;lxc-clone&#8221; relativ weit oben eine
Zeile mit &#8220;set -x&#8221; ein. Da sieht man dann dieses:</p>

<pre><code>$ sudo lxc-clone -o my-lxc-container -n cloned-lxc-container -s
+ set -e
+ . /usr/share/lxc/lxc.functions
+ globalconf=/etc/lxc/lxc.conf
...
+ container_running=False
+ sed -i /lxc.rootfs/d /var/lib/lxc/x/config
+ [ -b /var/lib/lxc/my-lxc-container/rootfs ]
+ which btrfs
+ btrfs subvolume list /var/lib/lxc/my-lxc-container/rootfs
+ [ -d /var/lib/lxc/my-lxc-container/delta0 ]
+ [ yes = yes ]
+ basename /usr/bin/lxc-clone
+ echo lxc-clone: cannot snapshot a directory
lxc-clone: cannot snapshot a directory
...
</code></pre>

<p>Man erkennt, dass der Fehler wohl in Zusammenhang mit <code>btrfs subvolume list</code>
steht. Hier eine manuelle Ausführung des Befehls:</p>

<pre><code>$ btrfs subvolume list /var/lib/lxc/my-lxc-container/rootfs
ERROR: '/var/lib/lxc/my-lxc-container/rootfs' is not a subvolume
</code></pre>

<p>Vermutlich muß &#8220;rootfs&#8221; also ein BTRFS-Subvolume sein.</p>

<p>Nicht vergessen: Änderung an &#8220;lxc-clone&#8221; wieder rückgängig machen!</p>

<h2>Korrekturversuch</h2>

<p>Zunächst lege ich ein BTRFS-Subvolume für &#8220;rootfs&#8221; an und
befülle es mit dem alten Inhalt:</p>

<pre><code>$ cd /var/lib/lxc
$ sudo mv lib/my-lxc-container/rootfs lib/my-lxc-container/rootfs.saved
$ sudo btrfs subvolume create lib/my-lxc-container/rootfs
Create subvolume 'lib/my-lxc-container/rootfs'
$ sudo mv lib/my-lxc-container/rootfs.saved/* lib/my-lxc-container/rootfs
$ sudo rmdir lib/my-lxc-container/rootfs.saved
</code></pre>

<p>Nun nochmals den Befehl zum Auflisten des Subvolumes:</p>

<pre><code>$ btrfs subvolume list /var/lib/lxc/my-lxc-container/rootfs
ERROR: can't perform the search
$ sudo btrfs subvolume list /var/lib/lxc/my-lxc-container/rootfs
...
ID 260 top level 5 path lib/my-lxc-container/rootfs
</code></pre>

<p>Sieht schonmal deutlich besser aus. Jetzt nochmals `lxc-clone &#8230; -s&#8217;:</p>

<pre><code>$ sudo lxc-clone -o my-lxc-container -n cloned-lxc-container -s
Tweaking configuration
Copying rootfs...
Create a snapshot of '/var/lib/lxc/my-lxc-container/rootfs' in '/var/lib/lxc/cloned-lxc-container/rootfs'
Updating rootfs...
'cloned-lxc-container' created
</code></pre>

<p>Scheint geklappt zu haben! Die Ausführung ist ultra-schnell!</p>

<h2>Korrektur für alle LXC-Container</h2>

<p>Nun muß die oben genannte Korrektur noch für alle anderen LXC-Container
durchgeführt werden. Hier ein kurzes Skript, welches dies für mich
erledigt:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c">#!/bin/sh</span>
</span><span class='line'><span class="k">for </span>rootfs in /var/lib/lxc/*/rootfs; <span class="k">do</span>
</span><span class='line'><span class="k">  </span>sudo btrfs subvolume list <span class="s2">&quot;${rootfs}&quot;</span> &gt;/dev/null 2&gt;&amp;1 <span class="o">||</span> <span class="o">{</span>
</span><span class='line'>    sudo mv <span class="s2">&quot;${rootfs}&quot;</span> <span class="s2">&quot;${rootfs}.saved&quot;</span> <span class="se">\</span>
</span><span class='line'>    <span class="o">&amp;&amp;</span> sudo btrfs subvolume create <span class="s2">&quot;${rootfs}&quot;</span> <span class="se">\</span>
</span><span class='line'>    <span class="o">&amp;&amp;</span> sudo mv <span class="s2">&quot;${rootfs}.saved&quot;</span>/* <span class="s2">&quot;${rootfs}&quot;</span> <span class="se">\</span>
</span><span class='line'>    <span class="o">&amp;&amp;</span> sudo rmdir <span class="s2">&quot;${rootfs}.saved&quot;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="k">done</span>
</span></code></pre></td></tr></table></div></figure>



<p><a rel="bookmark" href="http://uli-heller.github.com/2013/06/09/lxc-snapshots/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
</feed>
