<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Was ich so treibe...]]></title>
  <link href="http://uli-heller.github.com/atom.xml" rel="self"/>
  <link href="http://uli-heller.github.com/"/>
  <updated>2013-06-01T18:16:51+02:00</updated>
  <id>http://uli-heller.github.com/</id>
  <author>
    <name><![CDATA[Uli Heller]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
    <entry>
      




<title type="html"><![CDATA[Abhängigkeiten für Debian-Paketbau installieren]]></title>
<link href="http://uli-heller.github.com/2013/06/01/build-dependencies/"/>
<updated>2013-06-01T17:30:00+02:00</updated>
<id>http://uli-heller.github.com/2013/06/01/build-dependencies</id>

      <content type="html"><![CDATA[<p>Normalerweise spiele ich alle zum Bau eines Debian-Paketes notwendigen
Programme ein mittels <code>sudo apt-get build-dep {paketname}</code>. Blöderweise
geht das nicht, wenn das zu bauende Paket nicht aus einem
Repository &#8220;geladen&#8221; werden soll, so zum Beispiel wenn ich nur die
Quelltexte und die DSC-Datei des Paketes vorliegen habe.</p>

<p>Nachfolgend beschreibe ich am Beispiel von MUFFIN, wie man die Pakete
dennoch ohne allzuviel Tipparbeit installieren kann.</p>

<!-- more -->


<h2>Quelltexte herunterladen</h2>

<p>Beispielsweise von <a href="https://github.com/linuxmint/muffin/archive/1.8.2.tar.gz">https://github.com/linuxmint/muffin/archive/1.8.2.tar.gz</a></p>

<h2>Quelltexte entpacken</h2>

<ul>
<li><code>gzip -cd muffin-1.8.2.tar.gz|tar xf -</code></li>
<li><code>cd muffin-1.8.2</code></li>
</ul>


<h2>Abhängigkeiten anzeigen</h2>

<ul>
<li><code>dpkg-buildpackage</code></li>
</ul>


<p>&#8230; liefert eine Ausgabe der Art:</p>

<p><code>
...
dpkg-checkbuilddeps: Unmet build dependencies: debhelper (&gt;= 8) dh-autoreconf intltool (&gt;= 0.34.90) libgtk-3-dev (&gt;= 3.0.8-1~) libcanberra-gtk3-dev gobject-introspection (&gt;= 0.9.12-5~) libgirepository1.0-dev (&gt;= 0.9.12) libjson-glib-dev (&gt;= 0.13.2-1~) libclutter-1.0-dev (&gt;= 1.7.5) libpango1.0-dev (&gt;= 1.2.0) libgconf2-dev (&gt;= 2.6.1-2) libglib2.0-dev (&gt;= 2.6.0) libstartup-notification0-dev (&gt;= 0.7) libxcomposite-dev (&gt;= 1:0.2) libxfixes-dev libxrender-dev libxdamage-dev libxcursor-dev libxinerama-dev libxext-dev libxrandr-dev gnome-doc-utils (&gt;= 0.8) gnome-pkg-tools (&gt;= 0.10) gsettings-desktop-schemas-dev (&gt;= 3.3.0)
</code></p>

<h2>Abhängigkeiten installieren</h2>

<pre><code>dpkg-checkbuilddeps 2&gt;&amp;1 \
| sed                    \
  -e "s/^.*: //"         \
  -e "s/([^(]*)//g"      \
|sudo xargs apt-get install -y
</code></pre>

<h2>Paket bauen</h2>

<ul>
<li><code>dpkg-buildpackage</code></li>
</ul>


<p>&#8230; läuft nun durch!</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/06/01/build-dependencies/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Markdown nach PDF wandeln]]></title>
<link href="http://uli-heller.github.com/2013/05/17/markdown-pdf/"/>
<updated>2013-05-17T21:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/05/17/markdown-pdf</id>

      <content type="html"><![CDATA[<p>Hier kurz eine Beschreibung, wie man Markdown nach PDF
konvertieren kann auf Basis von</p>

<ul>
<li>Kramdown</li>
<li>Gimli</li>
<li>Context</li>
<li>Pandoc</li>
</ul>


<!-- more -->


<h2>Kramdown</h2>

<ul>
<li>RVM muß installiert sein</li>
<li>Ruby-2.0 muß verfügbar sein</li>
<li><code>apt-get install texlive-latex-recommended texlive-latex-extra</code></li>
</ul>


<p>Danach kann &#8220;kramdown&#8221; mit <code>gem install kramdown</code> installiert werden.
Die Erzeugung einer PDF-Datei geht dann so:</p>

<pre><code>kramdown --template document -o latex README-markdown.md  &gt;README-markdown.tex
pdftex README-markdown.tex
</code></pre>

<p>Tabellen scheinen von &#8220;kramdown&#8221; richtig in LaTeX-Tabellen umgesetzt
zu werden.</p>

<p>Probleme gibt&#8217;s manchmal noch bei der Einbindung von Bildern.
Diese werden viel zu breit dargestellt. Abhilfe schafft ein eigenes
LaTeX-Template:</p>

<pre><code>cp ~/.rvm/gems/ruby-2.0.0-p0/gems/kramdown-1.0.1/data/kramdown/document.latex .
# Einfügen von
# \setkeys{Gin}{width=\textwidth} % Alle Bilder auf Seitenbreite skalieren
# direkt vor \begin{document}
mv document.latex ulidoc.latex
kramdown --template ulidoc -o latex README-markdown.md  &gt;README-markdown.tex
pdftex README-markdown.tex
</code></pre>

<p>Nun werden die Bilder schön auf Seitenbreite skaliert.</p>

<p>Außerdem kann man mit diesen Änderungen am LaTeX-Template noch ein
Inhaltsverzeichnis erzeugen:</p>

<ul>
<li><p>Unmittelbar vor &#8220;\usepackage[T1]{fontenc}&#8221; folgende Zeile einfügen:</p>

<p>  \usepackage[ngerman]{babel}</p></li>
<li><p>Die Zeile &#8220;\usepackage{hyperref}&#8221; ersetzen durch</p>

<p>  \usepackage[bookmarks=true,bookmarksnumbered=true]{hyperref}</p></li>
<li><p>(Optional) Unmittelbar nach &#8220;\begin{document}&#8221; diese Zeile einfügen:</p>

<p>  \tableofcontents</p>

<p>Damit wird dann auch im &#8220;Haupttext&#8221; ein Inhaltsverzeichnis erzeugt.</p></li>
</ul>


<h2>Gimli</h2>

<ul>
<li>RVM muß installiert sein</li>
<li>Ruby-2.0 muß verfügbar sein</li>
<li><code>apt-get install wkhtmltopdf</code></li>
<li><code>apt-get install libxml2-dev</code></li>
<li><code>apt-get install libxslt-dev</code></li>
</ul>


<p>Danach kann Gimli mit <code>gem install gimli</code> installiert werden.
Die Erzeugung einer PDF-Datei geht dann so:</p>

<pre><code>gimli -f README-markdown.md
</code></pre>

<p>Oder mittels &#8220;bin/md2pdf-gimli.sh&#8221; so:</p>

<pre><code>./bin/md2pdf-gimli.sh README-markdown.md
</code></pre>

<p>Leider kommt Gimli nicht mit Markdown-Tabellen zurecht!</p>

<h2>Pandoc</h2>

<p>Zunächst muß das Programme &#8220;pandoc&#8221; installiert
werden:</p>

<pre><code>sudo apt-get install pandoc
</code></pre>

<p>Nun benötigt man noch das Skript &#8220;bin/md2pdf-pandoc.sh&#8221; und ein
Markdown-Dokument, beispielsweise  &#8220;README-markdown.md&#8221;.</p>

<p>Eine PDF-Datei erzeugt man dann mit</p>

<pre><code>./bin/md2pdf-pandoc.sh README-markdown.md
</code></pre>

<p>Die PDF-Datei hat den Namen &#8220;README-markdown.pdf&#8221;.</p>

<p>Leider kommt Pandoc in der Version 1.9 nicht mit Markdown-Tabellen zurecht,
die Version 1.11 soll dies können!</p>

<h2>Context</h2>

<p>Zunächst müssen die Programme &#8220;context&#8221; und &#8220;pandoc&#8221; installiert
werden:</p>

<pre><code>sudo apt-get install context
sudo apt-get install pandoc
</code></pre>

<p>Nun benötigt man noch das Skript &#8220;bin/md2pdf-context.sh&#8221; und ein
Markdown-Dokument, beispielsweise  &#8220;README-markdown.md&#8221;.</p>

<p>Eine PDF-Datei erzeugt man dann mit</p>

<pre><code>./bin/md2pdf-context.sh README-markdown.md
</code></pre>

<p>Die PDF-Datei hat den Namen &#8220;README-markdown.pdf&#8221;.</p>

<p>Context erzeugt ein hübsches PDF-Inhalts-Verzeichnis.
Leider kommt Context nicht mit Markdown-Tabellen zurecht!</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/05/17/markdown-pdf/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[JBoss Application Server 7 unter Ubuntu nutzen]]></title>
<link href="http://uli-heller.github.com/2013/05/16/jboss-7.1.1/"/>
<updated>2013-05-16T19:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/05/16/jboss-7.1.1</id>

      <content type="html"><![CDATA[<h2>Installation und Kurztest von JBoss AS</h2>

<ul>
<li>Paket von http://www.jboss.org/jbossas/downloads herunterladen,
einspielen und starten:</li>
</ul>


<figure class='code'><figcaption><span>Einspielen und Starten von JBossAS </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># jboss-as-7.1.1.Final.tar.gz heruntergeladen nach ~/Downloads</span>
</span><span class='line'><span class="nb">cd</span> /opt
</span><span class='line'>gzip -cd ~/Downloads/jboss-as-7.1.1.Final.tar.gz |sudo tar xf -
</span><span class='line'><span class="c"># ... es darf keine Fehlermeldung erscheinen!</span>
</span><span class='line'>sudo chown -R uli.uli jboss-as-7.1.1.Final
</span><span class='line'><span class="nb">cd  </span>jboss-as-7.1.1.Final
</span><span class='line'>./bin/standalone.sh
</span><span class='line'><span class="c"># ... muß ohne Fehlermeldung starten</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Test mit <a href="https://localhost:8080">https://localhost:8080</a>: Es muß grob &#8220;Welcome to AS 7&#8221;
angezeigt werden.</li>
</ul>


<h2>Probleme</h2>

<ul>
<li>Keine, auch nicht mit JDK6</li>
</ul>

<p><a rel="bookmark" href="http://uli-heller.github.com/2013/05/16/jboss-7.1.1/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[OpenVPN unter Ubuntu nutzen]]></title>
<link href="http://uli-heller.github.com/2013/05/14/openvpn-ubuntu/"/>
<updated>2013-05-14T06:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/05/14/openvpn-ubuntu</id>

      <content type="html"><![CDATA[<h2>Installation von OpenVPN</h2>

<figure class='code'><figcaption><span>Installation von OpenVPN </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>sudo apt-get install openvpn</span></code></pre></td></tr></table></div></figure>


<h2>Konfigurationsdateien von OpenVPN einspielen</h2>

<figure class='code'><figcaption><span>Konfigurationsdateien von OpenVPN einspielen </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>mkdir ~/openvpn
</span><span class='line'>unzip -d ~/openvpn uheller.zip</span></code></pre></td></tr></table></div></figure>


<p>Es werden Dateien wie diese abgelegt:</p>

<ul>
<li>openvpn/2E76.crt</li>
<li>openvpn/2E76.key</li>
<li>openvpn/ca.crt</li>
<li>openvpn/ta.key</li>
<li>openvpn/uheller.ovpn</li>
</ul>


<h2>OpenVPN starten</h2>

<figure class='code'><figcaption><span>OpenVPN starten </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$ sudo openvpn ~/openvpn/uheller.ovpn
</span><span class='line'>Enter Auth Username: uheller
</span><span class='line'>Enter Auth Password: xxxx</span></code></pre></td></tr></table></div></figure>


<h2>VPN-Rechner nutzen</h2>

<p>Das Hauptproblem ist nun die Namensauflösung.
Meine VPN-Gegenstelle nennt mir keinen NameServer, also
muß ich</p>

<ul>
<li>entweder immer via IP-Adresse &#8220;arbeiten&#8221;</li>
<li>oder die Hosts selbst bei mir in /etc/hosts eintragen</li>
</ul>


<p>Zunächst verfolge ich mal den ersten Ansatz:</p>

<ul>
<li><a href="https://10.157.1.20/owa">https://10.157.1.20/owa</a> &#8230; öffnet den Webmailer,
hier kann ich mich anmelden mit &#8220;uheller&#8221;/&#8221;xxxx&#8221;.</li>
</ul>


<p>SUPER!</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/05/14/openvpn-ubuntu/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Ubuntu-Debian-Pakete mit LXC erzeugen]]></title>
<link href="http://uli-heller.github.com/2013/05/12/lxc-ubuntu-build/"/>
<updated>2013-05-12T10:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/05/12/lxc-ubuntu-build</id>

      <content type="html"><![CDATA[<h2>Installation von LXC</h2>

<figure class='code'><figcaption><span>Installation von LXC </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>sudo apt-get install lxc</span></code></pre></td></tr></table></div></figure>


<h2>Container-Partition /lxc</h2>

<p>Dieser Abschnitt kann optional ausgeführt werden.
Voraussetzung ist, dass es eine Volume Group namens &#8220;datavg&#8221;
gibt und dass diese über mindestens 10 GB freien Speicherplatz
verfügt.</p>

<h3>Partition anlegen</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>sudo lvcreate -n lxclv -L10G datavg
</span><span class='line'>sudo mkfs.btrfs /dev/datavg/lxclv</span></code></pre></td></tr></table></div></figure>


<h3>Partition einbinden</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>sudo -s
</span><span class='line'>mkdir /lxc
</span><span class='line'>echo "/dev/datavg/lxclv /lxc btrfs defaults 0 3" >>/etc/fstab
</span><span class='line'>mount /lxc
</span><span class='line'>rmdir /var/lib/lxc
</span><span class='line'>ln -s /lxc/lib /var/lib/lxc
</span><span class='line'>rm -rf /var/cache/lxc
</span><span class='line'>ln -s /lxc/cache /var/cache/lxc</span></code></pre></td></tr></table></div></figure>




<!--
Verwendung vom lokalen Apt-Cacher-Ng
------------------------------------

Datei /etc/default/lxc editieren:


<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>MIRROR="http://127.0.0.1:3142/archive.ubuntu.com/ubuntu"</span></code></pre></td></tr></table></div></figure>


<p>&#8230; funktioniert nicht, es werden viele Pakete als &#8220;nicht verifizierbar&#8221; ausgewiesen.
&#8211;></p>

<h2>Erstellen von Containern</h2>

<h3>12.04, 32bit</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>sudo lxc-create -t ubuntu -n ubuntu1204-32-build -- -r precise -a i386</span></code></pre></td></tr></table></div></figure>


<p>Das Komando liefert typischerweise Ausgaben dieser Art:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>$ sudo lxc-create -t ubuntu -n ubuntu1204-32 -- -r precise -a i386
</span><span class='line'>[sudo] password for uli: 
</span><span class='line'>
</span><span class='line'>No config file specified, using the default config
</span><span class='line'>debootstrap ist /usr/sbin/debootstrap
</span><span class='line'>Checking cache download in /var/cache/lxc/precise/rootfs-i386 ... 
</span><span class='line'>Copy /var/cache/lxc/precise/rootfs-i386 to /var/lib/lxc/ubuntu1204-32/rootfs ... 
</span><span class='line'>Copying rootfs to /var/lib/lxc/ubuntu1204-32/rootfs ...
</span><span class='line'>
</span><span class='line'>##
</span><span class='line'># The default user is 'ubuntu' with password 'ubuntu'!
</span><span class='line'># Use the 'sudo' command to run tasks as root in the container.
</span><span class='line'>##
</span><span class='line'>
</span><span class='line'>'ubuntu' template installed
</span><span class='line'>'ubuntu1204-32' created</span></code></pre></td></tr></table></div></figure>


<h3>12.04, 64bit</h3>

<p>64-bit Container können nur erstellt werden, wenn das Basissystem auch ein 64-bit-System ist!</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>sudo lxc-create -t ubuntu -n ubuntu1204-64-build -- -r precise -a amd64</span></code></pre></td></tr></table></div></figure>


<h2>Arbeit mit Containern</h2>

<ul>
<li>Anmelden

<ul>
<li>Benutzer: &#8220;ubuntu&#8221;</li>
<li>Kennwort: &#8220;ubuntu&#8221;</li>
</ul>
</li>
<li>Netzwerk

<ul>
<li>IP-Adressen: Aus dem Adressbereich 10.0.3/24</li>
<li>NAT: Funktioniert - @ping google.com@</li>
<li>SSH vom Host in den Container: Funktioniert - @ssh ubuntu@10.0.3.250@</li>
</ul>
</li>
</ul>


<h2>Anpassung der Container</h2>

<h3>Verwenden des Apt-Cacher-Ng vom Host-System</h3>

<p>Erstellen von /etc/apt/apt.conf.d/01proxy:</p>

<figure class='code'><figcaption><span>/etc/apt/apt.conf.d/01proxy </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='d'><span class='line'><span class="n">Acquire</span><span class="p">::</span><span class="n">http</span><span class="p">::</span><span class="n">Proxy</span> <span class="s">&quot;http://10.0.3.1:3142&quot;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Installation von JOE/JMACS</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>sudo apt-get install joe</span></code></pre></td></tr></table></div></figure>


<h3>Paketquellen ergänzen um Source-Repositories</h3>

<figure class='code'><figcaption><span>/etc/apt/sources.list </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gh">diff -u sources.list.orig sources.list</span>
</span><span class='line'><span class="gd">--- sources.list.orig    2012-09-30 09:41:15.000000000 +0200</span>
</span><span class='line'><span class="gi">+++ sources.list 2013-05-12 18:27:29.615640758 +0200</span>
</span><span class='line'><span class="gu">@@ -1,3 +1,6 @@</span>
</span><span class='line'> deb http://archive.ubuntu.com/ubuntu precise main restricted universe multiverse
</span><span class='line'><span class="gi">+deb-src http://archive.ubuntu.com/ubuntu precise main restricted universe multiverse</span>
</span><span class='line'> deb http://archive.ubuntu.com/ubuntu precise-updates main restricted universe multiverse
</span><span class='line'><span class="gi">+deb-src http://archive.ubuntu.com/ubuntu precise-updates main restricted universe multiverse</span>
</span><span class='line'> deb http://security.ubuntu.com/ubuntu precise-security main restricted universe multiverse
</span><span class='line'><span class="gi">+deb-src http://security.ubuntu.com/ubuntu precise-security main restricted universe multiverse</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Aktualisierung auf den neuesten Stand</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>sudo apt-get update
</span><span class='line'>sudo apt-get upgrade
</span><span class='line'>sudo apt-get clean</span></code></pre></td></tr></table></div></figure>


<h2>Build-Tools einspielen</h2>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>sudo apt-get update
</span><span class='line'>sudo apt-get install build-essential fakeroot dpkg-dev devscripts
</span><span class='line'>sudo apt-get install autotools-dev debhelper pkg-config
</span><span class='line'>sudo apt-get install dh-autoreconf
</span><span class='line'>sudo apt-get clean</span></code></pre></td></tr></table></div></figure>


<h2>GPG-Schlüssel übernehmen</h2>

<p>Dieser Abschnitt ist optional. Er wird nur benötigt, um signierte
DEB-Pakete zu erzeugen!</p>

<p>Auf dem bestehenden Build-System wird der GPG-Schlüssel exportiert:</p>

<figure class='code'><figcaption><span>GPG-Schlüssel exportieren </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>gpg --export-secret-keys >gpg.keys</span></code></pre></td></tr></table></div></figure>


<p>Auf dem neuen LXC-Build-System wird der GPG-Schlüssel importiert:</p>

<figure class='code'><figcaption><span>GPG-Schlüssel importieren </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>gpg --import &lt;gpg.keys</span></code></pre></td></tr></table></div></figure>


<h2>Durchführen eines Builds</h2>

<h3>nginx</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>mkdir nginx
</span><span class='line'>cd nginx
</span><span class='line'>apt-get source nginx
</span><span class='line'>sudo apt-get build-dep nginx
</span><span class='line'>cd nginx-1.1.19
</span><span class='line'>dpkg-buildpackage</span></code></pre></td></tr></table></div></figure>


<h3>libseccomp</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'># Kopieren der nachfolgenden Dateien:
</span><span class='line'>#  libseccomp_0.1.0-1dp01~precise2.debian.tar.gz
</span><span class='line'>#  libseccomp_0.1.0-1dp01~precise2.dsc 
</span><span class='line'>#  libseccomp_0.1.0.orig.tar.gz
</span><span class='line'>dpkg-source -x  libseccomp_0.1.0-1dp01~precise2.dsc
</span><span class='line'>cd libseccomp-0.1.0
</span><span class='line'>dpkg-buildpackage</span></code></pre></td></tr></table></div></figure>


<h3>lxc</h3>

<p>&#8230; läuft analog zu &#8220;libseccomp&#8221;</p>

<h2>Sichern und Rückspielen von Containern</h2>

<h3>Sichern</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>cd /lxc
</span><span class='line'>sudo tar -cvjpf /backups/lxc/20121119.tar.bz2 .</span></code></pre></td></tr></table></div></figure>


<h3>Rückspielen</h3>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>cd /lxc
</span><span class='line'>sudo tar -xvjpf /backups/lxc/20121119.tar.bz2</span></code></pre></td></tr></table></div></figure>


<h2>Probleme</h2>

<h3>Offene Punkte</h3>

<h4>Wie sorgt man dafür, dass ein Container nur über ein Host-Only-Netzwerk erreichbar ist?</h4>

<h3>Erledigte Punkte</h3>

<h4>Verwendung des Apt-Cacher-Ng durch einen Container</h4>

<p>&#8230; geht wie üblich durch /etc/apt/apt.conf.d/01proxy innerhalb des Containers</p>

<h4>Wie übernimmt man einen Container auf ein anderes System?</h4>

<p>&#8230; durch Sichern und Rückspielen.</p>

<h2>Links</h2>

<ul>
<li><a href="https://help.ubuntu.com/12.04/serverguide/lxc.html">Ubuntu 12.04 Server Guide</a></li>
</ul>

<p><a rel="bookmark" href="http://uli-heller.github.com/2013/05/12/lxc-ubuntu-build/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[GrubReboot: Reboot eines anderen Eintrages des Grub-Menüs]]></title>
<link href="http://uli-heller.github.com/2013/05/11/grub-reboot/"/>
<updated>2013-05-11T06:31:00+02:00</updated>
<id>http://uli-heller.github.com/2013/05/11/grub-reboot</id>

      <content type="html"><![CDATA[<p>Üblicherweise starte ich meine diversen VMs einfach mit <code>sudo reboot</code>
neu. Dabei wird dann der Standard-Eintrag im Grub-Menü selektiert und
das betreffende Betriebssystem hochgefahren.</p>

<p>Manchmal möchte ich aber einen anderen Eintrag aktivieren und ein
alternatives Betriebssystem oder einen anderen Linux-Kernel starten.
Das Verfahren habe ich mir von <a href="http://michael-prokop.at/blog/2013/05/10/how-to-get-grub-reboot-working/">Michael Prokop&#8217;s Blog</a> &#8216;geklaut&#8217;.</p>

<!-- more -->


<h2>Sichten: Welche Menüeinträge gibt es?</h2>

<figure class='code'><figcaption><span>Liste der Menüeinträge in Grub </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># grep &quot;^menuentry&quot; /boot/grub/grub.cfg</span>
</span><span class='line'>menuentry <span class="s1">&#39;Ubuntu, with Linux 3.2.0-36-virtual&#39;</span> --class ubuntu --class gnu-linux --class gnu --class os <span class="o">{</span>
</span><span class='line'>menuentry <span class="s1">&#39;Ubuntu, with Linux 3.2.0-36-virtual (recovery mode)&#39;</span> --class ubuntu --class gnu-linux --class gnu --class os <span class="o">{</span>
</span><span class='line'>menuentry <span class="s2">&quot;Memory test (memtest86+)&quot;</span> <span class="o">{</span>
</span><span class='line'>menuentry <span class="s2">&quot;Memory test (memtest86+, serial console 115200)&quot;</span> <span class="o">{</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Umstellen des Standard-Boot-Eintrages</h2>

<figure class='code'><figcaption><span>Umstellen der Standard-Boot-Eintrages </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># grep GRUB_DEFAULT /etc/default/grub</span>
</span><span class='line'><span class="nv">GRUB_DEFAULT</span><span class="o">=</span>0
</span><span class='line'><span class="c"># sed -i &#39;s/^GRUB_DEFAULT.*/GRUB_DEFAULT=saved/&#39; /etc/default/grub</span>
</span><span class='line'><span class="c"># grep GRUB_DEFAULT /etc/default/grub</span>
</span><span class='line'><span class="nv">GRUB_DEFAULT</span><span class="o">=</span>saved
</span><span class='line'><span class="c"># update-grub</span>
</span><span class='line'>Generating grub.cfg ...
</span><span class='line'>Found linux image: /boot/vmlinuz-3.2.0-36-virtual
</span><span class='line'>Found initrd image: /boot/initrd.img-3.2.0-36-virtual
</span><span class='line'>Found memtest86+ image: /memtest86+.bin
</span><span class='line'><span class="k">done</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Neustart eines anderen Eintrages</h2>

<p>Ich möchte den Eintrag &#8220;Memory test (memtest86+)&#8221;
starten, das ist der dritte Eintrag im Boot-Menü:</p>

<figure class='code'><figcaption><span>Neustart mit dem dritten Standard-Boot-Eintrag </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># grub-reboot 2</span>
</span><span class='line'><span class="c"># reboot</span>
</span></code></pre></td></tr></table></div></figure>


<p>Nun wird der dritte Eintrag gestartet, der blaue Bildschirm von
&#8220;Memory Test&#8221; erscheint.</p>

<p>Beim nächsten Neustart wird dann wieder der ursprüngliche Boot-Eintrag
geladen.</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/05/11/grub-reboot/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Probleme mit MySQL: start: Job failed to start]]></title>
<link href="http://uli-heller.github.com/2013/05/01/probleme-mit-mysql-start-job-failed-to-start/"/>
<updated>2013-05-01T06:31:00+02:00</updated>
<id>http://uli-heller.github.com/2013/05/01/probleme-mit-mysql-start-job-failed-to-start</id>

      <content type="html"><![CDATA[<p>Auf einem meiner Rechner habe ich gestern diverse Updates eingespielt mit</p>

<ul>
<li><code>apt-get update</code></li>
<li><code>apt-get upgrade</code></li>
<li><code>apt-get dist-upgrade</code></li>
</ul>


<p>Dabei wurde auch MySQL aktualisiert. Leider läßt es sich anschließend nicht
mehr starten. Es erscheint die Fehlermeldung &#8220;start: Job failed to start&#8221;.</p>

<!-- more -->




<figure class='code'><figcaption><span>Fehlermeldung beim Start von MySQL </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>service mysql start
</span><span class='line'>  start: Job failed to start
</span></code></pre></td></tr></table></div></figure>


<p>Eine Sichtung der Log-Dateien unter /var/log liefert leider auch keine
brauchbaren Informationen:</p>

<figure class='code'><figcaption><span>Sichtung der Log-Dateien </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nb">cd</span> /var/log
</span><span class='line'>ls -ltra
</span><span class='line'>  -rw-rw-r--  1 root      utmp  15744 2013-05-01 06:28 wtmp
</span><span class='line'>  -rw-rw-r--  1 root      utmp 292292 2013-05-01 06:28 lastlog
</span><span class='line'>  -rw-r-----  1 syslog    adm   93910 2013-05-01 06:40 auth.log
</span><span class='line'>  -rw-r-----  1 syslog    adm   17682 2013-05-01 06:47 syslog
</span><span class='line'>  -rw-r-----  1 syslog    adm  142088 2013-05-01 06:47 messages
</span><span class='line'>  -rw-r-----  1 syslog    adm   78161 2013-05-01 06:47 kern.log
</span><span class='line'>  -rw-r-----  1 syslog    adm    5394 2013-05-01 06:47 daemon.log
</span><span class='line'><span class="c"># daemon.log: mysql pre-start process (2168) terminated with status 1</span>
</span><span class='line'><span class="c"># kern.log: type=1505 audit(1367383657.073:19):  operation=&quot;profile_replace&quot; pid=2170 name=&quot;/usr/sbin/mysqld&quot;</span>
</span><span class='line'><span class="c"># messages: type=1505 audit(1367383657.073:19):  operation=&quot;profile_replace&quot; pid=2170 name=&quot;/usr/sbin/mysqld&quot;</span>
</span><span class='line'><span class="c"># syslog:</span>
</span><span class='line'><span class="c">#   type=1505 audit(1367383657.073:19):  operation=&quot;profile_replace&quot; pid=2170 name=&quot;/usr/sbin/mysqld&quot;</span>
</span><span class='line'><span class="c">#    mysql pre-start process (2168) terminated with status 1</span>
</span><span class='line'><span class="c"># auth.log: ...</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Logging von Upstart aktivieren</h2>

<p>Im <a href="http://upstart.ubuntu.com/cookbook/#initctl-log-priority">Kochbuch für Upstart</a>
steht, wie man das Logging für Upstart aktiviert:</p>

<ul>
<li><code>initctl log-priority  # Ausgabe: message</code></li>
<li><code>initctl log-priority debug</code></li>
<li><code>service mysql start</code></li>
</ul>


<p>Danach stehen deutlich mehr Informationen in den Log-Dateien. Leider betreffen
diese mehr die Arbeitsweise vom Upstart-Init-Daemon als die der zu startenden
Services.</p>

<p>Also: Logging für Upstart wieder deaktivieren:</p>

<ul>
<li><code>initctl log-priority message</code></li>
</ul>


<h2>Logging für ein Upstart-Skript aktivieren</h2>

<p>Im  <a href="http://upstart.ubuntu.com/cookbook/#obtaining-a-log-of-a-script-section">Kochbuch für Upstart</a>
steht, wie man Logs für die Upstart-Skripte erzeugt. Die Idee ist, dem Ansatz
&#8220;Log Script Section Output to Syslog&#8221; zu folgen:</p>

<figure class='code'><figcaption><span>Auszug aus dem Upstart-Kochbuch - Skriptausgabe loggen </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>script
</span><span class='line'>  <span class="nb">exec</span> &gt;/dev/kmsg 2&gt;&amp;1
</span><span class='line'>  <span class="nb">echo</span> <span class="s2">&quot;this data will be sent to the system log&quot;</span>
</span><span class='line'>end script
</span></code></pre></td></tr></table></div></figure>


<p>Zunächst müssen wir die Konfigurationsdatei für den MySQL-Upstart-Service
finden: /etc/init/mysql.conf. Eine Sichtung liefert:</p>

<ul>
<li>Es gibt ein &#8220;pre-start script&#8221;</li>
<li>In den Fehlermeldungen war die Rede von &#8220;pre-start process&#8221;</li>
<li>Also: Wir schauen uns den &#8220;pre-start&#8221;-Teil näher an</li>
</ul>


<p>Dieser Teil sieht so aus:</p>

<figure class='code'><figcaption><span>/etc/init/mysql.conf - pre-start </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>pre-start script
</span><span class='line'>    <span class="c">#Sanity checks</span>
</span><span class='line'>    <span class="o">[</span> -r <span class="nv">$HOME</span>/my.cnf <span class="o">]</span>
</span><span class='line'>    <span class="o">[</span> -d /var/run/mysqld <span class="o">]</span> <span class="o">||</span> install -m 755 -o mysql -g root -d /var/run/mysqld
</span><span class='line'>    <span class="c"># Load AppArmor profile</span>
</span><span class='line'>    <span class="k">if </span>aa-status --enabled 2&gt;/dev/null; <span class="k">then</span>
</span><span class='line'><span class="k">        </span>apparmor_parser -r /etc/apparmor.d/usr.sbin.mysqld <span class="o">||</span> <span class="nb">true</span>
</span><span class='line'><span class="nb">    </span><span class="k">fi</span>
</span><span class='line'><span class="k">    </span><span class="nv">LC_ALL</span><span class="o">=</span>C <span class="nv">BLOCKSIZE</span><span class="o">=</span> df --portability /var/lib/mysql/. | tail -n 1 | awk <span class="s1">&#39;{ exit ($4&lt;4096) }&#39;</span>
</span><span class='line'>end script
</span></code></pre></td></tr></table></div></figure>


<p>Es fällt auf, dass der freie Speicherplatz auf /var/lib/mysql/. geprüft wird.
Möglicherweise ist also auch einfach diese Partition voll gelaufen!</p>

<h2>Sichtung und Bereinigung der Partition /var</h2>

<figure class='code'><figcaption><span>Sichtung und Bereinigung der Partiton /var </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>df /var
</span><span class='line'>  /dev/mapper/systemvg-varlv  376807    354385      2966 100% /var
</span><span class='line'>apt-get clean
</span><span class='line'>df /var
</span><span class='line'>  /dev/mapper/systemvg-varlv  376807    202839    154512  57% /var
</span></code></pre></td></tr></table></div></figure>


<p>Nun kann man MySQL wieder normal starten!</p>

<figure class='code'><figcaption><span>Normaler Start von MySQL </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>service mysql start
</span><span class='line'>  mysql start/running, process 1589
</span></code></pre></td></tr></table></div></figure>


<h2>Links</h2>

<ul>
<li><a href="http://upstart.ubuntu.com/cookbook">Kochbuch für Upstart</a></li>
</ul>

<p><a rel="bookmark" href="http://uli-heller.github.com/2013/05/01/probleme-mit-mysql-start-job-failed-to-start/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Cinnamon-1.7.4 auf Ubuntu-12.04]]></title>
<link href="http://uli-heller.github.com/2013/04/25/cinnamon-1-dot-7-4-auf-ubuntu-12-dot-04/"/>
<updated>2013-04-25T09:05:00+02:00</updated>
<id>http://uli-heller.github.com/2013/04/25/cinnamon-1-dot-7-4-auf-ubuntu-12-dot-04</id>

      <content type="html"><![CDATA[<p>Heute habe ich versucht, die aktuelle Cinnamon-Version auf Ubuntu-12.04
zu installieren und zum Laufen zu bringen. Das Ergebnis war erstmal
ernüchternd: Nach dem Anmelden erscheint ein komplett leerer Bildschirm,
man sieht nur das Hintergrundbild.</p>

<p>Mit &#8220;Alt-t&#8221; kann man ein Terminal-Fenster öffnen und darin ein paar Tests
vornehmen:</p>

<ul>
<li><code>muffin</code> &#8230; startet problemlos</li>
<li><code>cinnamon</code> &#8230; startet nicht, stattdessen erscheint eine Fehlermeldung bzgl. GJsDbus</li>
</ul>


<p>Eine Google-Suche zeigt dann die Lösung: <code>sudo apt-get install gir1.2-gjsdbus-1.0</code>. Danach erscheint nach dem Anmelden die gewohnte Arbeitsoberfläche.</p>

<p>Jetzt habe ich mein Debian-Paket für Cinnamon so überarbeitet, dass
gir1.2-gjsdbus-1.0 direkt als Abhängigkeit eingetragen ist. Somit wird
es beim Installieren von Cinnamon künftig automatisch mit installiert.</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/04/25/cinnamon-1-dot-7-4-auf-ubuntu-12-dot-04/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Einrichten eines LDAP-Servers unter Ubuntu-12.04]]></title>
<link href="http://uli-heller.github.com/2013/04/23/einrichten-eines-ldap-servers-unter-ubuntu-12-dot-04/"/>
<updated>2013-04-23T15:38:00+02:00</updated>
<id>http://uli-heller.github.com/2013/04/23/einrichten-eines-ldap-servers-unter-ubuntu-12-dot-04</id>

      <content type="html"><![CDATA[<!--
Einrichten eines LDAP-Servers unter Ubuntu-12.04
================================================
-->


<h2>Rechner aktualisieren</h2>

<p>Zunächst sollte der Rechner aktualisiert werden.</p>

<figure class='code'><figcaption><span>Rechner aktualisieren </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo apt-get update
</span><span class='line'>sudo apt-get dist-upgrade
</span></code></pre></td></tr></table></div></figure>


<h2>LDAP-Pakete installieren</h2>

<figure class='code'><figcaption><span>LDAP-Pakete installieren </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo apt-get install slapd ldap-utils cpu whois
</span><span class='line'><span class="c"># LDAP-Administrator-Passwort: uli</span>
</span></code></pre></td></tr></table></div></figure>


<h2>LDAP-Schemas definieren</h2>

<p>Standard-Schemas:</p>

<figure class='code'><figcaption><span>LDAP-Schemas definieren </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/ldap/schema/cosine.ldif
</span><span class='line'>sudo ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/ldap/schema/nis.ldif
</span><span class='line'>sudo ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/ldap/schema/inetorgperson.ldif
</span></code></pre></td></tr></table></div></figure>


<p>Zusatz-Schema:</p>

<figure class='code'><figcaption><span>LDAP-Zusatzschema definieren </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo ldapadd -Y EXTERNAL -H ldapi:/// -f /tmp/backend_dp.ldif
</span></code></pre></td></tr></table></div></figure>


<p>Das Zusatzschema gibt&#8217;s <a href="http://uli-heller.github.com/downloads/code/backend_dp.ldif">hier</a></p>

<h2>LDAP-Daten importieren</h2>

<p>Es müssen entweder die Grunddaten importiert werden oder aber
der Datenbestand eines anderen LDAP-Servers.</p>

<h3>Grunddaten importieren</h3>

<figure class='code'><figcaption><span>Grunddaten importieren </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo service slapd stop
</span><span class='line'>sudo slapadd -c -l /root/base.ldif
</span><span class='line'>sudo service slapd start
</span></code></pre></td></tr></table></div></figure>


<h3>Datenbestand importieren</h3>

<p>Dieser Schritt ist optional. Er dient primär der Übernahme eines Datenbestandes
von einem bestehenden LDAP-Server.</p>

<figure class='code'><figcaption><span>LDAP-Daten importieren </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo service slapd stop
</span><span class='line'>sudo slapadd -c -l 94.out.ldif  <span class="c"># 94.out.ldif ist eine ältere LDAP-Sicherung</span>
</span><span class='line'>sudo service slapd start
</span></code></pre></td></tr></table></div></figure>


<h2>Hilfsskripte installieren</h2>

<p>Wir haben einige Hilfsskripte, die die Arbeit mit dem LDAP-Verzeichnis erleichtern:</p>

<ul>
<li>/usr/local/bin/ldap-create-user.sh
&#8230; legt einen LDAP-Benutzer an (basiert auf &#8220;cpu&#8221;)</li>
<li>/usr/local/bin/ldap-delete-user.sh
&#8230; löscht einen LDAP-Benutzer (basiert auf &#8220;cpu&#8221;)</li>
<li>/usr/local/bin/ldap-modify-slapcat.sh
&#8230; setzt die LDAP-Kennworte aller Benutzer in einem LDAP-Export auf &#8220;keines&#8221;</li>
<li>/etc/cpu/cpu.conf
&#8230; Konfigurationsdatei für &#8220;cpu&#8221;, enthält u.a. das Admin-Kennwort von LDAP</li>
</ul>


<h2>Web-Anwendung für Kennwort-Änderung installieren</h2>

<p>Unsere Web-Anwendung soll mit dem Apache2 betrieben werden,
also spielen wir den Apache2 ein und konfigurieren ihn auch gleich.</p>

<figure class='code'><figcaption><span>Apache2 installieren und konfigurieren </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo apt-get install apache2 <span class="c"># Web-Server Apache-2.2.22 einspielen</span>
</span><span class='line'>sudo cp /etc/apache2/sites-available/default /etc/apache2/sites-available/changepass
</span><span class='line'>sudo jmacs  /etc/apache2/sites-available/changepass
</span><span class='line'><span class="c"># Einige Anpassungen vornehmen...</span>
</span><span class='line'><span class="c"># - CGI: ldap/cgi-bin -&gt; cgi-bin/ldap</span>
</span><span class='line'>sudo a2dissite default
</span><span class='line'>sudo a2ensite changepass
</span><span class='line'>sudo service apache2 restart
</span></code></pre></td></tr></table></div></figure>


<p>Die Web-Anwendung benötigt noch einige Perl-Module.</p>

<figure class='code'><figcaption><span>Perl-Module installieren </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo apt-get install libconfig-tiny-perl
</span><span class='line'>sudo apt-get install libnet-ldap-perl
</span></code></pre></td></tr></table></div></figure>


<p>Zuletzt: Web-Anwendung einspielen. Folgende Dateien werden dabei benötigt:</p>

<ul>
<li>/etc/changepass.conf</li>
<li>/etc/apache2/sites-available/changepass</li>
<li>/usr/lib/cgi-bin/ldap/changepass</li>
<li>/var/www/index.html</li>
<li>/var/www/ldap/changepass.css</li>
</ul>


<h2>LDAP in Firewall freischalten</h2>

<p>Sofern die UFW-Firewall installiert und aktiviert ist, muß der LDAP-Port
freigeschaltet werden.</p>

<figure class='code'><figcaption><span>LDAP in Firewall freischalten </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo ufw allow 389/tcp
</span><span class='line'>sudo ufw allow 80/tcp
</span><span class='line'>sudo ufw status
</span></code></pre></td></tr></table></div></figure>


<h2>Tipps und Tricks</h2>

<h3>LDAP-Daten sichern und zurückspielen</h3>

<h4>Sichern</h4>

<figure class='code'><figcaption><span>LDAP-Daten sichern </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo slapcat -l /tmp/slapcat.ldif
</span></code></pre></td></tr></table></div></figure>


<h4>Zurückspielen</h4>

<figure class='code'><figcaption><span>LDAP-Daten zurückspielen </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo service slapd stop
</span><span class='line'>sudo rm -rf /var/lib/ldap/*
</span><span class='line'>sudo slapadd -c -l /tmp/slapcat.ldif
</span><span class='line'>sudo chown -R openldap.openldap /var/lib/ldap/*
</span><span class='line'>sudo service slapd start
</span></code></pre></td></tr></table></div></figure>


<h4>Neustart mit einem leeren LDAP-Bestand</h4>

<figure class='code'><figcaption><span>Neustart mit leerem LDAP-Bestand </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo service slapd stop
</span><span class='line'>sudo rm -rf /var/lib/ldap/*
</span><span class='line'>sudo service slapd start
</span></code></pre></td></tr></table></div></figure>



<p><a rel="bookmark" href="http://uli-heller.github.com/2013/04/23/einrichten-eines-ldap-servers-unter-ubuntu-12-dot-04/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Herunterladen des HTTPS-Server-Zertifikats]]></title>
<link href="http://uli-heller.github.com/2013/04/21/herunterladen-des-https-server-zertifikats/"/>
<updated>2013-04-21T08:20:00+02:00</updated>
<id>http://uli-heller.github.com/2013/04/21/herunterladen-des-https-server-zertifikats</id>

      <content type="html"><![CDATA[<h1>Herunterladen des HTTPS-Server-Zertifikats über die Kommandozeile</h1>

<p>Den Trick habe ich von einem <a href="http://eclipsesource.com/blogs/2013/04/19/installing-eclipse-plug-ins-from-an-update-site-with-a-self-signed-certificate/">EclipseSource-Blog</a>:</p>

<figure class='code'><figcaption><span>Herunterladen eines Server-Zertifikats </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nb">echo</span> -n <span class="se">\</span>
</span><span class='line'>| openssl s_client -connect HOST:PORTNUMBER <span class="se">\</span>
</span><span class='line'>| sed -ne <span class="s1">&#39;/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p&#39;</span> <span class="se">\</span>
</span><span class='line'>&gt; my-custom-cert.cert
</span></code></pre></td></tr></table></div></figure>


<p>Prima, das erspart mir künftig einiges an Rumklickerei im Browser.</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/04/21/herunterladen-des-https-server-zertifikats/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Dovecot: Aktualisierung mit Pigeonhole]]></title>
<link href="http://uli-heller.github.com/2013/04/19/pigeonhole/"/>
<updated>2013-04-19T06:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/04/19/pigeonhole</id>

      <content type="html"><![CDATA[<h1>Dovecot: Aktualisierung des Debian-Paketes mit Pigeonhole</h1>

<p>Gestern oder heute wurde die Version 2.2.1 von Dovecot veröffentlicht.
Natürlich habe ich gleich versucht, mein Debian-Paket zu aktualisieren:</p>

<ul>
<li><code>cd .../dovecot-2.2.0</code></li>
<li><code>uupdate -u ../dovecot-2.2.1.tar.gz</code></li>
<li><code>cd ../dovecot-2.2.1</code></li>
<li><code>dpkg-buildpackage</code></li>
</ul>


<p>Dummerweise klappt das nicht! Pigeonhole scheint zu fehlen, so dass
schon die Anwendung der Quilt-Patches scheitert.</p>

<!-- more -->


<p>Mein Dovecot-Debian-Paket beinhaltet u.a. auch Pigeonhole.
Pigeonhole wird separat zum Herunterladen angeboten, im Debian-Paket
erscheint es aber als Patch unterhalb von debian/patches. Das ist ein
gewisses Problem, weil man das heruntergeladene Paket dann immer erst
in einen Patch umwandeln muß.</p>

<p>Deshalb mein Ziel: Ich würde das Pigeonhole-Paket gerne möglichst
unverändert in&#8217;s Dovecot-Debian-Paket einbinden!</p>

<!-- more -->


<h2>Ausgangspunkt</h2>

<p>Ausgangspunkt ist das bestehende Dovecot-Debian-Paket in der Version 2.2.0.
Es kann mit <code>dpkg-buildpackage</code> neu erzeugt werden.</p>

<p>Wir wissen, dass es eine neue Version 2.2.1 von Dovecot gibt. Die haben wir
auch schon heruntergeladen. Von Pigeonhole gibt es keine neue Version, also
verwenden wir die alte einfach weiter.</p>

<h2>Pigeonhole vorbereiten</h2>

<ul>
<li><code>cp dovecot_2.2.0.orig-pigeonhole.tar.bz2  dovecot_2.2.1.orig-pigeonhole.tar.bz2</code></li>
</ul>


<h2>Dovecot vorbereiten</h2>

<ul>
<li><code>cd .../dovecot-2.2.0</code></li>
<li><code>dpkg-buildpackage -u ../dovecot-2.2.1.tar.gz</code></li>
<li><code>cd ../dovecot-2.2.1</code></li>
</ul>


<h2>Dovecot/Pigeonhole sichten</h2>

<p>Prüfen: Gibt es innerhalb des Dovecot-Verzeichnisses nun ein Verzeichnis für
Pigeonhole? -> Nein!</p>

<h2>Pigeonhole auspacken und umbenennen</h2>

<ul>
<li><code>bzip2 -cd ../dovecot_2.2.1.orig-pigeonhole.tar.bz2|tar xf -</code></li>
<li><code>mv dovecot-2-2-pigeonhole-70f0b7140939 pigeonhole</code></li>
</ul>


<h2>Dovecot neu erzeugen</h2>

<ul>
<li><code>dpkg-buildpackage</code></li>
</ul>


<p>Nun klappt&#8217;s!</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/04/19/pigeonhole/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Pigeonhole für für mein Debian-Paket von Dovecot]]></title>
<link href="http://uli-heller.github.com/2013/04/15/pigeonhole/"/>
<updated>2013-04-15T06:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/04/15/pigeonhole</id>

      <content type="html"><![CDATA[<h1>Dovecot: Einbinden von Pigeonhole</h1>

<p>Mein Dovecot-Debian-Paket beinhaltet u.a. auch Pigeonhole.
Pigeonhole wird separat zum Herunterladen angeboten, im Debian-Paket
erscheint es aber als Patch unterhalb von debian/patches. Das ist ein
gewisses Problem, weil man das heruntergeladene Paket dann immer erst
in einen Patch umwandeln muß.</p>

<p>Deshalb mein Ziel: Ich würde das Pigeonhole-Paket gerne möglichst
unverändert in&#8217;s Dovecot-Debian-Paket einbinden!</p>

<!-- more -->


<h2>Ausgangspunkt</h2>

<p>Ausgangspunkt ist das bestehende Dovecot-Debian-Paket. Es kann mit
<code>dpkg-buildpackage</code> neu erzeugt werden.</p>

<h2>Pakete herunterladen</h2>

<ul>
<li><a href="http://dovecot.org/releases/2.2/dovecot-2.2.0.tar.gz">Dovecot-2.2.0</a></li>
<li><a href="http://hg.rename-it.nl/dovecot-2.2-pigeonhole/archive/tip.tar.bz2">Pigeonhole für Dovecot-2.2.0</a></li>
</ul>


<h2>Dovecot-Debian-Paket anpassen auf neue Version</h2>

<ul>
<li><code>uupdate -u ../dovecot-2.2.0.tar.gz -v 2:2.2.0</code></li>
<li><code>cd ../dovecot-2.2.0</code></li>
</ul>


<h2>Verweise auf Pigeonhole-Patch entfernen</h2>

<ul>
<li><code>cd ./dovecot-2.2.0</code></li>
<li><code>rm debian/patches/pigeonhole.patch</code></li>
<li><code>sed -i "s/pigeonhole.patch/#pigeonhole.patch/" debian/patches/series</code></li>
</ul>


<h2>Verwendung des Pigeonhole-Paketes vorbereiten</h2>

<ul>
<li><code>cp dovecot-2-2-pigeonhole-70f0b7140939.tar.bz2 dovecot_2.2.0.orig-pigeonhole.tar.bz2</code></li>
<li><code>cd ./dovecot-2.2.0</code></li>
<li><code>mkdir pigeonhole</code></li>
<li><code>tar -C pigeonhole --strip-components=1 -jxf ../dovecot_2.2.0.orig-pigeonhole.tar.bz2</code></li>
</ul>


<h2>Paket neu erzeugen</h2>

<ul>
<li><code>cd ./dovecot-2.2.0</code></li>
<li><code>dpkg-buildpackage</code></li>
</ul>


<h2>Links</h2>

<ul>
<li><a href="http://raphaelhertzog.com/2010/09/07/how-to-use-multiple-upstream-tarballs-in-debian-source-packages/">http://raphaelhertzog.com/2010/09/07/how-to-use-multiple-upstream-tarballs-in-debian-source-packages/</a></li>
</ul>

<p><a rel="bookmark" href="http://uli-heller.github.com/2013/04/15/pigeonhole/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Quilt für mein Debian-Paket von Git]]></title>
<link href="http://uli-heller.github.com/2013/04/14/quilt-fuer-gitdeb/"/>
<updated>2013-04-14T12:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/04/14/quilt-fuer-gitdeb</id>

      <content type="html"><![CDATA[<h1>Quilt: Umstellung der Patchverwaltung meines Git-Debian-Paketes auf Quilt</h1>

<p>Mein Git-Debian-Paket verwendet bislang keine vernünftige Patchverwaltung.
Stattdessen werden bei der Erzeugung des Paketes einfach alle Patches
unterhalb von debian/diff der Reihe nach angewandt. Blöderweise fallen so
gescheiterte Patchanwendungen nicht auf, außerdem werden im Source-Paket
teilweise Original-Dateien modifiziert - vermutlich weil einige Patches
nicht sauber zurückgerollt werden.</p>

<p>Also: Ich will Quilt haben!</p>

<!-- more -->


<h2>Sichtung des Debian-Paketes von Subversion</h2>

<ul>
<li>Patches liegen unter debian/patches und nicht unter debian/diff</li>
<li>Es gibt eine Datei namens debian/patches/series, die alle Patches auflistet</li>
<li>In debian/rules sind einige Änderungen vorzunehmen</li>
</ul>


<p>Die ersten beiden Punkte sind schnell erledigt:</p>

<ul>
<li><code>mv debian/diff debian/patches</code></li>
<li><code>cd debian/patches; (ls|grep -v series) &gt;series</code></li>
</ul>


<p>Bleibt noch die Anpassung von debian/rules!</p>

<h2>Anpassungen an &#8220;debian/rules&#8221;</h2>

<p>An der Datei &#8220;debian/rules&#8221; müssen qualitativ diese Änderungen vorgenommen
werden:</p>

<ul>
<li>Einbinden der Datei /usr/share/quilt/quilt.make</li>
<li>Ziele &#8220;patch&#8221; und &#8220;patch-stamp&#8221; entfernen</li>
<li>Ziele &#8220;debian/stamp-autogen&#8221; und &#8220;debian/stamp-configure&#8221; neu aufnehmen
Bei &#8220;debian/stamp-configure&#8221; wird ein Verweis auf &#8220;patches&#8221; angelegt</li>
<li>Verweise auf &#8220;patch-stamp&#8221; ersetzen durch &#8220;$(QUILT_STAMPFN)&#8221;</li>
<li>Im Ziel &#8220;clean&#8221; diese Änderungen vornehmen:

<ul>
<li>Neue Abhängigkeit zu &#8220;unpatch&#8221; festlegen</li>
<li>Neuer Aufruf: dh_testdir</li>
<li>Neuer Aufruf: dh_clean</li>
<li>Verweis auf &#8220;patches&#8221; löschen</li>
<li>Manuelle Logik zum Zurücknehmen der Patches entfernen</li>
</ul>
</li>
</ul>


<p>Die Änderungen sind im nachfolgenden DIFF zusammengefasst.</p>

<figure class='code'><figcaption><span>Anpassungen an debian/rules </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gd">--- ../git-1.8.2.1_ok/debian/rules  2013-04-13 19:55:00.061153212 +0200</span>
</span><span class='line'><span class="gi">+++ debian/rules 2013-04-14 09:36:24.782564149 +0200</span>
</span><span class='line'><span class="gu">@@ -37,19 +37,30 @@</span>
</span><span class='line'> TMP =$(shell pwd)/tmp
</span><span class='line'> GIT =$(shell pwd)/debian/git
</span><span class='line'>
</span><span class='line'><span class="gd">-patch: deb-checkdir patch-stamp</span>
</span><span class='line'><span class="gd">-patch-stamp:</span>
</span><span class='line'><span class="gd">-    cp gitk-git/gitk gitk-git/gitk.uli.orig</span>
</span><span class='line'><span class="gd">-    for i in `ls -1 debian/diff/*.diff debian/diff/*.patch \</span>
</span><span class='line'><span class="gd">-        2&gt;/dev/null || :`; do \</span>
</span><span class='line'><span class="gd">-      patch -p1 -N -r- &lt;$$i || test $$? = 1 || exit 1; \</span>
</span><span class='line'><span class="gd">-    done</span>
</span><span class='line'><span class="gd">-    touch patch-stamp</span>
</span><span class='line'><span class="gi">+include /usr/share/quilt/quilt.make</span>
</span><span class='line'><span class="gi">+</span>
</span><span class='line'><span class="gi">+debian/stamp-autogen:   $(QUILT_STAMPFN)</span>
</span><span class='line'><span class="gi">+    $(DONT_BE_ROOT)</span>
</span><span class='line'><span class="gi">+    ./autogen.sh</span>
</span><span class='line'><span class="gi">+    touch $@</span>
</span><span class='line'><span class="gi">+</span>
</span><span class='line'><span class="gi">+debian/stamp-configure: $(QUILT_STAMPFN) debian/stamp-autogen</span>
</span><span class='line'><span class="gi">+    dh_testdir</span>
</span><span class='line'><span class="gi">+    test -e patches || ln -s debian/patches patches</span>
</span><span class='line'><span class="gi">+</span>
</span><span class='line'><span class="gi">+#patch: deb-checkdir patch-stamp</span>
</span><span class='line'><span class="gi">+#patch-stamp:</span>
</span><span class='line'><span class="gi">+#   cp gitk-git/gitk gitk-git/gitk.uli.orig</span>
</span><span class='line'><span class="gi">+#   for i in `ls -1 debian/diff/*.diff debian/diff/*.patch \</span>
</span><span class='line'><span class="gi">+#       2&gt;/dev/null || :`; do \</span>
</span><span class='line'><span class="gi">+#     patch -p1 -N -r- &lt;$$i || test $$? = 1 || exit 1; \</span>
</span><span class='line'><span class="gi">+#   done</span>
</span><span class='line'><span class="gi">+#   touch patch-stamp</span>
</span><span class='line'>
</span><span class='line'> build: build-arch build-indep
</span><span class='line'>
</span><span class='line'> build-arch: deb-checkdir build-arch-stamp
</span><span class='line'><span class="gd">-build-arch-stamp: patch-stamp</span>
</span><span class='line'><span class="gi">+build-arch-stamp: $(QUILT_STAMPFN)</span>
</span><span class='line'>  -$(CC) -v
</span><span class='line'>  DESTDIR=&#39;$(GIT)&#39; $(MAKE) all $(OPTS)
</span><span class='line'>  cd contrib/subtree; DESTDIR=&#39;$(GIT)&#39; $(MAKE) all $(OPTS)
</span><span class='line'><span class="gu">@@ -66,7 +77,7 @@</span>
</span><span class='line'>  touch build-arch-stamp
</span><span class='line'>
</span><span class='line'> build-indep: deb-checkdir build-indep-stamp
</span><span class='line'><span class="gd">-build-indep-stamp: patch-stamp build-arch-stamp</span>
</span><span class='line'><span class="gi">+build-indep-stamp: $(QUILT_STAMPFN) build-arch-stamp</span>
</span><span class='line'>  : &#39;Work around bug #478524&#39;
</span><span class='line'>  set -e; if test &#39;$(BUILD_DOCS)&#39; = 1; \
</span><span class='line'>  then \
</span><span class='line'><span class="gu">@@ -74,14 +85,17 @@</span>
</span><span class='line'>  fi
</span><span class='line'>  touch build-indep-stamp
</span><span class='line'>
</span><span class='line'><span class="gd">-clean: deb-checkdir</span>
</span><span class='line'><span class="gi">+clean: deb-checkdir unpatch</span>
</span><span class='line'><span class="gi">+    dh_testdir</span>
</span><span class='line'><span class="gi">+    dh_clean</span>
</span><span class='line'><span class="gi">+    $(RM) patches   </span>
</span><span class='line'>  $(MAKE) clean $(OPTS)
</span><span class='line'>  cd contrib/subtree; $(MAKE) clean $(OPTS)
</span><span class='line'><span class="gd">-    ! test -e patch-stamp || \</span>
</span><span class='line'><span class="gd">-      for i in `ls -1r debian/diff/*.diff debian/diff/*.patch \</span>
</span><span class='line'><span class="gd">-          2&gt;/dev/null || :`; do \</span>
</span><span class='line'><span class="gd">-        patch -p1 -NR -r- &lt;$$i || test $$? = 1 || exit 1; \</span>
</span><span class='line'><span class="gd">-      done</span>
</span><span class='line'><span class="gi">+#   ! test -e patch-stamp || \</span>
</span><span class='line'><span class="gi">+#     for i in `ls -1r debian/diff/*.diff debian/diff/*.patch \</span>
</span><span class='line'><span class="gi">+#         2&gt;/dev/null || :`; do \</span>
</span><span class='line'><span class="gi">+#       patch -p1 -NR -r- &lt;$$i || test $$? = 1 || exit 1; \</span>
</span><span class='line'><span class="gi">+#     done</span>
</span><span class='line'>  rm -rf &#39;$(TMP)&#39;
</span><span class='line'>  rm -f patch-stamp build-arch-stamp build-indep-stamp
</span><span class='line'>  rm -rf &#39;$(GIT)&#39; &#39;$(GIT)&#39;-doc &#39;$(GIT)&#39;-arch &#39;$(GIT)&#39;-cvs
</span></code></pre></td></tr></table></div></figure>


<h2>Neuerzeugung des Paketes</h2>

<p>Nun kann versucht werden, das Paket neu zu erzeugen mit <code>dpkg-buildpackage</code>.
Erwartungsgemäß scheitert die Erzeugung, weil einige Patches nicht sauber
durchlaufen. Korrigiert habe ich das so:</p>

<ul>
<li>In &#8220;debian/patches/series&#8221; folgende Patches deaktiviert:

<ul>
<li>0005-gitk-use-symbolic-font-names-sans-and-monospace-when-.diff</li>
<li>0006-gitk-Skip-over-AUTHOR-COMMIT_DATE-when-searching-all-.diff</li>
</ul>
</li>
<li>Bei allen übrigen Patches:

<ul>
<li><code>quilt push -f</code></li>
<li><code>quilt refresh</code></li>
<li><code>dpkg-buildpackage</code></li>
<li>&#8230; so oft wiederholen, bis es durchläuft</li>
</ul>
</li>
</ul>

<p><a rel="bookmark" href="http://uli-heller.github.com/2013/04/14/quilt-fuer-gitdeb/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Git Subtree (1/2)]]></title>
<link href="http://uli-heller.github.com/2013/04/12/git-subtree/"/>
<updated>2013-04-12T07:14:00+02:00</updated>
<id>http://uli-heller.github.com/2013/04/12/git-subtree</id>

      <content type="html"><![CDATA[<h1>Git Subtree - Neues DEB-Paket bereitstellen</h1>

<h2>Einleitung</h2>

<p>Kurze Erklärung: Warum will ich&#8217;s verwenden? Warum kann ich&#8217;s nicht
direkt verwenden?</p>

<p>Leider ist <code>git subtree</code> in den von mir verwendeten Pakete standardmässig
nicht aktiv:</p>

<figure class='code'><figcaption><span>git-subtree fehlt </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>git subtree
</span><span class='line'>git: <span class="s1">&#39;subtree&#39;</span> is not a git command. See <span class="s1">&#39;git --help&#39;</span>.
</span></code></pre></td></tr></table></div></figure>


<p>Entweder wir aktivieren es manuell oder wir bauen neue Pakete, bei denen <code>git subtree</code> aktiviert ist.</p>

<h2>Manuelles Aktivieren von Git Subtree</h2>

<figure class='code'><figcaption><span>git-subtree manuell installieren </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>git subtree
</span><span class='line'>git: <span class="s1">&#39;subtree&#39;</span> is not a git command. See <span class="s1">&#39;git --help&#39;</span>.
</span><span class='line'><span class="nv">$ </span>sudo cp /usr/share/doc/git/contrib/subtree/git-subtree.sh /usr/lib/git-core/git-subtree
</span><span class='line'><span class="nv">$ </span>sudo chmod +x  /usr/lib/git-core/git-subtree
</span><span class='line'><span class="nv">$ </span>git subtree
</span><span class='line'>usage: git subtree add   --prefix<span class="o">=</span>&lt;prefix&gt; &lt;commit&gt;
</span><span class='line'>   or: git subtree add   --prefix<span class="o">=</span>&lt;prefix&gt; &lt;repository&gt; &lt;commit&gt;
</span><span class='line'>   or: git subtree merge --prefix<span class="o">=</span>&lt;prefix&gt; &lt;commit&gt;
</span><span class='line'>...
</span></code></pre></td></tr></table></div></figure>


<p>Nachteil beim manuellen Aktivieren: Es gibt keine Online-Dokumentation,
d.h. <code>git help subtree</code> läuft in&#8217;s Leere.</p>

<h2>Erzeugung neuer DEB-Pakete</h2>

<ul>
<li>Ausgangspunkt: Build-Verzeichnis für Git-1.8.2.1 liegt vor, d.h. ich
kann mit <code>dpkg-buildpackage</code> neue DEB-Pakete erzeugen</li>
<li>Sichtung: Wie funktioniert die Einbindung von &#8220;subtree&#8221;?

<ul>
<li>Die Implementierung liegt unter contrib/subtree</li>
<li>Eine Einspielanleitung gibt&#8217;s dort auch</li>
<li>Diese müssen wir &#8220;eigentlich&#8221; nur noch in debian/rules einbauen
und fertig!</li>
</ul>
</li>
<li>Also: Änderungen an debian/changelog und debian/rules durchführen und
los geht&#8217;s mit <code>dpkg-buildpackage</code> (&#8230; das dauert)</li>
<li>Sichtung: Ist git-subtree in den erstellten Paketen enthalten?

<ul>
<li><code>dpkg-deb -c git_1.8.2.1*deb|grep git-core/git-subtree</code></li>
</ul>
</li>
</ul>


<h3>Probleme</h3>

<h4>Falscher Installationspfad</h4>

<ul>
<li>Verwendet wird: /build/git/git-1.8.2.1/debian/git/usr/libexec/git-core</li>
<li>Richtig wäre:  /build/git/git-1.8.2.1/debian/git/usr/lib/git-core</li>
<li>Korrektur durch: Setzen von libexecdir in debian/rules</li>
</ul>

<p><a rel="bookmark" href="http://uli-heller.github.com/2013/04/12/git-subtree/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[GPG: Signaturen]]></title>
<link href="http://uli-heller.github.com/2013/04/03/gpg-signaturen/"/>
<updated>2013-04-03T15:00:00+02:00</updated>
<id>http://uli-heller.github.com/2013/04/03/gpg-signaturen</id>

      <content type="html"><![CDATA[<h1>GPG/PGP-Signatur von Quelltext-Dateien prüfen</h1>

<p>Quelltextdateien werden oftmals mit GPG/PGP-Signaturen bereitgestellt, über die die Integrität der Dateien geprüft werrden kann. Hier zeige ich exemplarisch, wie dies für Subversion und Nginx gemacht wird.</p>

<!-- more -->


<h2>Subversion</h2>

<ol>
<li><p>Quelltext herunterladen: <code>wget http://mirror.serversupportforum.de/apache/subversion/subversion-1.7.9.tar.gz</code></p></li>
<li><p>Signatur herunterladen: <code>wget http://www.apache.org/dist/subversion/subversion-1.7.9.tar.gz.asc</code></p></li>
<li><p>Schlüssel importieren: <code>wget -O - https://people.apache.org/keys/group/subversion.asc|gpg --import</code></p></li>
<li><p>Signatur prüfen: <code>gpg subversion-1.7.9.tar.gz.asc</code></p></li>
</ol>


<h2>Nginx</h2>

<ol>
<li><p>Quelltexte herunterladen: <code>wget -O - http://nginx.org/download/nginx-1.2.8.tar.gz|gzip -cd &gt;nginx-1.2.8.tar.gz</code></p>

<p>Hinweis: Dieses umständliche Vorgehen ist notwendig, weil die Version 1.2.8 aus unerfindlichen Gründen &#8220;doppelt komprimiert&#8221; ist!</p></li>
<li><p>Signatur herunterladen: <code>wget http://nginx.org/download/nginx-1.2.8.tar.gz.asc</code></p></li>
<li><p>Signatur prüfen: <code>gpg  nginx-1.2.8.tar.gz.asc</code></p>

<p>Klappt nicht: Es wird gemeckert weil der zugehörige RSA-Schlüssel fehlt</p></li>
<li><p>Schlüssel importieren - auf eine der folgenden Arten:</p>

<ul>
<li><p>Vom Keyserver: <code>gpg --keyserver pgpkeys.mit.edu --recv-key A1C052F8</code></p></li>
<li><p>Mittels manuellem Download: <code>wget -O - http://nginx.org/keys/mdounin.key|gzip -cd|gpg --import</code></p></li>
</ul>


<p>Ich hab&#8217;s auf beide Arten gemacht und dabei überprüft, dass der Schlüssel identisch ist!</p></li>
<li><p>Erneuter Test: <code>gpg  nginx-1.2.8.tar.gz.asc</code></p>

<p>Klappt halbwegs!</p></li>
</ol>

<p><a rel="bookmark" href="http://uli-heller.github.com/2013/04/03/gpg-signaturen/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[JMX auf Localhost]]></title>
<link href="http://uli-heller.github.com/2013/03/22/localhost-jmx/"/>
<updated>2013-03-22T08:00:00+01:00</updated>
<id>http://uli-heller.github.com/2013/03/22/localhost-jmx</id>

      <content type="html"><![CDATA[<h1>JMX so aktivieren, dass der Zugriff nur via Localhost möglich ist</h1>

<p>Im Java-Umfeld gibt es die JMX-Schnittstelle, die u.a. für&#8217;s Monitoringittels JCONSOLE verwendet werden kann. Für meine eigenen Java-Prozesse ist das schnell erledigt: Einfach den Java-Prozess starten, dann <code>jconsole</code> (ohne Zusatzargument). Es wird eine Liste mit allen meinem Java-Prozessen angezeigt und ich kann einfach den gewünschten auswählen. Danach bekomme ich eine Anzeige ähnlich dieser:</p>

<p><img class="" src="http://uli-heller.github.com/images/java/jconsole.png"></p>

<p>Dummerweise werden Webanwendungen manchmal mit anderen Benutzern gestartet, die noch dazu recht abgeschottet sind. Da scheitert der vorige Wert für mich - die betreffenden Tomcats erscheinen dann einfach nicht in der Liste. Das ist der Punkt, an dem man gerne die Remote-Schnittstelle über das setzen diverser Java-Properties freischaltet. Dumm dabei: Nun kann netzwerkweit auf die JMX-Schnittstelle zugegriffen werden - sofern man sie nicht zusätzlich abblockt, was auch wieder Aufwand bedeutet.</p>

<p>Ziel: Wir wollen die JMX-Schnittstelle so in Betrieb nehmen, dass nur von &#8220;localhost&#8221; aus auf sie zugegriffen werden kann!</p>

<!-- more -->


<h2>JMX für Netzwerkzugriffe öffnen</h2>

<p>Hier das klassische Vorgehen mittels Java-Properties:</p>

<figure class='code'><figcaption><span>tomcat/bin/setenv.sh </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;-Djava.rmi.server.hostname=localhost&quot;</span>
</span><span class='line'><span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;-Dcom.sun.management.jmxremote ${CATALINA_OPTS}&quot;</span>
</span><span class='line'><span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;-Dcom.sun.management.jmxremote.port=11223 ${CATALINA_OPTS}&quot;</span>
</span><span class='line'><span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;-Dcom.sun.management.jmxremote.authenticate=false ${CATALINA_OPTS}&quot;</span>
</span><span class='line'><span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;-Dcom.sun.management.jmxremote.ssl=false ${CATALINA_OPTS}&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Nachteile:</p>

<ul>
<li><p>Das ist ein Scheunentor - netzwerkweit &#8220;jeder&#8221; kann nun mittels JMX auf unsere Anwendung zugreifen</p></li>
<li><p>Absichern könnte man&#8217;s mit Firewall-Regeln, was aber zusätzliche Arbeitslast für die Firewall-Truppe bedeutet</p></li>
<li><p>Oder man aktiviert die Authentifizierung und hängt so eine Art Benutzerverwaltung mit dran - auch doof</p></li>
</ul>


<p>Eine Idee ist nun, den JMX-Port nicht netzwerkweit sondern nur über &#8220;localhost&#8221; erreichbar zu machen. Praktisch bedeutet dies, dass dann nur Leute, die sich auf dem betreffenden Rechner anmelden können, Zugriff auf die JMX-Schnittstelle haben. Die oben aufgeführten Java-Properties bieten leider keine entsprechende Einschränkmöglichkeit, also muß eine andere Lösung her!</p>

<h2>JMX über eine eigene RMISocketFactory freigeben</h2>

<p>Die Idee für nachfolgendes Vorgehen stammt von <a href="http://stackoverflow.com/questions/347056/restricting-jmx-to-localhost">StackOverflow</a>. Grob geht&#8217;s so:</p>

<ul>
<li>Eigene RMISocketFactory erstellen und registrieren</li>
<li>MBeanServer über die Standard-ManagementFactory &#8220;holen&#8221;</li>
<li>MBeanServer mit der eigenen RMISocketFactory &#8220;verknüpfen&#8221; und einen JMXConnectorServer dafür erzeugen und starten</li>
</ul>


<p>Zusätzlich zu den in der Quelle auf <a href="http://stackoverflow.com/questions/347056/restricting-jmx-to-localhost">StackOverflow</a> umgesetzten Schritte mußte ich noch das Java-Property &#8220;java.rmi.server.hostname&#8221; auf &#8220;127.0.0.1&#8221; setzen. Ohne diesen Zusatzschritt funktioniert später JCONSOLE nicht.</p>

<p>Wenn man das richtig getan hat, dann kann man danach mittels <code>jconsole localhost:11223</code> die JCONSOLE starten. &#8220;11223&#8221; ist dabei die Portnummer, die man bei vorigem Ablauf mit verarbeitet.</p>

<p>Ich habe das ganze noch in ein Servlet verpackt. Nun kann ich durch</p>

<ul>
<li><code>curl http://localhost-jmx/jmx/start</code> &#8230; die JMX-Schnittstelle &#8220;öffnen&#8221;</li>
<li><code>curl http://localhost-jmx/jmx/stop</code> &#8230; die JMX-Schnittstelle &#8220;schließen&#8221;</li>
</ul>


<p>Zur Not geht das auch über einen Browser.</p>

<p>Seitens des Operatings sind keinerlei Eingriffe erforderlich. Auch das lästige Setzen des Java-Properties erübrigt sich.</p>

<p>Den Quelltext zu dem ganzen gibt&#8217;s auf <a href="https://github.com/uli-heller/uli-java-prototypes/tree/master/localhost-jmx">GitHub</a></p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/03/22/localhost-jmx/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Neue Einträge für debian/changelog]]></title>
<link href="http://uli-heller.github.com/2013/03/21/debian-changelog/"/>
<updated>2013-03-21T07:00:00+01:00</updated>
<id>http://uli-heller.github.com/2013/03/21/debian-changelog</id>

      <content type="html"><![CDATA[<h1>Erstellen von Debian-Paketen: Neue Einträge für debian/changelog</h1>

<p>Wenn man selbst gelegentlich Debian-Pakete erstellt, so kommt man öfter in die Lage die Datei debian/changelog editieren zu müssen.</p>

<!-- more -->


<p>Die Datei selbst ist eine einfache Text-Datei und hat beispielsweise so einen Inhalt:</p>

<figure class='code'><figcaption><span>Beispiel: debian/changelog </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>gexiv2 (0.3.1-0maverick1) maverick; urgency=low
</span><span class='line'>
</span><span class='line'>  * All debug and log messages from Exiv2 are now routed through GLib's logging functions.
</span><span class='line'>
</span><span class='line'> -- Jim Nelson &lt;jim@yorba.org>  Tue, 22 Mar 2011 14:46:17 -0700
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>gexiv2 (0.3.0-0maverick1) maverick; urgency=low
</span><span class='line'>
</span><span class='line'>  * Updated to work with Exiv2 0.21, which has an ABI change from 0.20.
</span><span class='line'>
</span><span class='line'> -- Jim Nelson &lt;jim@yorba.org>  Mon, 10 Jan 2011 12:18:07 -0800</span></code></pre></td></tr></table></div></figure>


<p>Wenn man nun einen neuen Eintrag anlegen möchte, so muß man diese Dinge erzeugen:</p>

<ul>
<li>die Überschrift; hierbei darauf achten, dass die Versionsnummer hochgezählt wird!</li>
<li>einen neuen &#8220;Bullet-Item&#8221; erzeugen</li>
<li>die Unterschrift mit eigener Mail-Adresse und richtigem Zeitstempel</li>
</ul>


<p>Besonders die Sache mit dem Zeitstempel empfinde ich als lästig.</p>

<p>Viel einfacher geht&#8217;s mit <code>debchange --increment</code>: Es öffnet sich direkt ein Editor mit einer Vorlage für den neuen Eintrag!</p>

<figure class='code'><figcaption><span>debchange &#8211;increment </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='plain'><span class='line'>gexiv2 (0.3.1-0ubuntu1) precise; urgency=low
</span><span class='line'>
</span><span class='line'>  *
</span><span class='line'>
</span><span class='line'> -- Uli Heller &lt;uli.heller@daemons-point.com>  Thu, 21 Mar 2013 07:36:33 +0100
</span><span class='line'>
</span><span class='line'>gexiv2 (0.3.1-0maverick1) maverick; urgency=low
</span><span class='line'>
</span><span class='line'>  * All debug and log messages from Exiv2 are now routed through GLib's logging functions.
</span><span class='line'>
</span><span class='line'> -- Jim Nelson &lt;jim@yorba.org>  Tue, 22 Mar 2011 14:46:17 -0700
</span><span class='line'>
</span><span class='line'>...</span></code></pre></td></tr></table></div></figure>



<p><a rel="bookmark" href="http://uli-heller.github.com/2013/03/21/debian-changelog/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Dovecot-2.2 - DEB-Paket erzeugen]]></title>
<link href="http://uli-heller.github.com/2013/03/11/dovecot/"/>
<updated>2013-03-11T09:00:00+01:00</updated>
<id>http://uli-heller.github.com/2013/03/11/dovecot</id>

      <content type="html"><![CDATA[<h1>Ubuntu-Pakete aktualisieren - Dovecot</h1>

<p>Heute soll eine neue Version von Dovecot erzeugt werden.
Grob geht&#8217;s so:</p>

<ul>
<li>Quellen der Standardversion von Ubuntu runterladen und kompilieren</li>
<li>Aktualisieren auf die gewünschte neue Version (2.2.rc2)</li>
<li>Neue Version kompilieren</li>
</ul>


<p>Mal sehen, ob&#8217;s klappt wie vorgesehen!</p>

<!-- more -->


<h2>Standardversion von Ubuntu</h2>

<figure class='code'><figcaption><span>Standardversion herunterladen und bauen </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># Build-Verzeichnis anlegen und reinwechseln</span>
</span><span class='line'>mkdir -p /build/dovecot
</span><span class='line'><span class="nb">cd</span> /build/dovecot
</span><span class='line'><span class="c"># Quellen zum Ubuntu-Paket runterladen - 2.0.19-0ubuntu2</span>
</span><span class='line'>apt-get <span class="nb">source </span>dovecot
</span><span class='line'><span class="c"># Abhängigkeiten nachinstallieren</span>
</span><span class='line'>sudo apt-get build-dep dovecot
</span><span class='line'><span class="c"># Ubuntu-Paket erzeugen</span>
</span><span class='line'><span class="nb">cd </span>dovecot-2.0.19
</span><span class='line'>dpkg-buildpackage
</span><span class='line'><span class="c"># ... läuft hoffentlich ohne Probleme durch</span>
</span><span class='line'>quilt pop -a
</span></code></pre></td></tr></table></div></figure>


<h2>Aktualisierung auf 2.2.rc2</h2>

<figure class='code'><figcaption><span>Aktualisierung auf 2.2.rc2 </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># In Build-Verzeichnis reinwechseln</span>
</span><span class='line'><span class="nb">cd</span> /build/dovecot
</span><span class='line'><span class="c"># Quellen zu Dovecot-2.2.rc1 runterladen</span>
</span><span class='line'>wget http://syksy.dovecot.org/releases/2.2/rc/dovecot-2.2.rc2.tar.gz
</span><span class='line'><span class="c"># Erster Versuch...</span>
</span><span class='line'><span class="nb">cd </span>dovecot-2.0.19
</span><span class='line'>uupdate -u ../dovecot-2.2.rc2.tar.gz
</span><span class='line'><span class="c"># ... zeigt leider eine Fehlermeldung an:</span>
</span><span class='line'><span class="c">#   uupdate: new version number not recognized from given filename</span>
</span><span class='line'><span class="c">#   Please run uupdate with the -v option</span>
</span><span class='line'><span class="c"># Also nochmal...</span>
</span><span class='line'>uupdate -u ../dovecot-2.2.rc2.tar.gz -v 2.2.rc2
</span><span class='line'><span class="c"># OK, keine Fehlermeldung.</span>
</span><span class='line'><span class="c"># Wechseln in&#39;s neue Verzeichnis und dann debian/changelog anpassen</span>
</span><span class='line'><span class="nb">cd</span> ../dovecot-2.2.rc2
</span><span class='line'>jmacs debian/changelog <span class="c"># Details: Siehe nachfolgender DIFF</span>
</span><span class='line'><span class="c"># Ubuntu-Paket erzeugen</span>
</span><span class='line'>dpkg-buildpackage
</span><span class='line'><span class="c"># Mecker wg. fix-racey-restarts.patch</span>
</span><span class='line'><span class="c"># - Kein einziger Patch klappt</span>
</span><span class='line'><span class="c"># - Oft erscheint &#39;Reversed (or previously applied) patch detected!  Skipping patch.&#39;</span>
</span><span class='line'><span class="c"># -&gt; Wir blenden den Patch aus</span>
</span><span class='line'>quilt pop -a
</span><span class='line'>jmacs debian/patches/series <span class="c"># Details: Siehe nachfolgender DIFF</span>
</span><span class='line'><span class="c"># ... noch ein paar Iterationen wie zuvor</span>
</span><span class='line'>dpkg-buildpackage
</span><span class='line'><span class="c"># Scheitert nun ganz am Ende - pigeonhole passt nicht so richtig</span>
</span><span class='line'><span class="c"># ... wir versuchen&#39;s mit dovecot-2.1-pigeonhole-0.3.3.tar.gz</span>
</span><span class='line'><span class="c"># ... klappt auch nicht - gleicher Fehler!</span>
</span><span class='line'><span class="c"># ... dann halt mit dovecot-2.2-pigeonhole-tip</span>
</span><span class='line'><span class="c"># ... klappt besser, jetzt &quot;zickt&quot; noch DRAC</span>
</span><span class='line'><span class="c"># ... läßt sich auch leicht korrigieren</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Änderungen an debian/changelog </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gh">diff -u debian/changelog~ debian/changelog</span>
</span><span class='line'><span class="gd">--- debian/changelog~    2013-03-11 09:09:19.000000000 +0100</span>
</span><span class='line'><span class="gi">+++ debian/changelog 2013-03-11 09:11:53.435109570 +0100</span>
</span><span class='line'><span class="gu">@@ -1,8 +1,8 @@</span>
</span><span class='line'><span class="gd">-dovecot (1:2.2.rc2-0ubuntu1) precise; urgency=low</span>
</span><span class='line'><span class="gi">+dovecot (1:2.2.rc2-0dp01~precise1) precise; urgency=low</span>
</span><span class='line'>
</span><span class='line'>   * New upstream release
</span><span class='line'>
</span><span class='line'><span class="gd">- -- Uli Heller &lt;uli@ubuntu1204.daemons-point.com&gt;  Mon, 11 Mar 2013 09:09:19 +0100</span>
</span><span class='line'><span class="gi">+ -- Uli Heller &lt;uli.heller@daemons-point.com&gt;  Mon, 11 Mar 2013 09:09:19 +0100</span>
</span><span class='line'>
</span><span class='line'> dovecot (1:2.0.19-0ubuntu2) precise-proposed; urgency=low
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Änderungen an debian/patches/series </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gh">diff -u debian/patches/series~ debian/patches/series</span>
</span><span class='line'><span class="gd">--- debian/patches/series~   2012-06-28 23:34:08.000000000 +0200</span>
</span><span class='line'><span class="gi">+++ debian/patches/series    2013-03-11 09:18:30.167126242 +0100</span>
</span><span class='line'><span class="gu">@@ -2,5 +2,5 @@</span>
</span><span class='line'> dovecot-drac.patch
</span><span class='line'> split-protocols.patch
</span><span class='line'> fix-mail_plugin_dir-default.patch
</span><span class='line'><span class="gd">-fix-racey-restarts.patch</span>
</span><span class='line'><span class="gi">+#fix-racey-restarts.patch</span>
</span><span class='line'> bug-1018579.patch
</span></code></pre></td></tr></table></div></figure>


<h2>Pigeonhole</h2>

<p>Pigeonhole wird seperat von Dovecot entwickelt. Ich habe die neuen Versionen heruntergeladen von
<a href="http://pigeonhole.dovecot.org/">http://pigeonhole.dovecot.org/</a>.</p>

<p>Für die DEB-Erstellung muß dann noch ein Patch dafür erzeugt werden. Das geht am besten so:</p>

<ul>
<li>Temporäre Verzeichnisse anlegen: <code>mkdir -p tmp/a tmp/b</code></li>
<li>Wechseln in&#8217;s Verzeichnis b: <code>cd tmp/b</code></li>
<li>Pigeonhole auspacken: <code>gzip -cd .../dovecot-2-2-pigeonhole-b75b00760b86.tar.gz|tar xf -</code></li>
<li>Verzeichnis umbenennen: <code>mv dove* pigeonhole</code></li>
<li>Patch erstellen: <code>cd ..; diff -Nur a b &gt;pigeonhole.patch</code></li>
</ul>


<h2>Diff</h2>

<figure class='code'><figcaption><span>dovecot_20_22.diff</span><a href='http://uli-heller.github.com/downloads/code/ubuntu/dovecot_20_22.diff' title='Download code'> download</a></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gh">diff -Nur dovecot-2.0.19/debian/changelog dovecot-2.2.rc2/debian/changelog</span>
</span><span class='line'><span class="gd">--- dovecot-2.0.19/debian/changelog  2012-06-28 23:38:39.000000000 +0200</span>
</span><span class='line'><span class="gi">+++ dovecot-2.2.rc2/debian/changelog 2013-03-11 09:23:35.000000000 +0100</span>
</span><span class='line'><span class="gu">@@ -1,3 +1,9 @@</span>
</span><span class='line'><span class="gi">+dovecot (1:2.2.rc2-0dp01~precise1) precise; urgency=low</span>
</span><span class='line'><span class="gi">+</span>
</span><span class='line'><span class="gi">+  * New upstream release</span>
</span><span class='line'><span class="gi">+</span>
</span><span class='line'><span class="gi">+ -- Uli Heller &lt;uli.heller@daemons-point.com&gt;  Mon, 11 Mar 2013 09:09:19 +0100</span>
</span><span class='line'><span class="gi">+</span>
</span><span class='line'> dovecot (1:2.0.19-0ubuntu2) precise-proposed; urgency=low
</span><span class='line'>
</span><span class='line'>   * Fix panic and core dump, cherry picked from upstream Mercurial.
</span><span class='line'><span class="gh">diff -Nur dovecot-2.0.19/debian/patches/dovecot-drac.patch dovecot-2.2.rc2/debian/patches/dovecot-drac.patch</span>
</span><span class='line'><span class="gd">--- dovecot-2.0.19/debian/patches/dovecot-drac.patch 2012-06-28 23:33:07.000000000 +0200</span>
</span><span class='line'><span class="gi">+++ dovecot-2.2.rc2/debian/patches/dovecot-drac.patch    2013-03-11 11:20:48.000000000 +0100</span>
</span><span class='line'><span class="gu">@@ -42,7 +42,7 @@</span>
</span><span class='line'> + *   http://dovecot.org/patches/1.1/drac.c
</span><span class='line'> + */
</span><span class='line'> +#include &quot;lib.h&quot;
</span><span class='line'><span class="gd">-+#include &quot;network.h&quot;</span>
</span><span class='line'><span class="gi">++#include &quot;net.h&quot;</span>
</span><span class='line'> +#include &quot;ioloop.h&quot;
</span><span class='line'> +#include &quot;mail-user.h&quot;
</span><span class='line'> +#include &quot;mail-storage-private.h&quot;
</span><span class='line'><span class="gh">diff -Nur dovecot-2.0.19/debian/patches/fix-mail_plugin_dir-default.patch dovecot-2.2.rc2/debian/patches/fix-mail_plugin_dir-default.patch</span>
</span><span class='line'><span class="gd">--- dovecot-2.0.19/debian/patches/fix-mail_plugin_dir-default.patch  2012-06-28 23:33:07.000000000 +0200</span>
</span><span class='line'><span class="gi">+++ dovecot-2.2.rc2/debian/patches/fix-mail_plugin_dir-default.patch 2013-03-11 10:55:09.000000000 +0100</span>
</span><span class='line'><span class="gu">@@ -8,11 +8,11 @@</span>
</span><span class='line'>  doc/example-config/conf.d/10-mail.conf |    2 +-
</span><span class='line'>  1 files changed, 1 insertions(+), 1 deletions(-)
</span><span class='line'>
</span><span class='line'><span class="gd">-diff --git a/doc/example-config/conf.d/10-mail.conf b/doc/example-config/conf.d/10-mail.conf</span>
</span><span class='line'><span class="gd">-index fe5cc31..4b918ed 100644</span>
</span><span class='line'><span class="gd">---- a/doc/example-config/conf.d/10-mail.conf</span>
</span><span class='line'><span class="gd">-+++ b/doc/example-config/conf.d/10-mail.conf</span>
</span><span class='line'><span class="gd">-@@ -200,7 +200,7 @@</span>
</span><span class='line'><span class="gi">+Index: dovecot-2.2.rc2/doc/example-config/conf.d/10-mail.conf</span>
</span><span class='line'><span class="gi">+===================================================================</span>
</span><span class='line'><span class="gi">+--- dovecot-2.2.rc2.orig/doc/example-config/conf.d/10-mail.conf 2013-02-22 12:20:04.000000000 +0100</span>
</span><span class='line'><span class="gi">++++ dovecot-2.2.rc2/doc/example-config/conf.d/10-mail.conf  2013-03-11 10:55:07.635357407 +0100</span>
</span><span class='line'><span class="gi">+@@ -201,7 +201,7 @@</span>
</span><span class='line'>  #auth_socket_path = /var/run/dovecot/auth-userdb
</span><span class='line'>
</span><span class='line'>  # Directory where to look up mail plugins.
</span><span class='line'><span class="gu">@@ -21,4 +21,3 @@</span>
</span><span class='line'>
</span><span class='line'>  # Space separated list of plugins to load for all services. Plugins specific to
</span><span class='line'>  # IMAP, LDA, etc. are added to this list in their own .conf files.
</span><span class='line'><span class="gd">--- </span>
</span><span class='line'><span class="gh">diff -Nur dovecot-2.0.19/debian/patches/pigeonhole.patch dovecot-2.2.rc2/debian/patches/pigeonhole.patch</span>
</span><span class='line'><span class="gd">--- dovecot-2.0.19/debian/patches/pigeonhole.patch   2012-06-28 23:33:07.000000000 +0200</span>
</span><span class='line'><span class="gi">+++ dovecot-2.2.rc2/debian/patches/pigeonhole.patch  2013-03-11 10:49:09.000000000 +0100</span>
</span><span class='line'>{not included}
</span><span class='line'><span class="gh">diff -Nur dovecot-2.0.19/debian/patches/series dovecot-2.2.rc2/debian/patches/series</span>
</span><span class='line'><span class="gd">--- dovecot-2.0.19/debian/patches/series 2012-06-28 23:34:08.000000000 +0200</span>
</span><span class='line'><span class="gi">+++ dovecot-2.2.rc2/debian/patches/series    2013-03-11 09:23:47.000000000 +0100</span>
</span><span class='line'><span class="gu">@@ -2,5 +2,5 @@</span>
</span><span class='line'> dovecot-drac.patch
</span><span class='line'> split-protocols.patch
</span><span class='line'> fix-mail_plugin_dir-default.patch
</span><span class='line'><span class="gd">-fix-racey-restarts.patch</span>
</span><span class='line'><span class="gd">-bug-1018579.patch</span>
</span><span class='line'><span class="gi">+#fix-racey-restarts.patch</span>
</span><span class='line'><span class="gi">+#bug-1018579.patch</span>
</span><span class='line'><span class="gh">diff -Nur dovecot-2.0.19/debian/patches/split-protocols.patch dovecot-2.2.rc2/debian/patches/split-protocols.patch</span>
</span><span class='line'><span class="gd">--- dovecot-2.0.19/debian/patches/split-protocols.patch  2012-06-28 23:33:07.000000000 +0200</span>
</span><span class='line'><span class="gi">+++ dovecot-2.2.rc2/debian/patches/split-protocols.patch 2013-03-11 10:55:06.000000000 +0100</span>
</span><span class='line'><span class="gu">@@ -12,11 +12,11 @@</span>
</span><span class='line'>  src/master/master-settings.c                       |    2 +-
</span><span class='line'>  4 files changed, 4 insertions(+), 7 deletions(-)
</span><span class='line'>
</span><span class='line'><span class="gd">-Index: dovecot/doc/example-config/dovecot.conf</span>
</span><span class='line'><span class="gi">+Index: dovecot-2.2.rc2/doc/example-config/dovecot.conf</span>
</span><span class='line'> ===================================================================
</span><span class='line'><span class="gd">---- dovecot.orig/doc/example-config/dovecot.conf    2012-03-07 08:19:52.000000000 -0500</span>
</span><span class='line'><span class="gd">-+++ dovecot/doc/example-config/dovecot.conf 2012-03-07 10:37:13.000000000 -0500</span>
</span><span class='line'><span class="gd">-@@ -16,8 +16,8 @@</span>
</span><span class='line'><span class="gi">+--- dovecot-2.2.rc2.orig/doc/example-config/dovecot.conf    2013-01-04 20:38:41.000000000 +0100</span>
</span><span class='line'><span class="gi">++++ dovecot-2.2.rc2/doc/example-config/dovecot.conf 2013-03-11 10:54:59.779357916 +0100</span>
</span><span class='line'><span class="gi">+@@ -20,8 +20,8 @@</span>
</span><span class='line'>  # options. The paths listed here are for configure --prefix=/usr
</span><span class='line'>  # --sysconfdir=/etc --localstatedir=/var
</span><span class='line'>
</span><span class='line'><span class="gu">@@ -27,10 +27,10 @@</span>
</span><span class='line'>
</span><span class='line'>  # A comma separated list of IPs or hosts where to listen in for connections.
</span><span class='line'>  # &quot;*&quot; listens in all IPv4 interfaces, &quot;::&quot; listens in all IPv6 interfaces.
</span><span class='line'><span class="gd">-Index: dovecot/pigeonhole/doc/example-config/conf.d/20-managesieve.conf</span>
</span><span class='line'><span class="gi">+Index: dovecot-2.2.rc2/pigeonhole/doc/example-config/conf.d/20-managesieve.conf</span>
</span><span class='line'> ===================================================================
</span><span class='line'><span class="gd">---- dovecot.orig/pigeonhole/doc/example-config/conf.d/20-managesieve.conf   2012-03-07 10:37:11.000000000 -0500</span>
</span><span class='line'><span class="gd">-+++ dovecot/pigeonhole/doc/example-config/conf.d/20-managesieve.conf    2012-03-07 10:37:13.000000000 -0500</span>
</span><span class='line'><span class="gi">+--- dovecot-2.2.rc2.orig/pigeonhole/doc/example-config/conf.d/20-managesieve.conf   2013-03-11 10:54:57.079337564 +0100</span>
</span><span class='line'><span class="gi">++++ dovecot-2.2.rc2/pigeonhole/doc/example-config/conf.d/20-managesieve.conf    2013-03-11 10:54:59.779357916 +0100</span>
</span><span class='line'> @@ -2,9 +2,6 @@
</span><span class='line'>  ## ManageSieve specific settings
</span><span class='line'>  ##
</span><span class='line'><span class="gu">@@ -40,12 +40,12 @@</span>
</span><span class='line'> -
</span><span class='line'>  # Service definitions
</span><span class='line'>
</span><span class='line'><span class="gd">- service managesieve-login {</span>
</span><span class='line'><span class="gd">-Index: dovecot/src/config/all-settings.c</span>
</span><span class='line'><span class="gi">+ #service managesieve-login {</span>
</span><span class='line'><span class="gi">+Index: dovecot-2.2.rc2/src/config/all-settings.c</span>
</span><span class='line'> ===================================================================
</span><span class='line'><span class="gd">---- dovecot.orig/src/config/all-settings.c  2012-03-07 08:19:52.000000000 -0500</span>
</span><span class='line'><span class="gd">-+++ dovecot/src/config/all-settings.c   2012-03-07 10:37:14.000000000 -0500</span>
</span><span class='line'><span class="gd">-@@ -1764,7 +1764,7 @@</span>
</span><span class='line'><span class="gi">+--- dovecot-2.2.rc2.orig/src/config/all-settings.c  2013-02-25 14:33:27.000000000 +0100</span>
</span><span class='line'><span class="gi">++++ dovecot-2.2.rc2/src/config/all-settings.c   2013-03-11 10:54:59.783357912 +0100</span>
</span><span class='line'><span class="gi">+@@ -2433,7 +2433,7 @@</span>
</span><span class='line'>      .libexec_dir = PKG_LIBEXECDIR,
</span><span class='line'>      .instance_name = PACKAGE,
</span><span class='line'>      .import_environment = &quot;TZ&quot; ENV_SYSTEMD ENV_GDB,
</span><span class='line'><span class="gu">@@ -54,11 +54,11 @@</span>
</span><span class='line'>      .listen = &quot;*, ::&quot;,
</span><span class='line'>      .ssl = &quot;yes:no:required&quot;,
</span><span class='line'>      .default_internal_user = &quot;dovecot&quot;,
</span><span class='line'><span class="gd">-Index: dovecot/src/master/master-settings.c</span>
</span><span class='line'><span class="gi">+Index: dovecot-2.2.rc2/src/master/master-settings.c</span>
</span><span class='line'> ===================================================================
</span><span class='line'><span class="gd">---- dovecot.orig/src/master/master-settings.c   2012-03-07 08:19:52.000000000 -0500</span>
</span><span class='line'><span class="gd">-+++ dovecot/src/master/master-settings.c    2012-03-07 10:37:14.000000000 -0500</span>
</span><span class='line'><span class="gd">-@@ -213,7 +213,7 @@</span>
</span><span class='line'><span class="gi">+--- dovecot-2.2.rc2.orig/src/master/master-settings.c   2013-02-18 05:47:18.000000000 +0100</span>
</span><span class='line'><span class="gi">++++ dovecot-2.2.rc2/src/master/master-settings.c    2013-03-11 10:54:59.783357912 +0100</span>
</span><span class='line'><span class="gi">+@@ -216,7 +216,7 @@</span>
</span><span class='line'>      .libexec_dir = PKG_LIBEXECDIR,
</span><span class='line'>      .instance_name = PACKAGE,
</span><span class='line'>      .import_environment = &quot;TZ&quot; ENV_SYSTEMD ENV_GDB,
</span><span class='line'><span class="gh">diff -Nur dovecot-2.0.19/debian/rules dovecot-2.2.rc2/debian/rules</span>
</span><span class='line'><span class="gd">--- dovecot-2.0.19/debian/rules  2012-06-28 23:33:07.000000000 +0200</span>
</span><span class='line'><span class="gi">+++ dovecot-2.2.rc2/debian/rules 2013-03-11 11:20:33.000000000 +0100</span>
</span><span class='line'><span class="gu">@@ -47,7 +47,7 @@</span>
</span><span class='line'>              --disable-static
</span><span class='line'>  $(MAKE) dovecot-config
</span><span class='line'>  # Pigeonhole
</span><span class='line'><span class="gd">-    (cd $(PIGEONHOLE_DIR)/ &amp;&amp; \</span>
</span><span class='line'><span class="gi">+    (cd $(PIGEONHOLE_DIR)/ &amp;&amp; sh ./autogen.sh \</span>
</span><span class='line'>      touch stamp.h.in &amp;&amp; \
</span><span class='line'>      $(shell dpkg-buildflags --export=configure) sh configure \
</span><span class='line'>      --with-dovecot=../ \
</span><span class='line'><span class="gu">@@ -105,7 +105,7 @@</span>
</span><span class='line'>  install -m644 debian/dovecot-core.ufw.profile debian/dovecot-core/etc/ufw/applications.d/dovecot-core
</span><span class='line'>  install -D -m 0755 -o root -g root $(CURDIR)/debian/maildirmake.dovecot $(CURDIR)/debian/dovecot-core/usr/bin/maildirmake.dovecot
</span><span class='line'>  mv $(CURDIR)/debian/dovecot-core/usr/share/doc/dovecot $(CURDIR)/debian/dovecot-core/usr/share/doc/dovecot-core
</span><span class='line'><span class="gd">-    cp $(PIGEONHOLE_DIR)/ChangeLog $(CURDIR)/debian/dovecot-core/usr/share/doc/dovecot-core/pigeonhole.ChangeLog</span>
</span><span class='line'><span class="gi">+    #cp $(PIGEONHOLE_DIR)/ChangeLog $(CURDIR)/debian/dovecot-core/usr/share/doc/dovecot-core/pigeonhole.ChangeLog</span>
</span><span class='line'>  cp $(PIGEONHOLE_DIR)/README $(CURDIR)/debian/dovecot-core/usr/share/doc/dovecot-core/pigeonhole.README
</span><span class='line'>  cp $(PIGEONHOLE_DIR)/NEWS $(CURDIR)/debian/dovecot-core/usr/share/doc/dovecot-core/pigeonhole.NEWS
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>

<p><a rel="bookmark" href="http://uli-heller.github.com/2013/03/11/dovecot/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Octopress-Aktualisierung 1/2 - Grundtests]]></title>
<link href="http://uli-heller.github.com/2013/03/11/octopress-aktualisierung/"/>
<updated>2013-03-11T08:00:00+01:00</updated>
<id>http://uli-heller.github.com/2013/03/11/octopress-aktualisierung</id>

      <content type="html"><![CDATA[<h1>Aktualisierung meiner Octopress-Installation (1/2)</h1>

<p>Vor grob 5 Monaten habe ich Octopress erstmalig aufgesetzt und seitdem die
Finger von den Aktualisierungen gelassen. Dadurch funktionieren in &#8220;meiner&#8221; Installation
nun gewisse Dinge nicht ganz so gut wir im Original. Beispielsweise soll die Verlinkung
von Blog-Posts im Original über einen Methodenaufruf funktionieren, bei meiner Variante
muß ich mir den Link mühsam zusammenklauben.</p>

<p>Erstmal möchte ich testen, ob die aktualisierte Version überhaupt funktioniert. Diese Tests
mache ich mit &#8220;master&#8221; und &#8220;source-2.1&#8221;.</p>

<!-- more -->


<h2>Aktuelle Octopress-Version runterladen</h2>

<figure class='code'><figcaption><span>Octropress runterladen </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>git clone git://github.com/imathis/octopress.git octopress
</span><span class='line'><span class="nb">cd </span>octopress
</span><span class='line'>git branch -a
</span><span class='line'>  * master
</span><span class='line'>    remotes/origin/2.1
</span><span class='line'>    remotes/origin/HEAD -&gt; origin/master
</span><span class='line'>    remotes/origin/colorize
</span><span class='line'>    remotes/origin/gh-pages
</span><span class='line'>    remotes/origin/guard
</span><span class='line'>    remotes/origin/linklog
</span><span class='line'>    remotes/origin/master
</span><span class='line'>    remotes/origin/migrator
</span><span class='line'>    remotes/origin/refactor_with_tests
</span><span class='line'>    remotes/origin/rubygemcli
</span><span class='line'>    remotes/origin/site
</span><span class='line'>    remotes/origin/site-2.1
</span></code></pre></td></tr></table></div></figure>


<h2>Kurztest Octopress-2.0</h2>

<figure class='code'><figcaption><span>Kurztest Octropress-2.0 </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nb">cd </span>octopress
</span><span class='line'>gem install bundler
</span><span class='line'>bundle install
</span><span class='line'>rake install
</span><span class='line'>rake generate
</span><span class='line'>rake preview
</span></code></pre></td></tr></table></div></figure>


<p>&#8230; danach dann im Browser den Link <a href="http://localhost:4000">http://localhost:4000</a> öffnen - es
wird die Octopress-Grundseite angezeigt.</p>

<h2>Kurztest Octopress-2.1</h2>

<figure class='code'><figcaption><span>Kurztest Octropress-2.1 - Mecker wegen JavaScript runtime </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nb">cd </span>octopress
</span><span class='line'>git checkout 2.1
</span><span class='line'>gem install bundler
</span><span class='line'>bundle install
</span><span class='line'>rake install
</span><span class='line'>  rake aborted!
</span><span class='line'>  Could not find a JavaScript runtime. See https://github.com/sstephenson/execjs <span class="k">for </span>a list of available runtimes.
</span><span class='line'>  /home/uli/.rvm/gems/ruby-1.9.3-p327/gems/execjs-1.4.0/lib/execjs/runtimes.rb:51:in <span class="sb">`</span>autodetect<span class="s1">&#39;</span>
</span><span class='line'><span class="s1">  /home/uli/.rvm/gems/ruby-1.9.3-p327/gems/execjs-1.4.0/lib/execjs.rb:5:in `&lt;module:ExecJS&gt;&#39;</span>
</span><span class='line'>  /home/uli/.rvm/gems/ruby-1.9.3-p327/gems/execjs-1.4.0/lib/execjs.rb:4:in <span class="sb">`</span>&lt;top <span class="o">(</span>required<span class="o">)</span>&gt;<span class="s1">&#39;</span>
</span><span class='line'><span class="s1">  /home/uli/.rvm/gems/ruby-1.9.3-p327/gems/uglifier-1.2.6/lib/uglifier.rb:3:in `require&#39;</span>
</span><span class='line'>  /home/uli/.rvm/gems/ruby-1.9.3-p327/gems/uglifier-1.2.6/lib/uglifier.rb:3:in <span class="sb">`</span>&lt;top <span class="o">(</span>required<span class="o">)</span>&gt;<span class="s1">&#39;</span>
</span><span class='line'><span class="s1">  /home/uli/tmp/o/octopress/lib/octopress/js_asset_manager.rb:4:in `require&#39;</span>
</span><span class='line'>  /home/uli/tmp/o/octopress/lib/octopress/js_asset_manager.rb:4:in <span class="sb">`</span>&lt;top <span class="o">(</span>required<span class="o">)</span>&gt;<span class="s1">&#39;</span>
</span><span class='line'><span class="s1">  /home/uli/tmp/o/octopress/lib/octopress.rb:5:in `require&#39;</span>
</span><span class='line'>  /home/uli/tmp/o/octopress/lib/octopress.rb:5:in <span class="sb">`</span>&lt;top <span class="o">(</span>required<span class="o">)</span>&gt;<span class="s1">&#39;</span>
</span><span class='line'><span class="s1">  /home/uli/tmp/o/octopress/Rakefile:9:in `require&#39;</span>
</span><span class='line'>  /home/uli/tmp/o/octopress/Rakefile:9:in <span class="sb">`</span>&lt;top <span class="o">(</span>required<span class="o">)</span>&gt;<span class="s1">&#39;</span>
</span><span class='line'><span class="s1">  /home/uli/.rvm/gems/ruby-1.9.3-p327/bin/ruby_noexec_wrapper:14:in `eval&#39;</span>
</span><span class='line'>  /home/uli/.rvm/gems/ruby-1.9.3-p327/bin/ruby_noexec_wrapper:14:in <span class="sb">`</span>&lt;main&gt;<span class="err">&#39;</span>
</span><span class='line'>  <span class="o">(</span>See full trace by running task with --trace<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>&#8230; funktioniert also nicht so richtig.</p>

<p>Am einfachsten korrigiert man&#8217;s durch Anpassung vom Gemfile:</p>

<figure class='code'><figcaption><span>Anpassungen am Gemfile </span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gh">diff --git a/Gemfile b/Gemfile</span>
</span><span class='line'><span class="gu">@@ -15,6 +15,7 @@</span>
</span><span class='line'> group :development do
</span><span class='line'>   gem &#39;tzinfo&#39;, &#39;~&gt; 0.3.35&#39;
</span><span class='line'>   gem &#39;stitch-rb&#39;
</span><span class='line'>   gem &#39;uglifier&#39;
</span><span class='line'><span class="gi">+  gem &#39;therubyracer&#39;</span>
</span><span class='line'>
</span><span class='line'>   # Guard related
</span><span class='line'>   gem &#39;guard&#39;
</span></code></pre></td></tr></table></div></figure>


<p>Danach dann <code>bundle install</code> und alles wird gut! Nach <code>rake install</code>, <code>rake generate</code>
und <code>rake preview</code> kann man wie üblich
im Browser den Link <a href="http://localhost:4000">http://localhost:4000</a> öffnen und es
wird die Octopress-Grundseite angezeigt.</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/03/11/octopress-aktualisierung/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
    <entry>
      




<title type="html"><![CDATA[Chrome-Erweiterungen - Teil 2/2: CRX-Dateien einspielen]]></title>
<link href="http://uli-heller.github.com/2013/03/07/crx-install/"/>
<updated>2013-03-07T12:00:00+01:00</updated>
<id>http://uli-heller.github.com/2013/03/07/crx-install</id>

      <content type="html"><![CDATA[<h1>Offline-Installation einer Chrome-Erweiterung - Teil 2: CRX-Dateien einspielen</h1>

<p>Hier beschreibe ich kurz, wie man CRX-Dateien in Google-Chrome einspielt.
Die CRX-Dateien müssen zuvor heruntergeladen worden sein, siehe hierzu
<a href="http://uli-heller.github.com/2013/03/04/chrome-extensions">CRX-Dateien herunterladen</a>.
Getestet hab&#8217; ich&#8217;s mit Google-Chrome 25 unter Linux.</p>

<!-- more -->


<p>Zunächst muß in Google-Chrome das Erweiterungsfenster geöffnet werden über
&#8220;Einstellungen&#8221; - &#8220;Tools&#8221; - &#8220;Erweiterungen&#8221;:</p>

<p><img src="http://uli-heller.github.com/images/chrome/chrome-extensions-1.png" alt="Menü: Erweiterungen" /></p>

<p>Nach dem Betätigen des Menüpunktes erscheint dieses Fenster:</p>

<p><img src="http://uli-heller.github.com/images/chrome/chrome-extensions-2.png" alt="Erweiterungen" /></p>

<p>Als nächstes: CRX-Datei in Nautilus selektieren und auf das
Google-Chrome-Erweiterungsfenster &#8220;fallen lassen&#8221;. Am unteren Rand
erscheint ein Bestätigungsdialog:</p>

<p><img src="http://uli-heller.github.com/images/chrome/chrome-extensions-3.png" alt="Bestätigung" /></p>

<p>Nachdem die Installationserlaubnis erteilt ist, wird die neue
Erweiterung als &#8220;installiert&#8221; und &#8220;aktiviert&#8221; angezeigt:</p>

<p><img src="http://uli-heller.github.com/images/chrome/chrome-extensions-4.png" alt="Aktivierte Erweiterung" /></p>

<p>Bei mir gibt&#8217;s Probleme, wenn ich nun direkt noch eine weitere CRX-Datei
einspielen möchte. Sie &#8220;landet&#8221; dann einfach nicht im Erweiterungsfenster.
Abhilfe schafft schließen und neu öffnen des Fensters.</p>
<p><a rel="bookmark" href="http://uli-heller.github.com/2013/03/07/crx-install/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
</feed>
