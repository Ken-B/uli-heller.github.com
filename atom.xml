<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Was ich so treibe...]]></title>
  <link href="http://uli-heller.github.com/atom.xml" rel="self"/>
  <link href="http://uli-heller.github.com/"/>
  <updated>2013-09-07T09:09:18+02:00</updated>
  <id>http://uli-heller.github.com/</id>
  <author>
    <name><![CDATA[Uli Heller]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Statische Fotogallerie für Octopress]]></title>
    <link href="http://uli-heller.github.com/blog/2013/09/07/gallery/"/>
    <updated>2013-09-07T09:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/09/07/gallery</id>
    <content type="html"><![CDATA[<p>In <a href="http://uli-heller.github.com/blog/2013/08/04/gallery">/blog/2013/08/04/gallery</a> habe ich beschrieben, wie ich meine Fotogallerie
in Octopress einbinde. Leider zeigt sich, dass der dort verwendete Ansatz
den ganzen Generierungsprozess ziemlich stark ausbremst.</p>

<p>Ziel dieses Artikels ist die Beschleunigung des Generierungsprozesses.</p>

<!-- more -->


<h2>Problembeschreibung</h2>

<p>Das Plugin <a href="https://github.com/yortz/octopress_gallery">Octopress-Gallery</a>
zur Anzeige der Fotogallerie konvertiert die Bilder automatisch in&rsquo;s
Thumbnail-Format. Es ist zwar ein Algorithmus eingebaut, der die Konvertierung
der Bilder nur dann durchführen soll, wenn sich die Bilder geändert haben &ndash;
er funktioniert aber leider nicht.</p>

<h2>Lösungsansatz</h2>

<ul>
<li>Ich erzeuge ein Skript, welches die Konvertierung vornimmt</li>
<li>Das Skript selbst hat auch eine &ldquo;Änderungserkennung&rdquo;, d.h. es werden
wirklich nur die gänderten Bilder neu konvertiert</li>
<li>Das Skript muß manuell ausgeführt werden</li>
<li>Die konvertierten Bilder liegen im Verzeichnis &ldquo;source&rdquo; und werden
mit in Git gespeichert.</li>
</ul>


<p>Als Konsequenz dieser Änderungen müssen noch:</p>

<ul>
<li>Die Konvertierung von <a href="https://github.com/yortz/octopress_gallery">Octopress-Gallery</a> muß abgeklemmt werden</li>
<li>Skalierte Bilder einbinden in die Gallerie</li>
</ul>


<h2>Umsetzung</h2>

<h3>Konvertierungsskript</h3>

<p>Das Konvertierungsskript befindet sich <a href="https://github.com/uli-heller/uli-octopress/blob/master/create-galleries.sh">auf GitHub</a></p>

<h3>Abklemmen der alten Konvertierung</h3>

<p>Die alte Konvertierung wird abgeklemmt, in dem</p>

<ul>
<li>das MiniMagick-Plugin gelöscht wird</li>
<li>die MiniMagick-Konfiguration entfernt wird</li>
</ul>


<h4>MiniMagick-Plugin löschen</h4>

<figure class='code'><figcaption><span>MiniMagick-Plugin entfernen </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rm -f plugins/mini_magick.rb</span></code></pre></td></tr></table></div></figure>


<h4>MiniMagick-Konfiguration entfernen</h4>

<figure class='code'><figcaption><span>MiniMagick-Konfiguration entfernen </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>diff --git a/_config.yml b/_config.yml
</span><span class='line'>index 33ac290..7371444 100644
</span><span class='line'>--- a/_config.yml
</span><span class='line'>+++ b/_config.yml
</span><span class='line'>@@ -100,23 +100,3 @@ google_analytics_tracking_id:
</span><span class='line'> 
</span><span class='line'> # Facebook Like
</span><span class='line'> facebook_like: false
</span><span class='line'>-
</span><span class='line'>-mini_magick:
</span><span class='line'>-    test_thumbnail:
</span><span class='line'>-      source: images/galleries/test
</span><span class='line'>-      destination: images/galleries/test/thumbs
</span><span class='line'>-      commands:
</span><span class='line'>-        - thumbnail: "64x48^"
</span><span class='line'>-        - crop: "64x48-0x0"
</span><span class='line'>-    centos_thumbnail:
</span><span class='line'>-      source: images/galleries/centos
</span><span class='line'>-      destination: images/galleries/centos/thumbs
</span><span class='line'>-      commands:
</span><span class='line'>-        - thumbnail: "64x48^"
</span><span class='line'>-        - crop: "64x48-0x0"
</span><span class='line'>-    centos59_thumbnail:
</span><span class='line'>-      source: images/galleries/centos59
</span><span class='line'>-      destination: images/galleries/centos59/thumbs
</span><span class='line'>-      commands:
</span><span class='line'>-        - thumbnail: "64x48^"
</span><span class='line'>-        - crop: "64x48-0x0"</span></code></pre></td></tr></table></div></figure>


<h3>Skalierte Bilder einbinden</h3>

<p>Hierzu muß die Datei plugins/gallery_tag.rb angepasst werden.
Wir ändern dies so, dass</p>

<ul>
<li>für die Thumbnails die kleinen Bilder unterhalb von &hellip;/thumbs verwendet werden</li>
<li>für die Standard-Anzeige die mittleren Bilder unterhalb von &hellip;/scaled verwendet werden</li>
<li>für die Großanzeige die originalen Bilder verwendet werden</li>
</ul>


<figure class='code'><figcaption><span>Änderungen an ./plugins/gallery_tag.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gh">diff --git a/plugins/gallery_tag.rb b/plugins/gallery_tag.rb</span>
</span><span class='line'><span class="gh">index 2e09f9b..8be9ff4 100644</span>
</span><span class='line'><span class="gd">--- a/plugins/gallery_tag.rb</span>
</span><span class='line'><span class="gi">+++ b/plugins/gallery_tag.rb</span>
</span><span class='line'><span class="gu">@@ -7,13 +7,13 @@ module ImageList</span>
</span><span class='line'>     list &lt;&lt; %Q{&lt;script src=&quot;/javascripts/fotorama/jquery-1.10.2.min.js&quot;&gt;&lt;/script&gt;}
</span><span class='line'>     list &lt;&lt; %Q{&lt;link href=&quot;/javascripts/fotorama/fotorama.css&quot; rel=&quot;stylesheet&quot;&gt;}
</span><span class='line'>     list &lt;&lt; %Q{&lt;script src=&quot;/javascripts/fotorama/fotorama.js&quot;&gt;&lt;/script&gt;}
</span><span class='line'><span class="gd">-    list &lt;&lt; %Q{&lt;div class=&quot;fotorama&quot; data-autoplay=&quot;3000&quot; data-transition=&quot;dissolve&quot; data-nav=&quot;thumbs&quot; data-allow-full-screen=&quot;true&quot; data-keyboard=&quot;true&quot; data-width=&quot;80%&quot; data-thumb-with=&quot;64&quot; data-thumb-height=&quot;48&quot;&gt;} # data-width=&quot;100%&quot; data-thumb-width= data-thumb-height=</span>
</span><span class='line'><span class="gi">+    list &lt;&lt; %Q{&lt;div class=&quot;fotorama&quot; data-autoplay=&quot;3000&quot; data-transition=&quot;dissolve&quot; data-nav=&quot;thumbs&quot; data-allow-full-screen=&quot;true&quot; data-keyboard=&quot;true&quot; data-width=&quot;640&quot; data-height=&quot;480&quot; data-thumb-with=&quot;64&quot; data-thumb-height=&quot;48&quot;&gt;} # data-width=&quot;100%&quot; data-thumb-width= data-thumb-height=</span>
</span><span class='line'>     dir = Dir.new( File.join(BASE_DIR, name) )
</span><span class='line'>     dir.sort.each do | d |
</span><span class='line'>       image = File.basename(d, File.extname(d))
</span><span class='line'>       unless d =~ /^\./ || d =~ /thumbs/ || d =~ /scaled/ || d =~ /_md5/
</span><span class='line'> #        list &lt;&lt; %Q{&lt;a href=&quot;/images/galleries/#{name}/#{d}&quot; rel=&quot;shadowbox&quot; title=&quot;#{image}&quot;&gt;&lt;img src=&quot;/images/galleries/#{name}/thumbs/#{d}&quot; /&gt;&lt;/a&gt;}
</span><span class='line'><span class="gd">-        list &lt;&lt; %Q{&lt;a href=&quot;/images/galleries/#{name}/scaled/#{d}&quot;&gt;&lt;img src=&quot;/images/galleries/#{name}/thumbs/#{d}&quot;/&gt;&lt;/a&gt;}</span>
</span><span class='line'><span class="gi">+        list &lt;&lt; %Q{&lt;a href=&quot;/images/galleries/#{name}/scaled/#{d}&quot; data-full=&quot;/images/galleries/#{name}/#{d}&quot; data-fit=&quot;scaledown&quot;&gt;&lt;img src=&quot;/images/galleries/#{name}/thumbs/#{d}&quot; data-fit=&quot;scaledown&quot;/&gt;&lt;/a&gt;}</span>
</span><span class='line'>       end
</span><span class='line'>     end
</span><span class='line'>     list &lt;&lt; %Q{&lt;/div&gt; &lt;!--class=&quot;fotorama&quot; data-nav=&quot;thumbs&quot; --&gt;}
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LXC: Fehler bei 'apt-get upgrade' - udev]]></title>
    <link href="http://uli-heller.github.com/blog/2013/09/03/lxc-apt-upgrade-udev/"/>
    <updated>2013-09-03T08:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/09/03/lxc-apt-upgrade-udev</id>
    <content type="html"><![CDATA[<p>In letzter Zeit tritt ein Problem beim Ausführen
von <code>apt-get upgrade</code> in meinen LXC-Containern auf:</p>

<pre><code>$ sudo apt-get upgrade
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following packages will be upgraded:
  apt apt-utils base-files gnupg gpgv libapt-inst1.4 libapt-pkg4.12 libudev0
  lsb-base lsb-release udev
11 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Need to get 3752 kB of archives.
After this operation, 25.6 kB of additional disk space will be used.
Do you want to continue [Y/n]? 
...
Preparing to replace udev 175-0ubuntu9.3 (using .../udev_175-0ubuntu9.4_amd64.deb) ...
Adding 'diversion of /sbin/udevadm to /sbin/udevadm.upgrade by fake-udev'
dpkg: unrecoverable fatal error, aborting:
 failed to fstat previous diversions file: No such file or directory
E: Sub-process /usr/bin/dpkg returned an error code (2)
</code></pre>

<p>Ich denke, das Problem hängt zusammen mit der Aktualisierung des
Paketes &ldquo;udev&rdquo;.</p>

<p>Zur Korrektur des Problems muß ich mehrfach diese Kommandos ausführen:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo dpkg --configure -a
</span><span class='line'>$ sudo apt-get upgrade</span></code></pre></td></tr></table></div></figure>


<p>Nach zwei bis drei Durchläufen ist das Problem verschwunden.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Experimente mit CentOS-5.9]]></title>
    <link href="http://uli-heller.github.com/blog/2013/08/16/centos59/"/>
    <updated>2013-08-16T08:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/08/16/centos59</id>
    <content type="html"><![CDATA[<p>Heute habe ich mir vorgenommen, ein paar Experimente mit CentOS-5.9
durchzuführen. CentOS ist eine Linux-Distribution, die den Anspruch
hat, weitgehend kompatibel zu RedHat Enterprise Linux (RHEL) ist.
Meine Hoffnung ist, dass sich die Erkenntnisse, die ich heute sammle,
auch in einem anstehenden Kundenprojekt anwenden lassen, bei dem RHEL
zum Einsatz kommen wird.</p>

<!-- more -->


<h2>VirtualBox</h2>

<p>Bei der Installation als Gastsystem innerhalb von VirtualBox
sind folgende Besonderheiten zu beachten:</p>

<ul>
<li><p>Bei &ldquo;System&rdquo; muß folgendes aktiviert werden:</p>

<ul>
<li>Chipsatz: ICH9</li>
<li>IO-APIC aktivieren</li>
</ul>


<p>Mit anderen Einstellungen blieb bei mir das Gastsystem immer hängen</p></li>
<li><p>Für den Massenspeicher sollte nur ein IDE-Controller verwendet werden</p>

<p>Bei mir blieb das Gastsystem immer hängen, wenn ich einen SATA-Controller verwendet habe</p></li>
</ul>


<h2>Grundinstallation</h2>

<script src="http://uli-heller.github.com/javascripts/fotorama/jquery-1.10.2.min.js"></script>


<p><link href="http://uli-heller.github.com/javascripts/fotorama/fotorama.css" rel="stylesheet"><script src="http://uli-heller.github.com/javascripts/fotorama/fotorama.js"></script><div class="fotorama" data-autoplay="3000" data-transition="dissolve" data-nav="thumbs" data-allow-full-screen="true" data-keyboard="true" data-width="640" data-height="480" data-thumb-with="64" data-thumb-height="48"><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/001-create-vm.png" data-full="/images/galleries/centos59/001-create-vm.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/001-create-vm.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/002-memory-size.png" data-full="/images/galleries/centos59/002-memory-size.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/002-memory-size.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/003-harddisk.png" data-full="/images/galleries/centos59/003-harddisk.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/003-harddisk.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/004-harddisk-type.png" data-full="/images/galleries/centos59/004-harddisk-type.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/004-harddisk-type.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/005-harddisk-storage.png" data-full="/images/galleries/centos59/005-harddisk-storage.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/005-harddisk-storage.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/006-harddisk-size.png" data-full="/images/galleries/centos59/006-harddisk-size.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/006-harddisk-size.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/007-vm.png" data-full="/images/galleries/centos59/007-vm.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/007-vm.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/008-vm.png" data-full="/images/galleries/centos59/008-vm.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/008-vm.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/009-settings.png" data-full="/images/galleries/centos59/009-settings.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/009-settings.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/010-settings-2.png" data-full="/images/galleries/centos59/010-settings-2.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/010-settings-2.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/010-settings-3.png" data-full="/images/galleries/centos59/010-settings-3.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/010-settings-3.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/011-vm-2.png" data-full="/images/galleries/centos59/011-vm-2.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/011-vm-2.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/012-boot.png" data-full="/images/galleries/centos59/012-boot.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/012-boot.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/013-boot.png" data-full="/images/galleries/centos59/013-boot.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/013-boot.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/014-boot.png" data-full="/images/galleries/centos59/014-boot.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/014-boot.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/015-boot.png" data-full="/images/galleries/centos59/015-boot.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/015-boot.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/016-skip-test.png" data-full="/images/galleries/centos59/016-skip-test.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/016-skip-test.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/017-anaconda.png" data-full="/images/galleries/centos59/017-anaconda.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/017-anaconda.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/018-welcome.png" data-full="/images/galleries/centos59/018-welcome.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/018-welcome.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/019-english-ok.png" data-full="/images/galleries/centos59/019-english-ok.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/019-english-ok.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/019-english.png" data-full="/images/galleries/centos59/019-english.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/019-english.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/020-keyboard.png" data-full="/images/galleries/centos59/020-keyboard.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/020-keyboard.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/021-harddisk.png" data-full="/images/galleries/centos59/021-harddisk.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/021-harddisk.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/022-harddisk-ok.png" data-full="/images/galleries/centos59/022-harddisk-ok.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/022-harddisk-ok.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/023-harddisk-ok.png" data-full="/images/galleries/centos59/023-harddisk-ok.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/023-harddisk-ok.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/024-partition-no.png" data-full="/images/galleries/centos59/024-partition-no.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/024-partition-no.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/025-network-yes.png" data-full="/images/galleries/centos59/025-network-yes.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/025-network-yes.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/026-eth0.png" data-full="/images/galleries/centos59/026-eth0.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/026-eth0.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/027-eth0-ipv4.png" data-full="/images/galleries/centos59/027-eth0-ipv4.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/027-eth0-ipv4.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/028-eth0-ipv6.png" data-full="/images/galleries/centos59/028-eth0-ipv6.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/028-eth0-ipv6.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/029-hostname.png" data-full="/images/galleries/centos59/029-hostname.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/029-hostname.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/030-timezone.png" data-full="/images/galleries/centos59/030-timezone.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/030-timezone.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/031-password.png" data-full="/images/galleries/centos59/031-password.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/031-password.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/032-packages.png" data-full="/images/galleries/centos59/032-packages.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/032-packages.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/033-dependencies.png" data-full="/images/galleries/centos59/033-dependencies.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/033-dependencies.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/034-begin.png" data-full="/images/galleries/centos59/034-begin.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/034-begin.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/035-formatting.png" data-full="/images/galleries/centos59/035-formatting.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/035-formatting.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/036-completed.png" data-full="/images/galleries/centos59/036-completed.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/036-completed.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/037-rebooting.png" data-full="/images/galleries/centos59/037-rebooting.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/037-rebooting.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/038-booting.png" data-full="/images/galleries/centos59/038-booting.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/038-booting.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/039-booting.png" data-full="/images/galleries/centos59/039-booting.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/039-booting.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/040-booting.png" data-full="/images/galleries/centos59/040-booting.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/040-booting.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos59/scaled/041-setup.png" data-full="/images/galleries/centos59/041-setup.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos59/thumbs/041-setup.png" data-fit="scaledown"/></a></div> <!--class="fotorama" data-nav="thumbs" --></p>

<h2>TBC</h2>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Git-Svn: Absturz bei 'dcommit', 'rebase', ...]]></title>
    <link href="http://uli-heller.github.com/blog/2013/08/08/git-svn-absturz/"/>
    <updated>2013-08-08T08:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/08/08/git-svn-absturz</id>
    <content type="html"><![CDATA[<p>Seit der Aktualisierung auf Subversion-1.8.1 gibt es immer wieder
Fehler bei der Ausführung von Git-Svn-Kommandos. Beobachtet habe ich
die Fehler bei</p>

<ul>
<li><code>git svn dcommit</code></li>
<li><code>git svn rebase</code></li>
<li><code>git svn clone</code></li>
</ul>


<p>Der Fehler tritt nur beim &ldquo;Aufräumen&rdquo; auf, d.h. nachdem das betreffende
Kommando abgearbeitet ist und der Git-Svn-Prozess nur noch beendet werden
muß. Er tritt auch nur auf, wenn Daten über die Leitung geschickt werden,
also wenn:</p>

<ul>
<li>das lokale Git-Repo geändert wurde (dcommit)</li>
<li>das Svn-Repository geändert wurde (rebase)</li>
</ul>


<p>Wenn man den Fehler einfach ignoriert, kann man &ldquo;normal&rdquo; weiterarbeiten.</p>

<!-- more -->


<h2>Reproduzieren des Problems</h2>

<p>Am einfachsten läßt sich das Problem reproduzieren, wenn man ein
Subversion-Repository mit Testdaten verfügbar hat. Bei mir hat das den Namen
&ldquo;sandbox&rdquo;.</p>

<p>Ach ja: Das Subversion-Repository muß via &ldquo;<a href="https://...">https://&#8230;</a>&rdquo; angesprochen werden.
Mit einem lokalen Subversion-Repository,
das mittels &ldquo;file://&hellip;&rdquo; angesprochen wird,
tritt das Problem nicht auf!</p>

<figure class='code'><figcaption><span>Clonen des Svn-Repositories </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>~/git<span class="nv">$ </span>git svn clone --stdlayout https://<span class="o">{</span>servername<span class="o">}</span>/<span class="o">{</span>pfad<span class="o">}</span>/sandbox
</span><span class='line'>Initialisierte leeres Git-Projektarchiv in .../git/sandbox/.git/
</span><span class='line'><span class="nv">r1</span> <span class="o">=</span> 7ebd17bca2c5e3ead4816e93371d695eb3e19a36 <span class="o">(</span>refs/remotes/trunk<span class="o">)</span>
</span><span class='line'>  A   bug-fix.ticket18
</span><span class='line'><span class="nv">r2</span> <span class="o">=</span> 77410a5f40f2eaeaf666f9fbda5261a521acb33f <span class="o">(</span>refs/remotes/trunk<span class="o">)</span>
</span><span class='line'>  M   bug-fix.ticket18
</span><span class='line'>...
</span><span class='line'><span class="nv">r81</span> <span class="o">=</span> 32ebfb3669331a5a5b60d27dbf54e0b6c7a601da <span class="o">(</span>refs/remotes/trunk<span class="o">)</span>
</span><span class='line'>Checked out HEAD:
</span><span class='line'>  https://83.236.132.107/svn/sandbox/trunk r81
</span><span class='line'>creating empty directory: baumkonflikt/dir1
</span><span class='line'>creating empty directory: danyi_tests
</span><span class='line'>error: git-svn died of signal 11
</span><span class='line'>~/git<span class="nv">$ </span><span class="nb">cd </span>sandbox
</span></code></pre></td></tr></table></div></figure>


<p>Hierbei tritt der Fehler auf. Der Ablauf ist aber verhältnismässig aufwändig,
weil immer das ganze Repository kopiert wird.</p>

<figure class='code'><figcaption><span>Neue Datei git-svn-absturz.txt </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>~/git/sandbox<span class="nv">$ </span>date &gt;&gt;git-svn-absturz.txt
</span><span class='line'>~/git/sandbox<span class="nv">$ </span>git add git-svn-absturz.txt
</span><span class='line'>~/git/sandbox<span class="nv">$ </span>git commit -m <span class="s2">&quot;Aktualisiert: git-svn-absturz.txt&quot;</span> .
</span><span class='line'><span class="o">[</span>master b984d2a<span class="o">]</span> Aktualisiert: git-svn-absturz.txt
</span><span class='line'> 1 file changed, 1 insertion<span class="o">(</span>+<span class="o">)</span>
</span><span class='line'> create mode 100644 git-svn-absturz.txt
</span><span class='line'>~/git/sandbox<span class="nv">$ </span>git svn dcommit
</span><span class='line'>Committing to https://83.236.132.107/svn/sandbox/trunk ...
</span><span class='line'>  A   git-svn-absturz.txt
</span><span class='line'>Committed r82
</span><span class='line'>  A   git-svn-absturz.txt
</span><span class='line'><span class="nv">r82</span> <span class="o">=</span> 610e72f25af787a95e3d2bc6c243bcdef720c40d <span class="o">(</span>refs/remotes/trunk<span class="o">)</span>
</span><span class='line'>No changes between b984d2a7c45c9b7e94fe5edc3b765b84a3b2ed7d and refs/remotes/trunk
</span><span class='line'>Resetting to the latest refs/remotes/trunk
</span><span class='line'>error: git-svn died of signal 11
</span></code></pre></td></tr></table></div></figure>


<p>Der Fehler ist erneut aufgetreten. Der Ablauf ist auch ungeeignet, weil ich
nicht für jeden Test eine neue Datei anlegen möchte.</p>

<figure class='code'><figcaption><span>Einfache Reproduktion des Problems </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>~/git/sandbox<span class="nv">$ </span>date &gt;&gt;git-svn-absturz.txt
</span><span class='line'>~/git/sandbox<span class="nv">$ </span>git commit -m <span class="s2">&quot;Aktualisiert: git-svn-absturz.txt&quot;</span> .
</span><span class='line'><span class="o">[</span>master 10629a2<span class="o">]</span> Aktualisiert: git-svn-absturz.txt
</span><span class='line'> 1 file changed, 1 insertion<span class="o">(</span>+<span class="o">)</span>
</span><span class='line'>~/git/sandbox<span class="nv">$ </span>git svn dcommit
</span><span class='line'>Committing to https://83.236.132.107/svn/sandbox/trunk ...
</span><span class='line'>  M   git-svn-absturz.txt
</span><span class='line'>Committed r83
</span><span class='line'>  M   git-svn-absturz.txt
</span><span class='line'><span class="nv">r83</span> <span class="o">=</span> 5260be6684059d7b8416c011dfa644d837f317a9 <span class="o">(</span>refs/remotes/trunk<span class="o">)</span>
</span><span class='line'>No changes between 10629a268ed877ba48fa2a70ed387b04bacd18cb and refs/remotes/trunk
</span><span class='line'>Resetting to the latest refs/remotes/trunk
</span><span class='line'>error: git-svn died of signal 11
</span></code></pre></td></tr></table></div></figure>


<p>Der Fehler ist erneut aufgetreten. Der Ablauf ist schnell wiederholt
durchführbar.</p>

<p>Hier nochmal die abzusetzenden Befehle ohne Ausgaben zur einfachen
Wiederholung mit &ldquo;Ausschneiden und Einfügen&rdquo;:</p>

<figure class='code'><figcaption><span>Einfache Reproduktion - abzusetzende Befehle </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>date &gt;&gt;git-svn-absturz.txt
</span><span class='line'>git commit -m <span class="s2">&quot;Aktualisiert: git-svn-absturz.txt&quot;</span> .
</span><span class='line'>git svn dcommit
</span></code></pre></td></tr></table></div></figure>


<h2>Analyse</h2>

<h3>strace</h3>

<figure class='code'><figcaption><span>Reproduktion mit &#8216;strace&#8217; </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>date &gt;&gt;git-svn-absturz.txt
</span><span class='line'>git commit -m <span class="s2">&quot;Aktualisiert: git-svn-absturz.txt&quot;</span> .
</span><span class='line'>strace git svn dcommit
</span></code></pre></td></tr></table></div></figure>


<p>Diese Ausgaben werden geliefert:</p>

<figure class='code'><figcaption><span>Ausgabe von &#8216;strace git svn&#8217; </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>...
</span><span class='line'>  M   git-svn-absturz.txt
</span><span class='line'>Committed r84
</span><span class='line'>  M   git-svn-absturz.txt
</span><span class='line'><span class="nv">r84</span> <span class="o">=</span> af8102dc59c40c47b56a404b5ceffa7c5892bc06 <span class="o">(</span>refs/remotes/trunk<span class="o">)</span>
</span><span class='line'>No changes between 191f43c2a02d86825f946de62f6fd8f56b5aa74b and refs/remotes/trunk
</span><span class='line'>Resetting to the latest refs/remotes/trunk
</span><span class='line'><span class="o">[{</span>WIFSIGNALED<span class="o">(</span>s<span class="o">)</span> <span class="o">&amp;&amp;</span> WTERMSIG<span class="o">(</span>s<span class="o">)</span> <span class="o">==</span> SIGSEGV <span class="o">&amp;&amp;</span> WCOREDUMP<span class="o">(</span>s<span class="o">)}]</span>, 0, NULL<span class="o">)</span> <span class="o">=</span> 14979
</span><span class='line'>--- SIGCHLD <span class="o">(</span>Child exited<span class="o">)</span> @ 0 <span class="o">(</span>0<span class="o">)</span> ---
</span><span class='line'>write<span class="o">(</span>2, <span class="s2">&quot;error: git-svn died of signal 11&quot;</span>..., 33error: git-svn died of signal 11
</span><span class='line'><span class="o">)</span> <span class="o">=</span> 33
</span><span class='line'>exit_group<span class="o">(</span>139<span class="o">)</span>                         <span class="o">=</span> ?
</span></code></pre></td></tr></table></div></figure>


<p>Dieser Trace hat wenig Aussagekraft, weil einfach nur ein Unterprozess
anstürzt. Nun könnte man den Test nochmals laufen lassen mit &lsquo;strace -F&rsquo;
oder wir füttern &lsquo;strace&rsquo; direkt mit &lsquo;git-svn&rsquo;:</p>

<figure class='code'><figcaption><span>Reproduktion mit &#8216;strace&#8217; und &#8216;git-svn&#8217; </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>date &gt;&gt;git-svn-absturz.txt
</span><span class='line'>git commit -m <span class="s2">&quot;Aktualisiert: git-svn-absturz.txt&quot;</span> .
</span><span class='line'>strace /usr/lib/git-core/git-svn dcommit
</span></code></pre></td></tr></table></div></figure>


<p>Dies führt zu folgender Ausgabe:</p>

<figure class='code'><figcaption><span>Ausgabe von &#8216;strace git-svn&#8217; </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>execve<span class="o">(</span><span class="s2">&quot;/usr/lib/git-core/git-svn&quot;</span>, <span class="o">[</span><span class="s2">&quot;/usr/lib/git-core/git-svn&quot;</span>, <span class="s2">&quot;dcommit&quot;</span><span class="o">]</span>, <span class="o">[</span>/* 59 vars */<span class="o">])</span> <span class="o">=</span> 0
</span><span class='line'>brk<span class="o">(</span>0<span class="o">)</span>                                  <span class="o">=</span> 0x25fd000
</span><span class='line'>access<span class="o">(</span><span class="s2">&quot;/etc/ld.so.nohwcap&quot;</span>, F_OK<span class="o">)</span>      <span class="o">=</span> -1 ENOENT <span class="o">(</span>No such file or directory<span class="o">)</span>
</span><span class='line'>...
</span><span class='line'>chmod<span class="o">(</span><span class="s2">&quot;.git/Git_zUlsP8&quot;</span>, 0600<span class="o">)</span>          <span class="o">=</span> 0
</span><span class='line'>unlink<span class="o">(</span><span class="s2">&quot;.git/Git_zUlsP8&quot;</span><span class="o">)</span>               <span class="o">=</span> 0
</span><span class='line'>close<span class="o">(</span>14<span class="o">)</span>                               <span class="o">=</span> 0
</span><span class='line'>close<span class="o">(</span>4294967295<span class="o">)</span>                       <span class="o">=</span> -1 EBADF <span class="o">(</span>Bad file descriptor<span class="o">)</span>
</span><span class='line'>close<span class="o">(</span>13<span class="o">)</span>                               <span class="o">=</span> 0
</span><span class='line'>munmap<span class="o">(</span>0x7f03f9fc3000, 2113912<span class="o">)</span>         <span class="o">=</span> 0
</span><span class='line'>munmap<span class="o">(</span>0x7f03fb641000, 2105608<span class="o">)</span>         <span class="o">=</span> 0
</span><span class='line'>...
</span><span class='line'>munmap<span class="o">(</span>0x7f0402cd6000, 8192<span class="o">)</span>            <span class="o">=</span> 0
</span><span class='line'>munmap<span class="o">(</span>0x7f0402cf3000, 8192<span class="o">)</span>            <span class="o">=</span> 0
</span><span class='line'>munmap<span class="o">(</span>0x7f0402d03000, 8192<span class="o">)</span>            <span class="o">=</span> 0
</span><span class='line'>munmap<span class="o">(</span>0x7f0402cef000, 8192<span class="o">)</span>            <span class="o">=</span> 0
</span><span class='line'>--- SIGSEGV <span class="o">(</span>Segmentation fault<span class="o">)</span> @ 0 <span class="o">(</span>0<span class="o">)</span> ---
</span><span class='line'>+++ killed by SIGSEGV <span class="o">(</span>core dumped<span class="o">)</span> +++
</span></code></pre></td></tr></table></div></figure>


<h3>Devel:Trace</h3>

<h4>Perl-Modul Devel::Trace installieren</h4>

<p><code>sudo apt-get install libdevel-trace-perl</code></p>

<h4>Test</h4>

<figure class='code'><figcaption><span>Reproduktion mit &#8216;Devel::Trace&#8217; und &#8216;git-svn&#8217; </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>date &gt;&gt;git-svn-absturz.txt
</span><span class='line'>git commit -m <span class="s2">&quot;Aktualisiert: git-svn-absturz.txt&quot;</span> .
</span><span class='line'>perl -d::Trace -f /usr/lib/git-core/git-svn dcommit
</span></code></pre></td></tr></table></div></figure>


<p>Dabei wird diese Ausgabe geliefert:</p>

<figure class='code'><figcaption><span>Ausgabe mit &#8216;Devel::Trace&#8217; </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>...
</span><span class='line'>&gt;&gt; /usr/share/perl5/Git/SVN.pm:1659:    unmemoize_svn_mergeinfo_functions<span class="o">()</span>;
</span><span class='line'>&gt;&gt; /usr/share/perl5/Git/SVN.pm:1626:        <span class="k">return if </span>not <span class="nv">$memoized</span>;
</span><span class='line'>&gt;&gt; /usr/share/perl5/Git/SVN.pm:85:  unlink keys %LOCKFILES <span class="k">if</span> %LOCKFILES;
</span><span class='line'>&gt;&gt; /usr/share/perl5/Git/SVN.pm:86:  unlink keys %INDEX_FILES <span class="k">if</span> %INDEX_FILES;
</span><span class='line'>&gt;&gt; /usr/lib/perl5/SVN/Core.pm:390:     <span class="nv">$globaldestroy</span> <span class="o">=</span> 1;
</span><span class='line'>&gt;&gt; /usr/lib/perl5/SVN/Core.pm:58:     SVN::_Core::apr_terminate<span class="o">()</span>;
</span><span class='line'>Speicherzugriffsfehler <span class="o">(</span>Speicherabzug geschrieben<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Richtig &ldquo;weiter&rdquo; kommen wir damit nicht &ndash; &ldquo;apr_terminate()&rdquo; ist
eine C-Funktion, die per SWIG in Perl eingebunden ist.</p>

<h2>Korrekturversuche</h2>

<h3>Neueste Version von serf-1.2.1</h3>

<figure class='code'><figcaption><span>Patch erzeugen </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>git svn clone --stdlayout http://serf.googlecode.com/svn
</span><span class='line'>...
</span><span class='line'><span class="nv">r2111</span> <span class="o">=</span> 6e0d690806e4796d2d698e5fd6a33b91832b9fd3 <span class="o">(</span>refs/remotes/trunk<span class="o">)</span>
</span><span class='line'>  M   auth/auth_spnego.c
</span><span class='line'>  M   outgoing.c
</span><span class='line'><span class="nv">r2112</span> <span class="o">=</span> 40194aec74ce32ba844aafc0a5dbdda334f2abfb <span class="o">(</span>refs/remotes/trunk<span class="o">)</span>
</span><span class='line'>Checked out HEAD:
</span><span class='line'>  http://serf.googlecode.com/svn/trunk r2112
</span><span class='line'><span class="nv">$ </span>mv svn serf
</span><span class='line'><span class="nv">$ </span><span class="nb">cd </span>serf
</span><span class='line'><span class="nv">$ </span>git diff remotes/tags/1.2.1 remotes/1.2.x &gt;serf-1.2.1-r2112.patch
</span></code></pre></td></tr></table></div></figure>


<p>Den dabei erzeugten Patch habe ich in die Patch-Serie von
SERF aufgenommen und ein neues SERF-Paket erzeugt und dieses
dann installiert mit</p>

<ul>
<li><code>sudo dpkg -i libserf1_1.2.1-0dp04~precise1_amd64.deb</code></li>
</ul>


<p>Ein Nachtest ergibt: Keine Besserung.</p>

<h3>Neueste Version von apr-1.4.8</h3>

<p>Der übliche Ablauf mittels</p>

<pre><code>* `uupdate -u ../apr-1.4.8.tar.gz`
* `cd ../apr-1.4.8`
* `dpkg-buildpackage`
</code></pre>

<p>funktioniert nicht &ndash; es werden viele fehlende Funktionen angemeckert von
<code>dh_makeshlibs</code>/<code>dpkg-gensymbols</code>:</p>

<figure class='code'><figcaption><span>Fehlende Funktionen </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>+#MISSING: 1.4.8-0dp01~precise1# apr__SHA384_Data@Base 1.2.7
</span><span class='line'>+#MISSING: 1.4.8-0dp01~precise1# apr__SHA384_End@Base 1.2.7
</span><span class='line'>+#MISSING: 1.4.8-0dp01~precise1# apr__SHA384_Final@Base 1.2.7
</span><span class='line'>+#MISSING: 1.4.8-0dp01~precise1# apr__SHA384_Init@Base 1.2.7
</span><span class='line'>+#MISSING: 1.4.8-0dp01~precise1# apr__SHA384_Update@Base 1.2.7
</span><span class='line'>+#MISSING: 1.4.8-0dp01~precise1# apr__SHA512_Data@Base 1.2.7
</span><span class='line'>+#MISSING: 1.4.8-0dp01~precise1# apr__SHA512_End@Base 1.2.7
</span><span class='line'>+#MISSING: 1.4.8-0dp01~precise1# apr__SHA512_Final@Base 1.2.7
</span><span class='line'>+#MISSING: 1.4.8-0dp01~precise1# apr__SHA512_Init@Base 1.2.7
</span><span class='line'>+#MISSING: 1.4.8-0dp01~precise1# apr__SHA512_Last@Base 1.2.7
</span><span class='line'>+#MISSING: 1.4.8-0dp01~precise1# apr__SHA512_Transform@Base 1.2.7
</span><span class='line'>+#MISSING: 1.4.8-0dp01~precise1# apr__SHA512_Update@Base 1.2.7</span></code></pre></td></tr></table></div></figure>


<p>Nach Anpassung von &hellip;/debian/symbols.common funktioniert&rsquo;s. Klar, die neue
Version ist nicht so richtig kompatibel zur alten Version. Muß ich im
Hinterkopf behalten.</p>

<p>Ein Nachtest ergibt: Keine Besserung, <code>git-svn</code> stürzt noch immer ab.
Also: Wieder die alte Version installieren: <code>sudo apt-get install libapr1=1.4.6\*</code>.</p>

<h3>Neueste Version von aprutil-1.5.2</h3>

<p>Auf <a href="http://www.linuxfromscratch.org/blfs/view/svn/general/subversion.html">LinuxFromScratch</a> gibt es einen Hinweis zur Verwendung der neuesten Version von aprutil.</p>

<ul>
<li>Alt:  1.3.12+dfsg-3</li>
<li>Neu:  1.5.2-1</li>
</ul>


<p>Paket erzeugt und installiert gefolgt vom Nachtest ergibt: Keine Besserung.
Also: Wieder die alte Version installieren: <code>sudo apt-get install libaprutil1=1.3.12*</code></p>

<h3>Test mit Subversion-1.8.3</h3>

<p>Wenn statt Subversion-1.8.1 die Version 1.8.3 verwendet wird, so tritt das Problem nach wie vor auf!
Die Version 1.8.3 bringt also keine Verbesserung.</p>

<h3>Test mit Git-1.8.4</h3>

<p>Wenn statt Git-1.8.3 die Version 1.8.4 verwendet wird, so tritt das Problem nach wie vor auf!
Die Version 1.8.4 bringt also keine Verbesserung.</p>

<h3>Anpassungen an /usr/share/perl5/Git/SVN/Ra.pm</h3>

<p>Unter diesem Link <a href="http://git.661346.n2.nabble.com/git-svn-fetch-segfault-on-exit-td7592205.html">http://git.661346.n2.nabble.com/git-svn-fetch-segfault-on-exit-td7592205.html</a>
gibt es einen Korrekturvorschlag:</p>

<figure class='code'><figcaption><span>Anpassungen an ./usr/share/perl5/Git/SVN/Ra.pm </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gd">--- /usr/share/perl5/Git/SVN/Ra.pm~ 2013-07-22 20:59:55.000000000 +0200</span>
</span><span class='line'><span class="gi">+++ /usr/share/perl5/Git/SVN/Ra.pm   2013-09-01 14:53:58.353718366 +0200</span>
</span><span class='line'><span class="gu">@@ -108,7 +108,7 @@</span>
</span><span class='line'>                        config =&gt; $config,
</span><span class='line'>                pool =&gt; SVN::Pool-&gt;new,
</span><span class='line'>                        auth_provider_callbacks =&gt; $callbacks);
</span><span class='line'><span class="gd">-    $RA = bless $self, $class;</span>
</span><span class='line'><span class="gi">+    $self = bless $self, $class;</span>
</span><span class='line'>
</span><span class='line'>  # Make sure its canonicalized
</span><span class='line'>  $self-&gt;url($url);
</span><span class='line'><span class="gu">@@ -118,7 +118,7 @@</span>
</span><span class='line'>  $self-&gt;{cache} = { check_path =&gt; { r =&gt; 0, data =&gt; {} },
</span><span class='line'>                     get_dir =&gt; { r =&gt; 0, data =&gt; {} } };
</span><span class='line'>
</span><span class='line'><span class="gd">-    return $RA;</span>
</span><span class='line'><span class="gi">+    return $self;</span>
</span><span class='line'> }
</span><span class='line'>
</span><span class='line'> sub url {
</span></code></pre></td></tr></table></div></figure>


<p>Mit diesen Änderungen tritt der Fehler nicht mehr auf. Sie deaktivieren
die Verwendung der lokalen Variablen <code>$RA</code>, diese bleibt damit immer auf dem
Wert <code>undef</code>.</p>

<h3>Korrektur von /usr/share/perl5/Git/SVN/Ra.pm</h3>

<p>Nähere Analysen ergeben, dass der Destruktor von <code>$RA</code> nicht aufgerufen
wird. Dadurch gibt es dann einen Absturz bei <code>apr_terminate()</code>. Mit
nachfolgender Änderung wird der Destruktor aufgerufen, bevor
<code>apr_terminate()</code> ausgeführt wird.</p>

<figure class='code'><figcaption><span>Korrektur von ./usr/share/perl5/Git/SVN/Ra.pm </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gd">--- git-1.8.4.orig/perl/Git/SVN/Ra.pm   2013-09-01 14:30:23.629989557 +0000</span>
</span><span class='line'><span class="gi">+++ git-1.8.4/perl/Git/SVN/Ra.pm        2013-09-02 06:55:19.666260617 +0000</span>
</span><span class='line'><span class="gu">@@ -32,6 +32,10 @@</span>
</span><span class='line'>        }
</span><span class='line'> }
</span><span class='line'>
</span><span class='line'><span class="gi">+END {</span>
</span><span class='line'><span class="gi">+  $RA = undef;</span>
</span><span class='line'><span class="gi">+}</span>
</span><span class='line'><span class="gi">+</span>
</span><span class='line'> sub _auth_providers () {
</span><span class='line'>        my @rv = (
</span><span class='line'>          SVN::Client::get_simple_provider(),
</span></code></pre></td></tr></table></div></figure>


<p>Die oben aufgeführte Korrektur habe ich auch an die Git-Mailing-Liste
geschickt.</p>

<h2>Korrektur</h2>

<p>Mit meinen neuesten Paketen tritt das Problem nicht mehr auf:</p>

<ul>
<li>subversion-1.8.3 (&hellip; oder neuer)</li>
<li>git-1.8.4-0dp10 (&hellip; oder neuer)</li>
</ul>


<h2>Änderungen</h2>

<ul>
<li>2013-08-15: Test mit aprutil-1.5.2</li>
<li>2013-09-01: Subversion-1.8.3, Git-1.8.4, Anpassungen an /usr/share/perl5/Git/SVN/Ra.pm, Korrektur</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Octopress und Git ohne Umbenennung]]></title>
    <link href="http://uli-heller.github.com/blog/2013/08/05/octopress-git/"/>
    <updated>2013-08-05T08:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/08/05/octopress-git</id>
    <content type="html"><![CDATA[<p>Octopress hat die Eigenart, bei Verwendung von Git als &ldquo;Deployment-Methode&rdquo;
die Zweige umzubenennen:</p>

<ul>
<li>Umbenennung: origin &ndash;> octopress</li>
<li>Neuanlage:   origin &lt;&ndash; repo_url</li>
<li>Umbenennung: master &ndash;> source</li>
<li>etc.</li>
</ul>


<p>Die ganze Umbenennerei gefällt mir garnicht. Ich mag&rsquo;s so:</p>

<ul>
<li>uli-octopress: Das ist mein &ldquo;normales&rdquo; GitHub-Repository, in dem ich alle
Quelltexte meiner Octopress-Installation halte</li>
<li>uli-heller.github.com: Das ist das GitHub-Repository, in dem ich die
generierten HTML-Seiten veröffentliche</li>
</ul>


<!-- more -->


<h2>uli-octopress</h2>

<p>Hierbei gibt es keine Besonderheiten. Einfach das Repository in GitHub
anlegen und klonen wie üblich.</p>

<h2>uli-heller.github.com</h2>

<p>Am besten erstmal einfach leer anlegen mit einem Branch namens &ldquo;master&rdquo;.</p>

<h2>Deployment-Methode konfigurieren</h2>

<h3>_deploy</h3>

<p>Das Verzeichnis &ldquo;_deploy&rdquo; wird angelegt durch <code>git clone ...</code> und
anschließendes Umbenennen mit <code>mv ...</code>.</p>

<figure class='code'><figcaption><span>Anlegen des Verzeichnisses _deploy </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span><span class="nb">cd </span>uli-octopress
</span><span class='line'>
</span><span class='line'>uli-octopress<span class="nv">$ </span>git clone git@github.com:uli-heller/uli-heller.github.com.git
</span><span class='line'>Klone nach <span class="s1">&#39;uli-heller.github.com&#39;</span>...
</span><span class='line'>remote: Counting objects: 14438, <span class="k">done</span>.
</span><span class='line'>remote: Compressing objects: 100% <span class="o">(</span>3999/3999<span class="o">)</span>, <span class="k">done</span>.
</span><span class='line'>remote: Total 14438 <span class="o">(</span>delta 7274<span class="o">)</span>, reused 13662 <span class="o">(</span>delta 6502<span class="o">)</span>
</span><span class='line'>Empfange Objekte: 100% <span class="o">(</span>14438/14438<span class="o">)</span>, 16.14 MiB | 218.00 KiB/s, <span class="k">done</span>.
</span><span class='line'>Löse Unterschiede auf: 100% <span class="o">(</span>7274/7274<span class="o">)</span>, <span class="k">done</span>.
</span><span class='line'>Checking connectivity... <span class="k">done</span>
</span><span class='line'>
</span><span class='line'>uli-octopress<span class="nv">$ </span>mv uli-heller.github.com _deploy
</span></code></pre></td></tr></table></div></figure>


<h3>Rakefile</h3>

<p>Nun noch Anpassungen an Rakefile:</p>

<figure class='code'><figcaption><span>Anpassungen am Rakefile </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gh">diff --git a/Rakefile b/Rakefile</span>
</span><span class='line'><span class="gh">index f3ada93..321c3c5 100644</span>
</span><span class='line'><span class="gd">--- a/Rakefile</span>
</span><span class='line'><span class="gi">+++ b/Rakefile</span>
</span><span class='line'><span class="gu">@@ -9,10 +9,10 @@ ssh_port       = &quot;22&quot;</span>
</span><span class='line'> document_root  = &quot;~/website.com/&quot;
</span><span class='line'> rsync_delete   = false
</span><span class='line'> rsync_args     = &quot;&quot;  # Any extra arguments to pass to rsync
</span><span class='line'><span class="gd">-deploy_default = &quot;rsync&quot;</span>
</span><span class='line'><span class="gi">+deploy_default = &quot;push&quot;</span>
</span><span class='line'>
</span><span class='line'> # This will be configured for you when you run config_deploy
</span><span class='line'><span class="gd">-deploy_branch  = &quot;gh-pages&quot;</span>
</span><span class='line'><span class="gi">+deploy_branch  = &quot;master&quot;</span>
</span><span class='line'>
</span><span class='line'> ## -- Misc Configs -- ##
</span></code></pre></td></tr></table></div></figure>


<h2>Test</h2>

<figure class='code'><figcaption><span>Test </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>uli-octopress<span class="nv">$ </span>rake generate
</span><span class='line'><span class="c">## Generating Site with Jekyll</span>
</span><span class='line'>identical <span class="nb">source</span>/stylesheets/screen.css
</span><span class='line'>Configuration from /home/uli/git/octopress/_config.yml
</span><span class='line'>Building site: <span class="nb">source</span> -&gt; public
</span><span class='line'>...
</span><span class='line'>Successfully generated site: <span class="nb">source</span> -&gt; public
</span><span class='line'>
</span><span class='line'>uli-octopress<span class="nv">$ </span>rake preview
</span><span class='line'>Starting to watch <span class="nb">source </span>with Jekyll and Compass. Starting Rack on port 4000
</span><span class='line'><span class="o">[</span>2013-08-05 07:55:34<span class="o">]</span> INFO  WEBrick 1.3.1
</span><span class='line'>...
</span><span class='line'>
</span><span class='line'>uli-octopress<span class="nv">$ </span>rake deploy
</span><span class='line'><span class="c">## Generating Site with Jekyll</span>
</span><span class='line'>identical <span class="nb">source</span>/stylesheets/screen.css
</span><span class='line'>Configuration from /home/uli/git/octopress/_config.yml
</span><span class='line'>Building site: <span class="nb">source</span> -&gt; public
</span><span class='line'>...
</span><span class='line'><span class="c">## Pushing generated _deploy website</span>
</span><span class='line'>Counting objects: 710, <span class="k">done</span>.
</span><span class='line'>Delta compression using up to 4 threads.
</span><span class='line'>Compressing objects: 100% <span class="o">(</span>275/275<span class="o">)</span>, <span class="k">done</span>.
</span><span class='line'>Writing objects: 100% <span class="o">(</span>382/382<span class="o">)</span>, 95.23 KiB | 0 bytes/s, <span class="k">done</span>.
</span><span class='line'>Total 382 <span class="o">(</span>delta 194<span class="o">)</span>, reused 0 <span class="o">(</span>delta 0<span class="o">)</span>
</span><span class='line'>To git@github.com:uli-heller/uli-heller.github.com.git
</span><span class='line'>   4d99436..e7770a8  master -&gt; master
</span><span class='line'>
</span><span class='line'><span class="c">## Github Pages deploy complete</span>
</span><span class='line'><span class="nb">cd</span> -
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Octopress-Fehler: Liquid Exception: undefined method `sort!' for nil:NilClass in post]]></title>
    <link href="http://uli-heller.github.com/blog/2013/08/04/octopress-category-generator/"/>
    <updated>2013-08-04T19:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/08/04/octopress-category-generator</id>
    <content type="html"><![CDATA[<p>Beim Ausführen von <code>rake generate</code> erscheint die Fehlermeldung:</p>

<pre><code>Liquid Exception: undefined method `sort!' for nil:NilClass in post
.../octopress/plugins/category_generator.rb:157:in `category_links'
</code></pre>

<!-- more -->


<p>Die Korrektur erfolgt bspw. durch diese Änderung:</p>

<figure class='code'><figcaption><span>Änderung an ../pligins/category_generator.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gh">diff --git a/plugins/category_generator.rb b/plugins/category_generator.rb</span>
</span><span class='line'><span class="gh">index a49c429..63dbf97 100644</span>
</span><span class='line'><span class="gd">--- a/plugins/category_generator.rb</span>
</span><span class='line'><span class="gi">+++ b/plugins/category_generator.rb</span>
</span><span class='line'><span class="gu">@@ -153,6 +153,7 @@ ERR</span>
</span><span class='line'>     # Returns string
</span><span class='line'>     #
</span><span class='line'>     def category_links(categories)
</span><span class='line'><span class="gi">+     if categories != nil</span>
</span><span class='line'>       categories = categories.sort!.map { |c| category_link c }
</span><span class='line'>
</span><span class='line'>       case categories.length
</span><span class='line'><span class="gu">@@ -163,6 +164,7 @@ ERR</span>
</span><span class='line'>       else
</span><span class='line'>         &quot;#{categories[0...-1].join(&#39;, &#39;)}, #{categories[-1]}&quot;
</span><span class='line'>       end
</span><span class='line'><span class="gi">+     end</span>
</span><span class='line'>     end
</span><span class='line'>
</span><span class='line'>     # Outputs a single category as an &lt;a&gt; link.
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Fotogallerie Südtirol und Tripsdrill]]></title>
    <link href="http://uli-heller.github.com/blog/2013/08/04/fotogallerie/"/>
    <updated>2013-08-04T11:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/08/04/fotogallerie</id>
    <content type="html"><![CDATA[<p>Test einer Fotogallerie &ndash; Bilder aus Südtirol und Tripsdrill.</p>

<!-- more -->




<script src="http://uli-heller.github.com/javascripts/fotorama/jquery-1.10.2.min.js"></script>


<p><link href="http://uli-heller.github.com/javascripts/fotorama/fotorama.css" rel="stylesheet"><script src="http://uli-heller.github.com/javascripts/fotorama/fotorama.js"></script><div class="fotorama" data-autoplay="3000" data-transition="dissolve" data-nav="thumbs" data-allow-full-screen="true" data-keyboard="true" data-width="640" data-height="480" data-thumb-with="64" data-thumb-height="48"><a href="http://uli-heller.github.com/images/galleries/test/scaled/mammut.jpg" data-full="/images/galleries/test/mammut.jpg" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/test/thumbs/mammut.jpg" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/test/scaled/neustift-2.jpg" data-full="/images/galleries/test/neustift-2.jpg" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/test/thumbs/neustift-2.jpg" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/test/scaled/neustift.jpg" data-full="/images/galleries/test/neustift.jpg" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/test/thumbs/neustift.jpg" data-fit="scaledown"/></a></div> <!--class="fotorama" data-nav="thumbs" --></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Fotogallerie für Octopress]]></title>
    <link href="http://uli-heller.github.com/blog/2013/08/04/gallery/"/>
    <updated>2013-08-04T10:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/08/04/gallery</id>
    <content type="html"><![CDATA[<p>Zur Illustration der CentOS-Installation benötige ich eine Fotogallerie in
meiner Octopress-Installation. In diesem Artikel beschreibe ich das
Vorgehen.</p>

<!-- more -->


<h2>Neues Plugin: octopress-gallery</h2>

<p>Ich verwende das Plugin <a href="https://github.com/yortz/octopress_gallery">Octopress-Gallery</a>
zur Anzeige der Fotogallerie.</p>

<h3>Vorbereitungen</h3>

<p>Pfad zur Octopress-Installation: <code>OP=/home/UliHeller/octopress</code></p>

<h3>Grundinstallation</h3>

<ul>
<li>Auschecken: <code>git clone https://github.com/yortz/octopress_gallery.git</code></li>
<li>Kopieren

<ul>
<li><code>cp octopress_gallery/plugins/gallery_tag.rb "${OP}/plugins/."</code></li>
<li><code>cp octopress_gallery/plugins/mini_magick.rb "${OP}/plugins/."</code></li>
</ul>
</li>
<li>Erweitern von &ldquo;${OP}/Gemfile&rdquo;: Neue Zeile <code>gem 'mini_magick'</code></li>
<li>Installieren der Zusatz-Gems: <code>cd "${OP}"; bundle install</code></li>
</ul>


<h3>Bilder ablegen</h3>

<ul>
<li><code>mkdir "${OP}/sources/images/galleries"</code></li>
<li><code>mkdir "${OP}/sources/images/galleries/test"</code></li>
<li><code>cp *.jpg "${OP}/sources/images/galleries/test"</code></li>
</ul>


<h3>Gallerie konfigurieren</h3>

<h4>_config.yml</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mini_magick:
</span><span class='line'>    test_thumbnail:
</span><span class='line'>      source: images/galleries/test
</span><span class='line'>      destination: images/galleries/test/thumbs
</span><span class='line'>      commands:
</span><span class='line'>        - thumbnail: "64x48^"
</span><span class='line'>        - crop: "64x48-0x0"</span></code></pre></td></tr></table></div></figure>


<h4>Gallerie in Artikel &ldquo;anziehen&rdquo;</h4>

<p>Diese Zeile muß in einem Artikel auftauchen:</p>

<pre>
{{ 'test' | image_list }}
</pre>


<h2>Hübschere Präsentation mit Fotorama</h2>

<p>Die Präsentation der Gallerie ist in der Grundversion sehr schlicht.
Durch die Verwendung von <a href="http://fotorama.io/">Fotorama</a> wird das deutlich
hübscher.</p>

<h3>JQuery und Fotorama runterladen und ablegen</h3>

<ul>
<li><code>mkdir ${OP}/source/javascripts/fotorama</code></li>
<li><code>wget http://code.jquery.com/jquery-1.10.2.min.js</code></li>
<li><code>mv jquery-1.10.2.min.js ${OP}/source/javascripts/fotorama/.</code></li>
</ul>


<h3>Fotorama runterladen und ablegen</h3>

<ul>
<li><code>wget http://fotorama.s3.amazonaws.com/4.2.3/fotorama-4.2.3.zip</code></li>
<li><code>mv fotorama-4.2.3.zip fotorama-4.2.3.zip.gz</code></li>
<li><code>gzip -d fotorama-4.2.3.zip.gz</code></li>
<li><code>unzip -d tmp fotorama-4.2.3.zip</code></li>
<li><code>mv tmp/fotorama-4.2.3/foto* ${OP}/source/javascripts/fotorama/.</code></li>
<li><code>rm -rf tmp</code></li>
</ul>


<h3>Anpassungen an plugins/gallery_tag.rb</h3>

<figure class='code'><figcaption><span>Anpassungen an plugins/gallery_tag.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gh">diff --git a/plugins/gallery_tag.rb b/plugins/gallery_tag.rb</span>
</span><span class='line'><span class="gh">index 6dc0c14..b2d8037 100644</span>
</span><span class='line'><span class="gd">--- a/plugins/gallery_tag.rb</span>
</span><span class='line'><span class="gi">+++ b/plugins/gallery_tag.rb</span>
</span><span class='line'><span class="gu">@@ -4,14 +4,20 @@ module ImageList</span>
</span><span class='line'>   def image_list( name )
</span><span class='line'>    unless name == nil
</span><span class='line'>     list = Array.new
</span><span class='line'><span class="gi">+    list &lt;&lt; %Q{&lt;script src=&quot;/javascripts/fotorama/jquery-1.10.2.min.js&quot;&gt;&lt;/script&gt;}</span>
</span><span class='line'><span class="gi">+    list &lt;&lt; %Q{&lt;link href=&quot;/javascripts/fotorama/fotorama.css&quot; rel=&quot;stylesheet&quot;&gt;}</span>
</span><span class='line'><span class="gi">+    list &lt;&lt; %Q{&lt;script src=&quot;/javascripts/fotorama/fotorama.js&quot;&gt;&lt;/script&gt;}</span>
</span><span class='line'><span class="gi">+    list &lt;&lt; %Q{&lt;div class=&quot;fotorama&quot; data-autoplay=&quot;3000&quot; data-transition=&quot;dissolve&quot; data-nav=&quot;thumbs&quot; data-allow-full-screen=&quot;true&quot; data-keyboard=&quot;true&quot; data-w</span>
</span><span class='line'>     dir = Dir.new( File.join(BASE_DIR, name) )
</span><span class='line'><span class="gd">-    dir.each do | d |</span>
</span><span class='line'><span class="gi">+    dir.sort.each do | d |</span>
</span><span class='line'>       image = File.basename(d, File.extname(d))
</span><span class='line'>       unless d =~ /^\./ || d =~ /thumbs/
</span><span class='line'><span class="gd">-        list &lt;&lt; %Q{&lt;a href=&quot;/images/galleries/#{name}/#{d}&quot; rel=&quot;shadowbox&quot; title=&quot;#{image}&quot;&gt;&lt;img src=&quot;/images/galleries/#{name}/thumbs/#{d}&quot; /&gt;&lt;/a&gt;}</span>
</span><span class='line'><span class="gi">+#        list &lt;&lt; %Q{&lt;a href=&quot;/images/galleries/#{name}/#{d}&quot; rel=&quot;shadowbox&quot; title=&quot;#{image}&quot;&gt;&lt;img src=&quot;/images/galleries/#{name}/thumbs/#{d}&quot; /&gt;&lt;/a&gt;}</span>
</span><span class='line'><span class="gi">+        list &lt;&lt; %Q{&lt;a href=&quot;/images/galleries/#{name}/#{d}&quot;&gt;&lt;img src=&quot;/images/galleries/#{name}/thumbs/#{d}&quot;/&gt;&lt;/a&gt;}</span>
</span><span class='line'>       end
</span><span class='line'>     end
</span><span class='line'><span class="gd">-    list.sort.join( &quot;\n&quot; )</span>
</span><span class='line'><span class="gi">+    list &lt;&lt; %Q{&lt;/div&gt; &lt;!--class=&quot;fotorama&quot; data-nav=&quot;thumbs&quot; --&gt;}</span>
</span><span class='line'><span class="gi">+#    list.sort.join( &quot;\n&quot; )</span>
</span><span class='line'>    end
</span><span class='line'>   end
</span><span class='line'> end
</span></code></pre></td></tr></table></div></figure>


<h2>Probleme</h2>

<h3>Liquid Exception: no implicit conversion of nil into String in atom.xml</h3>

<p>Die Ausführung von <code>rake generate</code> bricht ab mit einer Fehlermeldung:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rake generate
</span><span class='line'>## Generating Site with Jekyll
</span><span class='line'>unchanged sass/print.scss
</span><span class='line'>identical source/stylesheets/screen.css 
</span><span class='line'>Configuration from .../dp-octopress/_config.yml
</span><span class='line'>Building site: source -> public
</span><span class='line'>Liquid Exception: no implicit conversion of nil into String in atom.xml
</span><span class='line'>.../dp-octopress/plugins/gallery_tag.rb:10:in `join'
</span><span class='line'>.../dp-octopress/plugins/gallery_tag.rb:10:in `image_list'
</span><span class='line'>...</span></code></pre></td></tr></table></div></figure>


<p>Abhilfe: Anpassungen an plugins/gallery_tag.rb vornehmen:</p>

<figure class='code'><figcaption><span>Anpassungen an plugins/gallery_tag.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gh">diff --git a/plugins/gallery_tag.rb b/plugins/gallery_tag.rb</span>
</span><span class='line'><span class="gh">index f895040..6dc0c14 100644</span>
</span><span class='line'><span class="gd">--- a/plugins/gallery_tag.rb</span>
</span><span class='line'><span class="gi">+++ b/plugins/gallery_tag.rb</span>
</span><span class='line'><span class="gu">@@ -2,6 +2,7 @@ BASE_DIR = &#39;source/images/galleries&#39;</span>
</span><span class='line'>
</span><span class='line'> module ImageList
</span><span class='line'>   def image_list( name )
</span><span class='line'><span class="gi">+   unless name == nil</span>
</span><span class='line'>     list = Array.new
</span><span class='line'>     dir = Dir.new( File.join(BASE_DIR, name) )
</span><span class='line'>     dir.each do | d |
</span><span class='line'><span class="gu">@@ -11,6 +12,7 @@ module ImageList</span>
</span><span class='line'>       end
</span><span class='line'>     end
</span><span class='line'>     list.sort.join( &quot;\n&quot; )
</span><span class='line'><span class="gi">+   end</span>
</span><span class='line'>   end
</span><span class='line'> end
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Subversion 1.8.1 für Ubuntu-12.04]]></title>
    <link href="http://uli-heller.github.com/blog/2013/07/27/subversion_1.8.1/"/>
    <updated>2013-07-27T10:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/07/27/subversion_1.8.1</id>
    <content type="html"><![CDATA[<p>Vor ein paar Tagen wurde Subversion-1.8.1 veröffentlicht.
Hier meine Versuche, ein Paket für Ubuntu-12.04 zu bauen.
Eingeflossen sind dabei auch die gescheiterten Versuche
mit Subversion-1.8.0. Schlußendlich kommt eine für mich funktionierende
Version von Subversion-1.8.1 heraus.</p>

<!-- more -->


<h2>Ausgangpunkt: Subversion-1.8.0</h2>

<p>Mein Ausgangspunkt sind meine kaputten Pakete für Subversion-1.8.0.</p>

<pre><code>$ cd subversion-1.8.0
$ uupdate -u ../subversion-1.8.1
$ cd ../subversion-1.8.1
</code></pre>

<p>Nun habe ich folgende Generierungs-Abhängigkeiten (build dependencies)
festgelegt:</p>

<ul>
<li>subversion: serf-1.2.1 und sqlite-3.7.15</li>
<li>serf: sqlite-3.7.15</li>
</ul>


<h2>Erste Hürde: Sqlite3-3.7.15</h2>

<p>Subversion benötigt eine relativ aktuelle Version von Sqlite3. Die
Standard-Version von Ubuntu-12.04 ist zu alt. Ich habe mir so beholfen:</p>

<ul>
<li>Quellpakete von sqlite3-3.7.15.2 aus &ldquo;raring&rdquo; runtergeladen</li>
<li>Ein paar kleine Anpassungen an debian/rules vorgenommen, damit
tcl85 an der richtigen Stelle ausgelesen wird</li>
<li>Pakete erzeugen mit <code>dpkg-buildpackage</code></li>
<li>Pakete installieren</li>
</ul>


<h2>Zweite Hürde: Serf-1.2.1</h2>

<ul>
<li>Diverse Umstellungen nötig, damit die Generierung durchläuft</li>
<li>Pakete erzeugen mit <code>dpkg-buildpackage</code></li>
<li>Pakete installieren</li>
</ul>


<h2>Subversion-1.8.1</h2>

<ul>
<li>Kann nun wie üblich mit <code>dpkg-buildpackage</code> erzeugt werden</li>
</ul>


<h2>Kurztests: Installation und Funktionsweise</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo dpkg -i subversion_1.8.1-3dp12~precise1_amd64.deb libsvn1_1.8.1-3dp12~precise1_amd64.deb libserf1_1.2.1-0dp01~precise1_amd64.deb
</span><span class='line'>$ sudo dpkg -i sqlite3_3.7.15.2-1dp01~precise1_amd64.deb libsqlite3-0_3.7.15.2-1dp01~precise1_amd64.deb
</span><span class='line'>$ svn --version
</span><span class='line'>svn, Version 1.8.1 (r1503906)
</span><span class='line'>   übersetzt am Jul 26 2013, um 15:38:27 auf x86_64-pc-linux-gnu
</span><span class='line'>
</span><span class='line'>Copyright (C) 2013 The Apache Software Foundation.
</span><span class='line'>Diese Software besteht aus Beiträgen vieler Personen;
</span><span class='line'>siehe Datei NOTICE für weitere Informationen.
</span><span class='line'>Subversion ist Open Source Software, siehe http://subversion.apache.org/
</span><span class='line'>
</span><span class='line'>Die folgenden ZugriffsModule (ZM) für Projektarchive stehen zur Verfügung:
</span><span class='line'>
</span><span class='line'>* ra_svn : Modul zum Zugriff auf ein Projektarchiv über das svn-Netzwerkprotokoll.
</span><span class='line'>  - mit Cyrus-SASL-Authentifizierung
</span><span class='line'>  - behandelt Schema »svn«
</span><span class='line'>* ra_local : Modul zum Zugriff auf ein Projektarchiv auf der lokalen Festplatte
</span><span class='line'>  - behandelt Schema »file«
</span><span class='line'>* ra_serf : Modul zum Zugriff auf ein Projektarchiv über das Protokoll WebDAV mittels serf.
</span><span class='line'>  - behandelt Schema »http«
</span><span class='line'>  - behandelt Schema »https«
</span><span class='line'>$ cd svn/my-project
</span><span class='line'>$ svn status
</span><span class='line'>svn: E155036: Please see the 'svn upgrade' command
</span><span class='line'>svn: E155036: The working copy at '/home/uli/svn/my-project'
</span><span class='line'>is too old (format 29) to work with client version '1.8.1 (r1503906)' (expects format 31). You need to upgrade the working copy first.
</span><span class='line'>$ svn upgrade
</span><span class='line'>Upgraded '.'
</span><span class='line'>$ svn status
</span><span class='line'>$ svn update
</span><span class='line'>Updating '.':
</span><span class='line'>A    minianwendungjsf/.classpath
</span><span class='line'>A    minianwendungjsf/ant
</span><span class='line'>A    minianwendungjsf/ant/build.xml
</span><span class='line'>A    minianwendungjsf/.project
</span><span class='line'>...
</span><span class='line'>A    EJB3.1_Test/login.config
</span><span class='line'>Updated to revision 13.
</span><span class='line'>$ svn checkout https://.....
</span><span class='line'>A    my-project2/git-test
</span><span class='line'>A    my-project2/git-test/Hello.txt
</span><span class='line'>A    my-project2/git-test/01-git-neu.txt
</span><span class='line'>...
</span><span class='line'>A    my-project2/testfolder2
</span><span class='line'>A    my-project2/testfolder2/testbin-ticket9.odt
</span><span class='line'>Checked out revision 78.</span></code></pre></td></tr></table></div></figure>


<p>Also: Grobtest ist OK.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LXC: Probleme mit 3.10-er-Kernel -  Das Dateisystem ist nur lesbar]]></title>
    <link href="http://uli-heller.github.com/blog/2013/07/27/lxc-kernel-310/"/>
    <updated>2013-07-27T09:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/07/27/lxc-kernel-310</id>
    <content type="html"><![CDATA[<p>Seit einiger Zeit verwende ich LXC als Ergänzung zu VirtualBox.
Bislang läuft das weitgehend problemlos. Merkwürdigerweise
bekomme ich seit ein paar Tagen immer wieder Fehlermeldungen
bezüglich BTRFS: &ldquo;Das Dateisystem ist nur lesbar&rdquo;.</p>

<p>Erst dachte ich, BTRFS hätte &lsquo;nen Schuß. Detailliertere Tests zeigen,
dass der 3.10-er-Kernel wohl &ldquo;Schuld&rdquo; ist.</p>

<!-- more -->


<h2>Meine LXC-Umgebung</h2>

<ul>
<li>Ubuntu 12.04</li>
<li>3.8-er-Kernel oder auch 3.10-er-Kernel</li>
<li>/dev/mapper/datavg-lxlv ist eingebunden unter /lxc und ist ein
BTRFS-Dateisystem</li>
<li>Alle LXC-Container liegen unter /lxc, also auf einem BTRFS-Dateisystem</li>
</ul>


<h2>Runterfahren eines LXC-Containers unter 3.8</h2>

<p>Beim 3.8-er-Kernel sieht man eine Fehlermeldung bzgl.
meiner BTRFS-Partition: Sie kann <em>nicht</em> umgehängt werden mit
Nur-Lesen-Zugriff.</p>

<figure class='code'><figcaption><span>Runterfahren mit Kernel 3.8 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>~<span class="nv">$ </span>sudo poweroff
</span><span class='line'>...
</span><span class='line'>umount: /run/lock: not mounted
</span><span class='line'>umount: /run/shm: not mounted
</span><span class='line'>mount: cannot mount block device /dev/mapper/datavg-lxclv <span class="nb">read</span>-only
</span><span class='line'> * Will now halt
</span><span class='line'>~<span class="nv">$ </span>sudo touch  /lxc/x
</span><span class='line'>~<span class="nv">$ </span>sudo rm  /lxc/x
</span></code></pre></td></tr></table></div></figure>


<h2>Runterfahren eines LXC-Containers unter 3.10</h2>

<p>Beim 3.10-er-Kernel sieht man keine Fehlermeldung bzgl.
meiner BTRFS-Partition, also kann sie vermutlich umgehängt werden mit
Nur-Lesen-Zugriff. Dementsprechend ist sie danach &ldquo;nur-lesend&rdquo;
eingehängt und der Inhalt von /lxc kann nicht mehr modifiziert
werden.</p>

<figure class='code'><figcaption><span>Runterfahren mit Kernel 3.10 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>~<span class="nv">$ </span>sudo poweroff
</span><span class='line'>...
</span><span class='line'>umount: /run/lock: not mounted
</span><span class='line'>umount: /run/shm: not mounted
</span><span class='line'> * Will now halt
</span><span class='line'>~<span class="nv">$ </span>sudo touch /lxc/x
</span><span class='line'>touch: »/lxc/x“ kann nicht berührt werden: Das Dateisystem ist nur lesbar
</span><span class='line'>~<span class="nv">$ LANG</span><span class="o">=</span>C sudo touch /lxc/x
</span><span class='line'>touch: cannot touch <span class="sb">`</span>/lxc/x<span class="err">&#39;</span>: Read-only file system
</span></code></pre></td></tr></table></div></figure>


<h2>Dateisysteme innerhalb der LXC-Container</h2>

<figure class='code'><figcaption><span>Dateisysteme </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>container~<span class="nv">$ </span>df
</span><span class='line'>Filesystem               1K-blocks     Used Available Use% Mounted on
</span><span class='line'>/dev/mapper/datavg-lxclv  41943040 13871816  26684544  35% /
</span><span class='line'>none                        816864       76    816788   1% /run
</span><span class='line'>none                          5120        0      5120   0% /run/lock
</span><span class='line'>none                       4084308        0   4084308   0% /run/shm
</span></code></pre></td></tr></table></div></figure>


<h2>Korrekturen</h2>

<ul>
<li>Bei Verwendung des 3.10-er-Kernels nach dem Stoppen eines Containers: <code>sudo mount -o remount,rw /dev/mapper/datavg-lxclv</code> ausführen</li>
<li>Immer nur den 3.8-er-Kernel verwenden</li>
<li><p>Innerhalb des Containers /etc/init.d/umountroot &ldquo;abklemmen&rdquo;:</p>

<pre><code>sudo update-rc.d -f umountroot remove
</code></pre>

<p>Leider muß man dies in regelmässigen Abständen wiederholen. Heute habe ich
bspw. im Container <code>apt-get update; apt-get upgrade</code> ausgeführt mit der Folge,
dass /etc/init.d/umountroot wieder aktiviert wurde.</p></li>
</ul>


<h2>Historie</h2>

<ul>
<li>2013-08-13: /etc/init.d/umountroot wird durch <code>apt-get upgrade</code> manchmal wieder aktiviert.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LXC: Probleme bei der Initialisierung des Netzwerkes]]></title>
    <link href="http://uli-heller.github.com/blog/2013/07/26/lxc-networking/"/>
    <updated>2013-07-26T15:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/07/26/lxc-networking</id>
    <content type="html"><![CDATA[<p>Seit einiger Zeit verwende ich LXC als Ergänzung zu VirtualBox.
Bislang läuft das weitgehend problemlos.
Merkwürdigerweise habe einige LXC-Container seit heute ein
Problem beim Start: Es dauert endlos, bis der Login-Prompt erscheint
und das Netzwerk funktioniert nicht. Betroffen sind auch Container,
die früher anstandslos gelaufen sind.</p>

<!-- more -->


<h2>Logs</h2>

<h3>Host: /var/Log/syslog</h3>

<figure class='code'><figcaption><span>Host:/var/log/syslog </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Jul 26 13:12:53 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPDISCOVER(lxcbr0) 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:12:53 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPOFFER(lxcbr0) 10.0.3.14 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:13:13 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPDISCOVER(lxcbr0) 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:13:13 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPOFFER(lxcbr0) 10.0.3.14 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:13:24 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPDISCOVER(lxcbr0) 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:13:24 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPOFFER(lxcbr0) 10.0.3.14 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:13:35 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPDISCOVER(lxcbr0) 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:13:35 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPOFFER(lxcbr0) 10.0.3.14 00:16:3e:84:7a:82 
</span><span class='line'>Jul 26 13:13:53 uli-hp-ssd dnsmasq-dhcp[1571]: DHCPDISCOVER(lxcbr0) 00:16:3e:84:7a:82</span></code></pre></td></tr></table></div></figure>


<h3>Container: /var/log/syslog</h3>

<figure class='code'><figcaption><span>Container:/var/log/syslog </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Jul 26 11:12:53 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 17
</span><span class='line'>Jul 26 11:12:53 localhost dhclient: 5 bad udp checksums in 5 packets
</span><span class='line'>Jul 26 11:13:10 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 14
</span><span class='line'>Jul 26 11:13:24 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 11
</span><span class='line'>Jul 26 11:13:35 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 15
</span><span class='line'>Jul 26 11:13:50 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 11
</span><span class='line'>Jul 26 11:14:01 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 10
</span><span class='line'>Jul 26 11:14:01 localhost dhclient: 5 bad udp checksums in 5 packets
</span><span class='line'>Jul 26 11:14:11 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 15
</span><span class='line'>Jul 26 11:14:26 localhost dhclient: DHCPDISCOVER on eth0 to 255.255.255.255 port</span></code></pre></td></tr></table></div></figure>


<h2>Abhilfe</h2>

<h3>Temporäre Abhilfe</h3>

<p>Abhilfe schafft die Ausführung vom nachfolgenden Befehl auf dem Host:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo iptables -A POSTROUTING -t mangle -p udp --dport bootpc -j CHECKSUM --checksum-fill</span></code></pre></td></tr></table></div></figure>


<p>Die Abhilfe ist hier beschrieben: <a href="https://bugs.launchpad.net/ubuntu/+source/isc-dhcp/+bug/930962/comments/14">https://bugs.launchpad.net/ubuntu/+source/isc-dhcp/+bug/930962/comments/14</a></p>

<h3>Dauerhafte Abhilfe</h3>

<p>Eine dauerhafte Abhilfe schafft die Aktualisierung des Paketes
&ldquo;isc-dhcp-client&rdquo; auf Version 4.1.ESV-R4-0ubuntu5.8 oder neuer.
Das geht ganz normal mit <code>apt-get update; apt-get upgrade</code>.
Ich hatte zuvor 4.1.ESV-R4-0ubuntu5.5 im Container.</p>

<h2>Nachtrag: Ursache</h2>

<p>Das Problem wurde ziemlich sicher verursacht durch den Einsatz von
einem 3.10-er Kernel auf dem Host. Nach dem &ldquo;Runterschalten&rdquo; auf 3.8
laufen die Container auch wieder ohne Aktualisierung von
&ldquo;isc-dhcp-client&rdquo;.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Git Fork]]></title>
    <link href="http://uli-heller.github.com/blog/2013/07/21/git-fork/"/>
    <updated>2013-07-21T09:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/07/21/git-fork</id>
    <content type="html"><![CDATA[<h1>Git Fork</h1>

<p>Hier kurz meine Notizen zum Arbeiten mit GitHub Forks:</p>

<ul>
<li>Bestehendes Projekt &ldquo;forken&rdquo; &ndash;> einfach via GitHub-Webseite</li>
<li>Lokalen Clone hiervon anlegen: <code>git clone ...</code></li>
<li>Lokale Änderungen an GitHub schicken:
<code>git push origin master</code></li>
<li>Original-Projekt als &ldquo;upstream&rdquo; definieren:
<code>git remote add upstream ...</code></li>
<li>Lokale Kopie des Original-Projektes aktualisieren:
<code>git fetch upstream</code></li>
<li>Lokale Kopie des Original-Projektes &ldquo;einarbeiten&rdquo;:

<ul>
<li><code>git merge --no-commit upstream/master</code></li>
<li><code>git mergetool</code></li>
<li><code>git commit -m ...</code></li>
</ul>
</li>
</ul>


<p>Mehr Details: <a href="https://help.github.com/articles/fork-a-repo">https://help.github.com/articles/fork-a-repo</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Octopress - Liquid error: can’t convert nil into String]]></title>
    <link href="http://uli-heller.github.com/blog/2013/07/20/octopress-fehler/"/>
    <updated>2013-07-20T07:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/07/20/octopress-fehler</id>
    <content type="html"><![CDATA[<p>Beim Einbinden von Dateien in einen Octopress-Blog-Eintrag sehe ich immer mal wieder
Fehlermeldungen wie diese:</p>

<pre><code>Liquid error: can’t convert nil into String
</code></pre>

<p>Sie tauchen immer dann auf, wenn ich Dateien ohne Extension mittels <code>include_code</code>
einbinde:</p>

<pre><code>{% include_code redmine/passenger/passenger %}
</code></pre>

<!-- more -->


<h2>Einige Tests</h2>

<h3>Wie sieht&rsquo;s mit der Version von Github/master aus?</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>git clone https://github.com/imathis/octopress.git
</span><span class='line'>Klone nach <span class="s1">&#39;octopress&#39;</span>...
</span><span class='line'>remote: Counting objects: 10661, <span class="k">done</span>.
</span><span class='line'>remote: Compressing objects: 100% <span class="o">(</span>4588/4588<span class="o">)</span>, <span class="k">done</span>.
</span><span class='line'>remote: Total 10661 <span class="o">(</span>delta 5839<span class="o">)</span>, reused 9830 <span class="o">(</span>delta 5212<span class="o">)</span>
</span><span class='line'>Empfange Objekte: 100% <span class="o">(</span>10661/10661<span class="o">)</span>, 2.30 MiB | 773.00 KiB/s, <span class="k">done</span>.
</span><span class='line'>Löse Unterschiede auf: 100% <span class="o">(</span>5839/5839<span class="o">)</span>, <span class="k">done</span>.
</span><span class='line'>Checking connectivity... <span class="k">done</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span><span class="nb">cd </span>octopress/
</span><span class='line'>You are using <span class="s1">&#39;.rvmrc&#39;</span>, it requires trusting, it is slower and it is not compatible with other ruby managers,
</span><span class='line'>you can switch to <span class="s1">&#39;.ruby-version&#39;</span> using <span class="s1">&#39;rvm rvmrc to [.]ruby-version&#39;</span>
</span><span class='line'>or ignore this warnings with <span class="s1">&#39;rvm rvmrc warning ignore .../octopress/.rvmrc&#39;</span>,
</span><span class='line'><span class="s1">&#39;.rvmrc&#39;</span> will <span class="k">continue </span>to be the default project file in RVM 1 and RVM 2,
</span><span class='line'>to ignore the warning <span class="k">for </span>all files run <span class="s1">&#39;rvm rvmrc warning ignore all.rvmrcs&#39;</span>.
</span><span class='line'>
</span><span class='line'>********************************************************************************
</span><span class='line'>* NOTICE                                                                       *
</span><span class='line'>********************************************************************************
</span><span class='line'>* RVM has encountered a new or modified .rvmrc file in the current directory,  *
</span><span class='line'>* this is a shell script and therefore may contain any shell commands.         *
</span><span class='line'>*                                                                              *
</span><span class='line'>* Examine the contents of this file carefully to be sure the contents are      *
</span><span class='line'>* safe before trusting it!                                                     *
</span><span class='line'>* Do you wish to trust <span class="s1">&#39;.../octopress/.rvmrc&#39;</span>?                                 *
</span><span class='line'>* Choose v<span class="o">[</span>iew<span class="o">]</span> below to view the contents                                     *
</span><span class='line'>********************************************************************************
</span><span class='line'>y<span class="o">[</span>es<span class="o">]</span>, n<span class="o">[</span>o<span class="o">]</span>, v<span class="o">[</span>iew<span class="o">]</span>, c<span class="o">[</span>ancel<span class="o">]</span>&gt; yes
</span><span class='line'>Using .../.rvm/gems/ruby-1.9.3-p392
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>bundle install
</span><span class='line'>Fetching gem metadata from https://rubygems.org/........
</span><span class='line'>Fetching gem metadata from https://rubygems.org/..
</span><span class='line'>Resolving dependencies...
</span><span class='line'>Using rake <span class="o">(</span>0.9.2.2<span class="o">)</span>
</span><span class='line'>Using RedCloth <span class="o">(</span>4.2.9<span class="o">)</span>
</span><span class='line'>Using chunky_png <span class="o">(</span>1.2.5<span class="o">)</span>
</span><span class='line'>Using fast-stemmer <span class="o">(</span>1.0.1<span class="o">)</span>
</span><span class='line'>Using classifier <span class="o">(</span>1.3.3<span class="o">)</span>
</span><span class='line'>Using fssm <span class="o">(</span>0.2.9<span class="o">)</span>
</span><span class='line'>Installing sass <span class="o">(</span>3.2.9<span class="o">)</span>
</span><span class='line'>Installing compass <span class="o">(</span>0.12.2<span class="o">)</span>
</span><span class='line'>Using directory_watcher <span class="o">(</span>1.4.1<span class="o">)</span>
</span><span class='line'>Installing haml <span class="o">(</span>3.1.7<span class="o">)</span>
</span><span class='line'>Installing kramdown <span class="o">(</span>0.13.8<span class="o">)</span>
</span><span class='line'>Using liquid <span class="o">(</span>2.3.0<span class="o">)</span>
</span><span class='line'>Using syntax <span class="o">(</span>1.0.0<span class="o">)</span>
</span><span class='line'>Installing maruku <span class="o">(</span>0.6.1<span class="o">)</span>
</span><span class='line'>Using posix-spawn <span class="o">(</span>0.3.6<span class="o">)</span>
</span><span class='line'>Installing yajl-ruby <span class="o">(</span>1.1.0<span class="o">)</span>
</span><span class='line'>Installing pygments.rb <span class="o">(</span>0.3.4<span class="o">)</span>
</span><span class='line'>Installing jekyll <span class="o">(</span>0.12.0<span class="o">)</span>
</span><span class='line'>Installing rack <span class="o">(</span>1.5.2<span class="o">)</span>
</span><span class='line'>Installing rack-protection <span class="o">(</span>1.5.0<span class="o">)</span>
</span><span class='line'>Using rb-fsevent <span class="o">(</span>0.9.1<span class="o">)</span>
</span><span class='line'>Installing rdiscount <span class="o">(</span>2.0.7.3<span class="o">)</span>
</span><span class='line'>Using rubypants <span class="o">(</span>0.2.0<span class="o">)</span>
</span><span class='line'>Installing sass-globbing <span class="o">(</span>1.0.0<span class="o">)</span>
</span><span class='line'>Installing tilt <span class="o">(</span>1.3.7<span class="o">)</span>
</span><span class='line'>Installing sinatra <span class="o">(</span>1.4.2<span class="o">)</span>
</span><span class='line'>Using stringex <span class="o">(</span>1.4.0<span class="o">)</span>
</span><span class='line'>Using bundler <span class="o">(</span>1.3.5<span class="o">)</span>
</span><span class='line'>Your bundle is <span class="nb">complete</span>!
</span><span class='line'>Use <span class="sb">`</span>bundle show <span class="o">[</span>gemname<span class="o">]</span><span class="sb">`</span> to see where a bundled gem is installed.
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>rake install
</span><span class='line'><span class="c">## Copying classic theme into ./source and ./sass</span>
</span><span class='line'>mkdir -p <span class="nb">source</span>
</span><span class='line'>cp -r .themes/classic/source/. <span class="nb">source</span>
</span><span class='line'>mkdir -p sass
</span><span class='line'>cp -r .themes/classic/sass/. sass
</span><span class='line'>mkdir -p <span class="nb">source</span>/_posts
</span><span class='line'>mkdir -p public
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>rake generate
</span><span class='line'><span class="c">## Generating Site with Jekyll</span>
</span><span class='line'>directory <span class="nb">source</span>/stylesheets/
</span><span class='line'>   create <span class="nb">source</span>/stylesheets/screen.css
</span><span class='line'>Configuration from .../octopress/_config.yml
</span><span class='line'>Building site: <span class="nb">source</span> -&gt; public
</span><span class='line'>Successfully generated site: <span class="nb">source</span> -&gt; public
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>mkdir -p <span class="nb">source</span>/downloads/code
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;Uli war da&quot;</span> &gt;source/downloads/code/mytest
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>mkdir -p <span class="nb">source</span>/downloads/code/redmine/passenger
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>cp .../source/downloads/code/redmine/passenger/passenger <span class="nb">source</span>/downloads/code/redmine/passenger/.
</span></code></pre></td></tr></table></div></figure>


<p>Jetzt noch ein Testdokument anlegen:</p>

<figure class='code'><figcaption><span>&#8230;/source/_posts/2013-07-20-octopress.md </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>---
</span><span class='line'>layout: post
</span><span class='line'>author: Uli Heller
</span><span class='line'>published: yes
</span><span class='line'>title: &quot;Octopress-Test&quot;
</span><span class='line'>date: 2013-07-20 07:00
</span><span class='line'>comments: true
</span><span class='line'>---
</span><span class='line'>
</span><span class='line'>Test:
</span><span class='line'>
</span><span class='line'>{% include_code mytest %}
</span><span class='line'>
</span><span class='line'>Test2:
</span><span class='line'>
</span><span class='line'>{% include_code redmine/passenger/passenger %}
</span></code></pre></td></tr></table></div></figure>


<p>Sichten mit</p>

<ul>
<li><code>rake preview</code></li>
<li>Browser: <a href="http://localhost:4000">http://localhost:4000</a></li>
</ul>


<p>Sieht absolut OK aus, der Fehler tritt nicht auf!</p>

<h3>Wie sieht&rsquo;s mit der Version von Github/site-2.1 aus?</h3>

<p>Mit der Version von Github/site-2.1 tritt der Fehler genauso auf wie bei mir.
Er ist dort also nicht korrigiert.</p>

<h3>Wie sieht&rsquo;s mit der Version von Github/3.0 aus?</h3>

<p>Scheint komplett andersartig zu funktionieren &ndash; komme damit momentan nicht klar.</p>

<h3>Wie sieht&rsquo;s mit der Version von Github/source-2.1 aus?</h3>

<p>Der Zweig &ldquo;source-2.1&rdquo; existiert auf Github nicht mehr!</p>

<h2>Weiteres Vorgehen</h2>

<p>Für mich sieht&rsquo;s so aus, als wäre das Aufsetzen auf &ldquo;source-2.1&rdquo; eine echt blöde
Entscheidung gewesen. Werde mein Octopress wohl in nächster Zeit umstellen müssen
auf &ldquo;master&rdquo;.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Redmine: Von FCGI zu Passenger]]></title>
    <link href="http://uli-heller.github.com/blog/2013/07/19/redmine-passenger/"/>
    <updated>2013-07-19T15:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/07/19/redmine-passenger</id>
    <content type="html"><![CDATA[<p>Bislang habe ich Redmine hinter einem Apache HTTPD via FCGI betrieben.
Bei meinen Tests mit Redmine-2.3.2 gibt es bei dieser Konstellation aber
viele Probleme mit der Selektion des Rails-Environments. Es wird immer
&ldquo;development&rdquo; verwendet, &ldquo;production&rdquo; kann nicht mehr &ldquo;wie früher&rdquo; über
&ldquo;environment.rb&rdquo; und <code>ENV['RAILS_ENV'] ||= 'production'</code> selektiert werden.</p>

<!-- more -->


<h2>Sichtung der Alt-Version</h2>

<p>Zunächst muß sichergestellt werden, dass die alte Version hinreichend
gut funktioniert:</p>

<ul>
<li>Redmine-VM starten</li>
<li>LDAP-VM starten</li>
<li>Browser: <a href="http://192.168.56.97">http://192.168.56.97</a> &ndash;> &ldquo;It works&rdquo;</li>
<li>Browser: <a href="http://192.168.56.97/redmine">http://192.168.56.97/redmine</a> &ndash;> Begrüssung von Redmine</li>
<li>Browser: <a href="http://192.168.56.97/redmine/issues/1">http://192.168.56.97/redmine/issues/1</a> &ndash;> Anmeldungseite wird angezeigt; Anmeldung funktioniert</li>
</ul>


<p>Soweit sieht alles ganz OK aus. Nun: Sichtung der Programmstände.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>ruby -v
</span><span class='line'>ruby 1.8.7 <span class="o">(</span>2010-01-10 patchlevel 249<span class="o">)</span> <span class="o">[</span>i486-linux<span class="o">]</span>
</span><span class='line'><span class="nv">$ </span>gem list
</span><span class='line'>
</span><span class='line'>*** LOCAL GEMS ***
</span><span class='line'>
</span><span class='line'>actionmailer <span class="o">(</span>2.3.17<span class="o">)</span>
</span><span class='line'>actionpack <span class="o">(</span>2.3.17<span class="o">)</span>
</span><span class='line'>activerecord <span class="o">(</span>2.3.17<span class="o">)</span>
</span><span class='line'>activeresource <span class="o">(</span>2.3.17<span class="o">)</span>
</span><span class='line'>activesupport <span class="o">(</span>2.3.17<span class="o">)</span>
</span><span class='line'>i18n <span class="o">(</span>0.4.2<span class="o">)</span>
</span><span class='line'>mysql <span class="o">(</span>2.8.1<span class="o">)</span>
</span><span class='line'>rack <span class="o">(</span>1.1.3<span class="o">)</span>
</span><span class='line'>rails <span class="o">(</span>2.3.17<span class="o">)</span>
</span><span class='line'>rake <span class="o">(</span>0.8.7<span class="o">)</span>
</span><span class='line'>rubygems-update <span class="o">(</span>1.6.2<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Ruby-Gems herunterladen und installieren</h2>

<p>Mit diesen Befehlen werden die Ruby-Gems heruntergeladen:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>gem fetch passenger
</span><span class='line'><span class="c"># gem fetch passenger -v 4.0.10</span>
</span><span class='line'>gem fetch daemon_controller -v <span class="s2">&quot;&gt;= 1.1.0&quot;</span>
</span><span class='line'><span class="c"># gem fetch daemon_controller -v 1.1.4</span>
</span></code></pre></td></tr></table></div></figure>


<p>Die *.gem-Dateien müssen auf die Redmine-VM übertragen werden, am besten
mit <code>scp</code>. Danach spielt man sie ein mit</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>gem install passenger-4.0.10.gem
</span></code></pre></td></tr></table></div></figure>


<h2>Apache-Modul installieren</h2>

<p>Mit nachfolgendem Befehl wird das Passenger-Modul für Apache2
installiert und auch gleich aktiviert:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>apt-get install libapache2-mod-passenger
</span></code></pre></td></tr></table></div></figure>


<h2>Apache konfigurieren</h2>

<ul>
<li>Konfigurationsdatei kopieren und anpassen:
<code>cp /etc/apache2/sites-available/default /etc/apache2/sites-available/passenger</code></li>
</ul>


<figure class='code'><figcaption><span>/etc/apache2/sites-available/passenger </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>#NameVirtualHost *:80
</span><span class='line'>&lt;VirtualHost *:80&gt;
</span><span class='line'>        ServerAdmin webmaster@localhost
</span><span class='line'>
</span><span class='line'>        PassengerDefaultUser www-data
</span><span class='line'>        RailsEnv production
</span><span class='line'>#        RailsBaseURI /redmine
</span><span class='line'>
</span><span class='line'>        DocumentRoot /srv/redmine-1.2.1/public/
</span><span class='line'>#        DocumentRoot /var/www/
</span><span class='line'>        Alias /redmine &quot;/srv/redmine-1.2.1/public/&quot;
</span><span class='line'>        &lt;Directory &quot;/srv/redmine-1.2.1/public/&quot;&gt;
</span><span class='line'>         Options FollowSymLinks -MultiViews
</span><span class='line'>          AllowOverride none
</span><span class='line'>          Order allow,deny
</span><span class='line'>          allow from all
</span><span class='line'>        &lt;/Directory&gt;
</span><span class='line'>
</span><span class='line'>        ErrorLog /var/log/apache2/error.log
</span><span class='line'>
</span><span class='line'>        # Possible values include: debug, info, notice, warn, error, crit,
</span><span class='line'>        # alert, emerg.
</span><span class='line'>        LogLevel warn
</span><span class='line'>
</span><span class='line'>        CustomLog /var/log/apache2/access.log combined
</span><span class='line'>        ServerSignature On
</span><span class='line'>&lt;/VirtualHost&gt;
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>Alte Datei &ldquo;abklemmen&rdquo;: <code>a2dissite default</code></p></li>
<li><p>Neue Datei aktivieren: <code>a2ensite passenger</code></p></li>
<li><p>Apache neu starten: <code>/etc/init.d/apache2 restart</code></p></li>
</ul>


<h2>Sichtung der Neu-Version</h2>

<p>Zunächst muß sichergestellt werden, dass die alte Version hinreichend
gut funktioniert:</p>

<ul>
<li>Redmine-VM starten (&hellip; läuft vermutlich eh&#8217; noch)</li>
<li>LDAP-VM starten (&hellip; läuft vermutlich eh&#8217; noch)</li>
<li>Browser: <a href="http://192.168.56.97">http://192.168.56.97</a>  &ndash;> Begrüssung von Redmine</li>
<li>Browser: <a href="http://192.168.56.97/redmine">http://192.168.56.97/redmine</a> &ndash;> Begrüssung von Redmine</li>
<li>Browser: <a href="http://192.168.56.97/redmine/issues/1">http://192.168.56.97/redmine/issues/1</a> &ndash;> Anmeldungseite wird angezeigt; Anmeldung funktioniert</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Analyse des Systemstarts]]></title>
    <link href="http://uli-heller.github.com/blog/2013/07/18/bootchart/"/>
    <updated>2013-07-18T10:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/07/18/bootchart</id>
    <content type="html"><![CDATA[<p>Mein Samsung-Laptop benötigt sehr lange für den Systemstart.
Gefühlt dauert&rsquo;s 5 Minuten vom Einschalten bis zum Login-Prompt.
Das sollte doch irgendwie schneller gehen &ndash; nur wie?</p>

<!-- more -->


<h2>Bootchart</h2>

<h3>Installieren</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo apt-get install bootchart pybootchartgui</span></code></pre></td></tr></table></div></figure>


<h3>Neustart</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo reboot</span></code></pre></td></tr></table></div></figure>


<h3>Sichten</h3>

<ul>
<li>Verzeichnis: /var/log/bootchart</li>
<li>Dateien: uli-samsung-precise-20130718-1.tgz und uli-samsung-precise-20130718-1.png</li>
</ul>


<p><img src="http://uli-heller.github.com/images/bootchart/uli-samsung-precise-20130718-1.png" alt="Bootchart vom Samsung-Laptop" /></p>

<p>Es fällt auf, dass ein Großteil der Zeit in IOWAIT verbracht wird (dicke rotbraune Balken). Somit liegt die Vermutung nahe, dass die interne Festplatte wohl schnarchlahm ist. Das deckt sich auch wunderbar mit meinen Beobachtungen bei der täglichen Arbeit:</p>

<ul>
<li>Editieren eines Shell-Skriptes</li>
<li>Speichern</li>
<li>Fenster-Wechsel + Start des Skriptes</li>
<li>Start scheitert mit einer Fehlermeldung (sinngemäß: &ldquo;Skript gesperrt&rdquo;)</li>
<li>2 Sekunden warten + nochmaliger Start</li>
<li>Start klappt</li>
</ul>


<h3>Versuch: SSD an USB-3</h3>

<p>Eine externe SSD angeschlossen an die USB-3-Schnittstelle startet &ldquo;schnell&rdquo; (&hellip; gefühlt dauert&rsquo;s ähnlich lang wie beim Macbook Air 2013).</p>

<p>Also: Scheint wirklich an der lahmen Platte zu liegen.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Experimente mit ZFS unter Ubuntu-12.04]]></title>
    <link href="http://uli-heller.github.com/blog/2013/07/12/zfs/"/>
    <updated>2013-07-12T08:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/07/12/zfs</id>
    <content type="html"><![CDATA[<h2>DEBs installieren</h2>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo apt-get install make build-essential dpkg-dev
</span><span class='line'>sudo apt-get install -f
</span><span class='line'>sudo dpkg -i zfs-dkms_0.6.1-1~precise_amd64.deb <span class="se">\</span>
</span><span class='line'>  spl-dkms_0.6.1-1~precise_all.deb              <span class="se">\</span>
</span><span class='line'>  dkms_2.2.0.3-1ubuntu3.1+zfs6~precise1_all.deb
</span><span class='line'>sudo dpkg -i zfsutils_0.6.1-1~precise_amd64.deb <span class="se">\</span>
</span><span class='line'>  libnvpair1_0.6.1-1~precise_amd64.deb          <span class="se">\</span>
</span><span class='line'>  libuutil1_0.6.1-1~precise_amd64.deb           <span class="se">\</span>
</span><span class='line'>  libzfs1_0.6.1-1~precise_amd64.deb             <span class="se">\</span>
</span><span class='line'>  libzpool1_0.6.1-1~precise_amd64.deb
</span><span class='line'>sudo dpkg -i ubuntu-zfs_7~precise1_amd64.deb    <span class="se">\</span>
</span><span class='line'>  spl_0.6.1-1~precise_amd64.deb
</span><span class='line'>sudo dpkg -i mountall_2.48build1-zfs2_amd64.deb
</span></code></pre></td></tr></table></div></figure>


<h2>Kurzexperimente mit ZPOOL</h2>

<h4>Pool anlegen</h4>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool create -f zfsdata /dev/sda
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: none requested
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    sda       ONLINE       0     0     0
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool destroy zfsdata
</span></code></pre></td></tr></table></div></figure>


<h3>Pool mit RaidZ anlegen</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool create -f zfsdata raidz /dev/sda /dev/sdb
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: none requested
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sda     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool destroy zfsdata
</span></code></pre></td></tr></table></div></figure>


<h3>Pool und Reboot</h3>

<p>Dieser Test soll sicherstellen, dass ein ZPOOL auch nach einem Reboot verfügbar ist.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool create -f zfsdata raidz /dev/sda /dev/sdb
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: none requested
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sda     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>df|grep zfs
</span><span class='line'>zfsdata                  2873622144    128 2873622016   1% /zfsdata
</span><span class='line'><span class="nv">$ </span>sudo reboot
</span><span class='line'>...
</span><span class='line'><span class="nv">$ </span>df|grep zfs
</span><span class='line'>zfsdata                  2873622144    128 2873622016   1% /zfsdata
</span><span class='line'><span class="nv">$ </span>sudo zpool destroy zfsdata
</span></code></pre></td></tr></table></div></figure>


<p>Das funktioniert offenbar nur dann, wenn das &ldquo;mountall&rdquo;-Paket installiert ist!</p>

<h3>Pool mit RaidZ und Spare Disk (manuell)</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool create -f zfsdata raidz /dev/sda /dev/sdb spare /dev/sdc
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: none requested
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sda     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sdc       AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<p>Jetzt habe ich die Platte /dev/sda rausgezogen. Ideal wäre nun, wenn sich das RAIDZ
automatisch auf /dev/sdc verlagern würde&hellip;</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool scrub zfsdata
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: DEGRADED
</span><span class='line'>status: One or more devices could not be used because the label is missing or
</span><span class='line'>  invalid.  Sufficient replicas exist <span class="k">for </span>the pool to <span class="k">continue</span>
</span><span class='line'><span class="k">  </span>functioning in a degraded state.
</span><span class='line'>action: Replace the device using <span class="s1">&#39;zpool replace&#39;</span>.
</span><span class='line'>   see: http://zfsonlinux.org/msg/ZFS-8000-4J
</span><span class='line'>  scan: scrub repaired 0 in 0h0m with 0 errors on Sat Jul 20 11:07:11 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     DEGRADED     0     0     0
</span><span class='line'>    raidz1-0  DEGRADED     0     0     0
</span><span class='line'>      sda     UNAVAIL      0     0     0  corrupted data
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sdc       AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool replace zfsdata sda sdc
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: DEGRADED
</span><span class='line'>status: One or more devices could not be used because the label is missing or
</span><span class='line'>  invalid.  Sufficient replicas exist <span class="k">for </span>the pool to <span class="k">continue</span>
</span><span class='line'><span class="k">  </span>functioning in a degraded state.
</span><span class='line'>action: Replace the device using <span class="s1">&#39;zpool replace&#39;</span>.
</span><span class='line'>   see: http://zfsonlinux.org/msg/ZFS-8000-4J
</span><span class='line'>  scan: resilvered 532K in 0h0m with 0 errors on Sat Jul 20 11:12:19 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME         STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata      DEGRADED     0     0     0
</span><span class='line'>    raidz1-0   DEGRADED     0     0     0
</span><span class='line'>      spare-0  UNAVAIL      0     0     0
</span><span class='line'>        sda    UNAVAIL      0     0     0  corrupted data
</span><span class='line'>        sdc    ONLINE       0     0     0
</span><span class='line'>      sdb      ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sdc        INUSE     currently in use
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool detach zfsdata sda
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: resilvered 532K in 0h0m with 0 errors on Sat Jul 20 11:12:19 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sdc     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<p>Jetzt habe ich /dev/sda wieder eingebaut und mit <code>fdisk</code> geprüft, ob sie auch ansprechbar ist.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool add zfsdata spare sda
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: resilvered 532K in 0h0m with 0 errors on Sat Jul 20 11:12:19 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sdc     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sda       AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<h3>Pool mit RaidZ und Spare Disk (automatisch)</h3>

<p>Nachfolgend meine Versuche mit &ldquo;autoreplace&rdquo; &ndash; leider wenig erfolgreich.
Hier <a href="http://forums.nas4free.org/viewtopic.php?f=66&amp;t=3873">http://forums.nas4free.org/viewtopic.php?f=66&amp;t=3873</a> werden die
gleichen Probleme mit FreeBSD beschrieben. Anscheinend unterstützt FreeBSD
dieses Feature nicht richtig, vermutlich ist&rsquo;s bei Linux ebenso.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool create -f zfsdata raidz /dev/sda /dev/sdb spare /dev/sdc
</span><span class='line'><span class="nv">$ </span>sudo zpool <span class="nb">set </span><span class="nv">autoreplace</span><span class="o">=</span>on zfsdata
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: none requested
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sda     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sdc       AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<p>Jetzt habe ich die Platte /dev/sda rausgezogen. Ideal wäre nun, wenn sich das RAIDZ
automatisch auf /dev/sdc verlagern würde&hellip;</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool scrub zfsdata
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: DEGRADED
</span><span class='line'>status: One or more devices has been removed by the administrator.
</span><span class='line'>  Sufficient replicas exist <span class="k">for </span>the pool to <span class="k">continue </span>functioning in a
</span><span class='line'>  degraded state.
</span><span class='line'>action: Online the device using <span class="s1">&#39;zpool online&#39;</span> or replace the device with
</span><span class='line'>  <span class="s1">&#39;zpool replace&#39;</span>.
</span><span class='line'>  scan: scrub repaired 0 in 0h0m with 0 errors on Sat Jul 20 11:25:59 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     DEGRADED     0     0     0
</span><span class='line'>    raidz1-0  DEGRADED     0     0     0
</span><span class='line'>      sda     REMOVED      0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sdc       AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool replace zfsdata sda sdc
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: DEGRADED
</span><span class='line'>status: One or more devices is currently being resilvered.  The pool will
</span><span class='line'>  <span class="k">continue </span>to <span class="k">function</span>, possibly in a degraded state.
</span><span class='line'>action: Wait <span class="k">for </span>the resilver to complete.
</span><span class='line'>  scan: resilver in progress since Sat Jul 20 11:33:09 2013
</span><span class='line'>    146M scanned out of 1,03G at 8,61M/s, 0h1m to go
</span><span class='line'>    72,9M resilvered, 13,94% <span class="k">done</span>
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME         STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata      DEGRADED     0     0     0
</span><span class='line'>    raidz1-0   DEGRADED     0     0     0
</span><span class='line'>      spare-0  UNAVAIL      0     0     0
</span><span class='line'>        sda    UNAVAIL      0     0     0  corrupted data
</span><span class='line'>        sdc    ONLINE       0     0     0  <span class="o">(</span>resilvering<span class="o">)</span>
</span><span class='line'>      sdb      ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sdc        INUSE     currently in use
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: DEGRADED
</span><span class='line'>status: One or more devices could not be used because the label is missing or
</span><span class='line'>  invalid.  Sufficient replicas exist <span class="k">for </span>the pool to <span class="k">continue</span>
</span><span class='line'><span class="k">  </span>functioning in a degraded state.
</span><span class='line'>action: Replace the device using <span class="s1">&#39;zpool replace&#39;</span>.
</span><span class='line'>   see: http://zfsonlinux.org/msg/ZFS-8000-4J
</span><span class='line'>  scan: resilvered 526M in 0h1m with 0 errors on Sat Jul 20 11:34:28 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME         STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata      DEGRADED     0     0     0
</span><span class='line'>    raidz1-0   DEGRADED     0     0     0
</span><span class='line'>      spare-0  UNAVAIL      0     0     0
</span><span class='line'>        sda    UNAVAIL      0     0     0  corrupted data
</span><span class='line'>        sdc    ONLINE       0     0     0
</span><span class='line'>      sdb      ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sdc        INUSE     currently in use
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool detach zfsdata sda
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: resilvered 526M in 0h1m with 0 errors on Sat Jul 20 11:34:28 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sdc     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<p>Jetzt habe ich /dev/sda wieder eingebaut und mit <code>fdisk</code> geprüft, ob sie auch ansprechbar ist.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool add zfsdata spare sda
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: resilvered 526M in 0h1m with 0 errors on Sat Jul 20 11:34:28 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME        STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata     ONLINE       0     0     0
</span><span class='line'>    raidz1-0  ONLINE       0     0     0
</span><span class='line'>      sdc     ONLINE       0     0     0
</span><span class='line'>      sdb     ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    sda       AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<h2>Platten-IDs ermitteln</h2>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>ls /dev/disk/by-id/scsi-SATA_WDC*|grep -v part
</span><span class='line'>/dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0755994
</span><span class='line'>/dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511
</span><span class='line'>/dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577
</span><span class='line'>/dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>ls /dev/disk/by-id/scsi-SATA_WDC*|grep -v part|xargs --verbose -n1 udevadm info -q path -n
</span><span class='line'>udevadm info -q path -n /dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0755994
</span><span class='line'>/devices/pci0000:00/0000:00:11.0/host3/target3:0:0/3:0:0:0/block/sdd
</span><span class='line'>udevadm info -q path -n /dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511
</span><span class='line'>/devices/pci0000:00/0000:00:11.0/host2/target2:0:0/2:0:0:0/block/sdc
</span><span class='line'>udevadm info -q path -n /dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577
</span><span class='line'>/devices/pci0000:00/0000:00:11.0/host0/target0:0:0/0:0:0:0/block/sda
</span><span class='line'>udevadm info -q path -n /dev/disk/by-id/scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780
</span><span class='line'>/devices/pci0000:00/0000:00:11.0/host1/target1:0:0/1:0:0:0/block/sdb
</span></code></pre></td></tr></table></div></figure>


<p>Aus den Ausgaben kann man diese Zuordnung erkennen:</p>

<ul>
<li>sda &ndash; scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577</li>
<li>sdb &ndash; scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780</li>
<li>sdc &ndash; scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511</li>
<li>sdd &ndash; scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0755994</li>
</ul>


<p>Die Platten-IDs sollten am besten auch auf den jeweiligen Einbaurahmen geschrieben
werden, damit es zu keinen Verwechslungen kommen kann.</p>

<h2>ZPool über Platten-IDs</h2>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool create -f zfsdata raidz scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577 <span class="se">\</span>
</span><span class='line'>   scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780 <span class="se">\</span>
</span><span class='line'>   spare scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: none requested
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME                                           STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata                                        ONLINE       0     0     0
</span><span class='line'>    raidz1-0                                     ONLINE       0     0     0
</span><span class='line'>      scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577  ONLINE       0     0     0
</span><span class='line'>      scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780  ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511    AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'><span class="nv">$ </span>sudo zpool scrub zfsdata
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: DEGRADED
</span><span class='line'>status: One or more devices could not be used because the label is missing or
</span><span class='line'>  invalid.  Sufficient replicas exist <span class="k">for </span>the pool to <span class="k">continue</span>
</span><span class='line'><span class="k">  </span>functioning in a degraded state.
</span><span class='line'>action: Replace the device using <span class="s1">&#39;zpool replace&#39;</span>.
</span><span class='line'>   see: http://zfsonlinux.org/msg/ZFS-8000-4J
</span><span class='line'>  scan: scrub repaired 0 in 0h0m with 0 errors on Sat Jul 20 12:19:07 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME                                           STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata                                        DEGRADED     0     0     0
</span><span class='line'>    raidz1-0                                     DEGRADED     0     0     0
</span><span class='line'>      scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577  UNAVAIL      0     0     0  corrupted data
</span><span class='line'>      scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780  ONLINE       0     0     0
</span><span class='line'>  spares
</span><span class='line'>    scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511    AVAIL
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>sudo zpool replace zfsdata scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577 scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511
</span><span class='line'><span class="nv">$ </span>sudo zpool detach zfsdata scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: resilvered 532K in 0h0m with 0 errors on Sat Jul 20 12:19:36 2013
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME                                           STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata                                        ONLINE       0     0     0
</span><span class='line'>    raidz1-0                                     ONLINE       0     0     0
</span><span class='line'>      scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511  ONLINE       0     0     0
</span><span class='line'>      scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780  ONLINE       0     0     0
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<h2>Finale</h2>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo zpool create -o <span class="nv">ashift</span><span class="o">=</span>12 -f zfsdata scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577 scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780 scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511
</span><span class='line'><span class="nv">$ </span>sudo zpool status
</span><span class='line'>  pool: zfsdata
</span><span class='line'> state: ONLINE
</span><span class='line'>  scan: none requested
</span><span class='line'>config:
</span><span class='line'>
</span><span class='line'>  NAME                                         STATE     READ WRITE CKSUM
</span><span class='line'>  zfsdata                                      ONLINE       0     0     0
</span><span class='line'>    scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0771577  ONLINE       0     0     0
</span><span class='line'>    scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0777780  ONLINE       0     0     0
</span><span class='line'>    scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0770511  ONLINE       0     0     0
</span><span class='line'>
</span><span class='line'>errors: No known data errors
</span></code></pre></td></tr></table></div></figure>


<p>Die Platte &ldquo;scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0755994&rdquo; bleibt auf Vorrat
nicht eingesteckt im Rahmen. Beim Ausfall einer Platte wird sie eingesteckt und
mittels <code>zpool replace zfsdata {kaputte_platte} scsi-SATA_WDC_WD30EFRX-68_WD-WCC1T0755994</code>
aktiviert.</p>

<h2>Probleme</h2>

<h3>Dateisystem nach Neustart nicht eingebunden</h3>

<p>Nachdem ich den Kernel aktualisiert habe von 3.2 nach 3.5 klappt das automatische
Einhängen des ZFS-Dateisystems nicht mehr.</p>

<p>Abhilfe: Standard-Paket &ldquo;mountall&rdquo; wieder installieren und ZFS umkonfigurieren!</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo apt-get install <span class="nv">mountall</span><span class="o">=</span>2.36.4
</span><span class='line'>sudo sed -i s/ZFS_MOUNT<span class="o">=</span><span class="s1">&#39;no&#39;</span>/ZFS_MOUNT<span class="o">=</span><span class="s1">&#39;yes&#39;</span>/ /etc/default/zfs
</span></code></pre></td></tr></table></div></figure>


<h2>Änderungen</h2>

<h3>2013-07-20</h3>

<ul>
<li>Formatierung korrigiert</li>
<li>Reboot-Test</li>
<li>Tests mit Spare Disk</li>
<li>Tests mit Platten-IDs</li>
<li>Finale</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Subversion 1.8.0 für Ubuntu-12.04]]></title>
    <link href="http://uli-heller.github.com/blog/2013/07/10/subversion_1.8.0/"/>
    <updated>2013-07-10T10:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/07/10/subversion_1.8.0</id>
    <content type="html"><![CDATA[<p>Vor ein paar Tagen wurde Subversion-1.8.0 veröffentlicht.
Hier meine Versuche, ein Paket für Ubuntu-12.04 zu bauen.</p>

<p>Aktuell kann ich die DEB-Pakete zwar erzeugen und installieren,
leider funktionieren sie aber nicht richtig!</p>

<!-- more -->


<h2>Ausgangpunkt: Subversion-1.7.10</h2>

<p>Mein Ausgangspunkt sind die Pakete für Subversion-1.7.10.</p>

<pre><code>$ cd subversion-1.7.10
$ uupdate -u ../subversion-1.8.0
$ cd ../subversion-1.8.0
$ dpkg-buildpackage
</code></pre>

<h2>Erste Hürde: Serf-1.2.1</h2>

<h2>Zweite Hürde: Sqlite3-3.7.15</h2>

<p>Subversion benötigt eine relativ aktuelle Version von Sqlite3. Die
Standard-Version von Ubuntu-12.04 ist zu alt. Ich habe mir so beholfen:</p>

<ul>
<li>Quellpakete von sqlite3-3.7.15.2 aus &ldquo;raring&rdquo; runtergeladen</li>
<li>Ein paar kleine Anpassungen an debian/rules vorgenommen, damit
tcl85 an der richtigen Stelle ausgelesen wird</li>
<li>Pakete erzeugen mit <code>dpkg-buildpackage</code></li>
</ul>


<h2>Dritte Hürde: Python-Test bricht ab</h2>

<p>Bei der Ausführung von <code>dpkg-buildpackage</code> in &ldquo;subversion-1.8.0&rdquo;
werden die Tests mit einer Fehlermeldung abgebrochen:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>...
</span><span class='line'>Running testsuite - may take a while.  To disable,
</span><span class='line'>use DEB_BUILD_OPTIONS=nocheck or edit debian/rules.
</span><span class='line'>
</span><span class='line'>/usr/bin/make -f debian/rules check-swig-py check-swig-pl check-swig-rb
</span><span class='line'>make[1]: Entering directory `/home/ubuntu/build/subversion/subversion-1.8.0'
</span><span class='line'>set -e; for v in 2.7; do rm -f BUILD/subversion/bindings/swig/python; ln -fs python$v BUILD/subversion/bindings/swig/python; pylib=$(python$v -c 'from distutils import sysconfig; print sysconfig.get_python_lib()');  /usr/bin/make -C BUILD check-swig-py PYTHON=python$v PYVER=$v CLEANUP=1 LC_ALL=C; done
</span><span class='line'>make[2]: Entering directory `/home/ubuntu/build/subversion/subversion-1.8.0/BUILD'
</span><span class='line'>if [ "LD_LIBRARY_PATH" = "DYLD_LIBRARY_PATH" ]; then for d in ./subversion/bindings/swig/python/libsvn_swig_py ./subversion/bindings/swig/python/../../../libsvn_*; do if [ -n "$DYLD_LIBRARY_PATH" ]; then LD_LIBRARY_PATH="$LD_LIBRARY_PATH:$d/.libs"; else LD_LIBRARY_PATH="$d/.libs"; fi; done; export LD_LIBRARY_PATH; fi; \
</span><span class='line'>  cd ./subversion/bindings/swig/python; \
</span><span class='line'>    python2.7 /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/python/tests/run_all.py
</span><span class='line'>...........................................................................................................................
</span><span class='line'>----------------------------------------------------------------------
</span><span class='line'>Ran 123 tests in 301.417s
</span><span class='line'>
</span><span class='line'>OK
</span><span class='line'>make[2]: Leaving directory `/home/ubuntu/build/subversion/subversion-1.8.0/BUILD'
</span><span class='line'>set -e; for v in 2.7; do rm -f BUILD/subversion/bindings/swig/python; ln -fs python$v-dbg BUILD/subversion/bindings/swig/python; pylib=$(python$v -c 'from distutils import sysconfig; print sysconfig.get_python_lib()');  /usr/bin/make -C BUILD check-swig-py PYTHON=python$v-dbg PYVER=${v}_d PYTHON_INCLUDES=-I/usr/include/python${v}_d CLEANUP=1 LC_ALL=C; done
</span><span class='line'>make[2]: Entering directory `/home/ubuntu/build/subversion/subversion-1.8.0/BUILD'
</span><span class='line'>if [ "LD_LIBRARY_PATH" = "DYLD_LIBRARY_PATH" ]; then for d in ./subversion/bindings/swig/python/libsvn_swig_py ./subversion/bindings/swig/python/../../../libsvn_*; do if [ -n "$DYLD_LIBRARY_PATH" ]; then LD_LIBRARY_PATH="$LD_LIBRARY_PATH:$d/.libs"; else LD_LIBRARY_PATH="$d/.libs"; fi; done; export LD_LIBRARY_PATH; fi; \
</span><span class='line'>  cd ./subversion/bindings/swig/python; \
</span><span class='line'>    python2.7-dbg /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/python/tests/run_all.py
</span><span class='line'>........................Fatal Python error: subversion/bindings/swig/python/svn_client.c:23145 object at 0x399b498 has negative ref count -2604246222170760230
</span><span class='line'>/bin/bash: line 2: 16967 Aborted                 (core dumped) python2.7-dbg /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/python/tests/run_all.py
</span><span class='line'>make[2]: *** [check-swig-py] Error 134
</span><span class='line'>make[2]: Leaving directory `/home/ubuntu/build/subversion/subversion-1.8.0/BUILD'
</span><span class='line'>make[1]: *** [check-swig-py] Error 2
</span><span class='line'>make[1]: Leaving directory `/home/ubuntu/build/subversion/subversion-1.8.0'
</span><span class='line'>make: *** [debian/stamp-build-arch] Error 2
</span><span class='line'>dpkg-buildpackage: error: debian/rules build gave error exit status 2</span></code></pre></td></tr></table></div></figure>


<p>Quercheck: subversion-1.8.0.tar.bz2 entpacken und dort dann</p>

<ul>
<li><code>./configure</code></li>
<li><code>make</code> &hellip; keine Probleme</li>
<li><code>make test</code> &hellip; &ldquo;nothing to be done&rdquo;</li>
<li><p><code>make check</code> &hellip; &ldquo;All tests successful.&rdquo;</p>

<pre><code>XFAIL: wc_tests.py 6: add file with not-parent symlink
Summary of test results:
 1909 tests PASSED
 55 tests SKIPPED
 28 tests XFAILED (1 WORK-IN-PROGRESS)
SUMMARY: All tests successful.
</code></pre></li>
<li><p><code>make check-swig-py</code> &hellip; keine Probleme</p></li>
</ul>


<p>Ich editiere debian/rules und deaktiviere &ldquo;call allpydbg&rdquo; in &ldquo;check-swig-py&rdquo;.</p>

<h2>Vierte Hürde: Ruby-Tests brechen ab</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>...
</span><span class='line'>/usr/bin/make -C BUILD check-swig-rb CLEANUP=1 LC_ALL=C
</span><span class='line'>make[2]: Entering directory `/home/ubuntu/build/subversion/subversion-1.8.0/BUILD'
</span><span class='line'>if [ "LD_LIBRARY_PATH" = "DYLD_LIBRARY_PATH" ]; then for d in ./subversion/bindings/swig/python/libsvn_swig_rb ./subversion/bindings/swig/python/../../../libsvn_*; do if [ -n "$DYLD_LIBRARY_PATH" ]; then LD_LIBRARY_PATH="$LD_LIBRARY_PATH:$d/.libs"; else LD_LIBRARY_PATH="$d/.libs"; fi; done; export LD_LIBRARY_PATH; fi; \
</span><span class='line'>  cd ./subversion/bindings/swig/ruby; \
</span><span class='line'>          if [ "1" -eq 1 -a "8" -lt 9 ] ; then \
</span><span class='line'>            /usr/bin/ruby1.8 -I /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby \
</span><span class='line'>              /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby/test/run-test.rb \
</span><span class='line'>        --verbose=normal; \
</span><span class='line'>          else \
</span><span class='line'>      /usr/bin/ruby1.8 -I /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby \
</span><span class='line'>        /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby/test/run-test.rb; \
</span><span class='line'>          fi
</span><span class='line'>/home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby/test/util.rb:22:in `require': no such file to load -- ./svn/util (LoadError)
</span><span class='line'>  from /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby/test/util.rb:22
</span><span class='line'>  from /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby/test/run-test.rb:37:in `require'
</span><span class='line'>  from /home/ubuntu/build/subversion/subversion-1.8.0/subversion/bindings/swig/ruby/test/run-test.rb:37
</span><span class='line'>make[2]: *** [check-swig-rb] Error 1
</span><span class='line'>make[2]: Leaving directory `/home/ubuntu/build/subversion/subversion-1.8.0/BUILD'
</span><span class='line'>make[1]: *** [check-swig-rb] Error 2
</span><span class='line'>make[1]: Leaving directory `/home/ubuntu/build/subversion/subversion-1.8.0'
</span><span class='line'>make: *** [debian/stamp-build-arch] Error 2
</span><span class='line'>dpkg-buildpackage: error: debian/rules build gave error exit status 2</span></code></pre></td></tr></table></div></figure>


<p>Das habe ich korrigiert durch Änderungen an ./subversion/bindings/swig/ruby/test/run-test.rb:</p>

<figure class='code'><figcaption><span>run-test.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gd">--- subversion/bindings/swig/ruby/test/util.rb~ 2013-05-29 04:00:11.000000000 +0000</span>
</span><span class='line'><span class="gi">+++ subversion/bindings/swig/ruby/test/util.rb   2013-07-10 09:22:24.845441319 +0000</span>
</span><span class='line'><span class="gu">@@ -19,7 +19,7 @@</span>
</span><span class='line'>
</span><span class='line'> require &quot;fileutils&quot;
</span><span class='line'> require &quot;pathname&quot;
</span><span class='line'><span class="gd">-require &quot;./svn/util&quot;</span>
</span><span class='line'><span class="gi">+require &quot;svn/util&quot;</span>
</span><span class='line'> require &quot;tmpdir&quot;
</span><span class='line'>
</span><span class='line'> require &quot;my-assertions&quot;
</span></code></pre></td></tr></table></div></figure>


<h2>Fünfte Hürde: Verpacken bricht ab wegen fehlenjder Dateien</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>...
</span><span class='line'>make[1]: Leaving directory `/home/ubuntu/build/subversion/subversion-1.8.0/BUILD'
</span><span class='line'>find debian/tmp/usr/lib/ruby \( -name \*.a -o -name \*.la \) -exec rm -f {} +
</span><span class='line'>cd debian/tmp//usr/lib/x86_64-linux-gnu; for lib in ra fs auth swig; do \
</span><span class='line'>      rm -f libsvn_${lib}_*.so libsvn_${lib}_*.la; \
</span><span class='line'>  done
</span><span class='line'>cd debian/tmp//usr/lib/x86_64-linux-gnu; rm -f libsvn_swig*.a libsvnjavahl.a libsvnjavahl.la
</span><span class='line'># Intermediate hack, until we can remove the rest of the .la files.
</span><span class='line'>sed -i  "/dependency_libs/s/=.*/=''/" debian/tmp//usr/lib/x86_64-linux-gnu/*.la
</span><span class='line'>dh_install -s
</span><span class='line'>dh_install: libapache2-svn missing files (debian/tmp/usr/lib/apache2/modules/*.so), aborting
</span><span class='line'>make: *** [debian/stamp-install-arch] Error 2
</span><span class='line'>dpkg-buildpackage: error: fakeroot debian/rules binary gave error exit status 2</span></code></pre></td></tr></table></div></figure>


<p>Das habe ich korrigiert durch Änderungen an ./debian/libapache2-svn.install:</p>

<figure class='code'><figcaption><span>libapache2-svn.install </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'>ubuntu@ubuntu1204-64-build:~/build/subversion/subversion-1.8.0$ diff -u debian/libapache2-svn.install~ debian/libapache2-svn.install
</span><span class='line'><span class="gd">--- debian/libapache2-svn.install~   2013-07-06 06:31:05.000000000 +0000</span>
</span><span class='line'><span class="gi">+++ debian/libapache2-svn.install    2013-07-10 11:08:06.525738591 +0000</span>
</span><span class='line'><span class="gu">@@ -1,4 +1,4 @@</span>
</span><span class='line'><span class="gd">-debian/tmp/usr/lib/apache2/modules/*.so     usr/lib/apache2/modules</span>
</span><span class='line'><span class="gi">+debian/tmp/usr/libexec/*.so         usr/lib/apache2/modules</span>
</span><span class='line'> debian/dav_svn.conf                             etc/apache2/mods-available
</span><span class='line'> debian/dav_svn.load                             etc/apache2/mods-available
</span><span class='line'> debian/authz_svn.load                           etc/apache2/mods-available
</span></code></pre></td></tr></table></div></figure>


<p>Danach kann dann mit <code>fakeroot debian/rules binary</code> die Verpackung ohne erneute Kompilierung getestet werden.</p>

<h2>Nochmals komplett: Paketerzeugung läuft durch</h2>

<p>Nach den vorigen Änderungen kann die Paketerzeugung mit</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dpkg-buildpackage</span></code></pre></td></tr></table></div></figure>


<p>komplett erfolgreich durchgezogen werden!</p>

<h2>Kurztests: Installation und Funktionsweise</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo dpkg -i subversion_1.8.0-3dp12~precise1_amd64.deb libsvn1_1.8.0-3dp12~precise1_amd64.deb libserf1_1.2.1-0dp01~precise1_amd64.deb
</span><span class='line'>$ sudo dpkg -i sqlite3_3.7.15.2-1dp01~precise1_amd64.deb libsqlite3-0_3.7.15.2-1dp01~precise1_amd64.deb
</span><span class='line'>$ svn --version
</span><span class='line'>svn, Version 1.8.0 (r1490375)
</span><span class='line'>   übersetzt am Jul 10 2013, um 11:15:47 auf x86_64-pc-linux-gnu
</span><span class='line'>
</span><span class='line'>Copyright (C) 2013 The Apache Software Foundation.
</span><span class='line'>Diese Software besteht aus Beiträgen vieler Personen;
</span><span class='line'>siehe Datei NOTICE für weitere Informationen.
</span><span class='line'>Subversion ist Open Source Software, siehe http://subversion.apache.org/
</span><span class='line'>
</span><span class='line'>Die folgenden ZugriffsModule (ZM) für Projektarchive stehen zur Verfügung:
</span><span class='line'>
</span><span class='line'>* ra_svn : Modul zum Zugriff auf ein Projektarchiv über das svn-Netzwerkprotokoll.
</span><span class='line'>  - mit Cyrus-SASL-Authentifizierung
</span><span class='line'>  - behandelt Schema »svn«
</span><span class='line'>* ra_local : Modul zum Zugriff auf ein Projektarchiv auf der lokalen Festplatte
</span><span class='line'>  - behandelt Schema »file«
</span><span class='line'>* ra_serf : Modul zum Zugriff auf ein Projektarchiv über das Protokoll WebDAV mittels serf.
</span><span class='line'>  - behandelt Schema »http«
</span><span class='line'>  - behandelt Schema »https«
</span><span class='line'>$ cd svn/my-project
</span><span class='line'>$ svn status
</span><span class='line'>svn: E155036: Please see the 'svn upgrade' command
</span><span class='line'>svn: E155036: The working copy at '/home/uli/svn/my-project'
</span><span class='line'>is too old (format 29) to work with client version '1.8.0 (r1490375)' (expects format 31). You need to upgrade the working copy first.
</span><span class='line'>$ svn upgrade
</span><span class='line'>$ svn status
</span><span class='line'>$ svn update
</span><span class='line'>svn: E175009: XML parsing failed: (411 Length Required)
</span><span class='line'>$ svn checkout https://.....
</span><span class='line'>svn: E235000: In file '/home/ubuntu/build/subversion/subversion-1.8.0/subversion/libsvn_client/ra.c' line 647: assertion failed (peg_revnum != SVN_INVALID_REVNUM)
</span><span class='line'>Aborted (core dumped)</span></code></pre></td></tr></table></div></figure>


<p>Also: Leider funktioniert&rsquo;s nicht.</p>

<h2>Zurück zur alten Version</h2>

<p>Auf dem Rechner, den ich zum Testen verwendet habe, geht&rsquo;s
so zurück zu den alten Versionen:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install libsqlite3-0=3.7.9* sqlite3=3.7.9*
</span><span class='line'>$ sudo apt-get install subversion=1.7.10* libsvn1=1.7.10*
</span><span class='line'>$ sudo apt-get install libserf1=1.0*</span></code></pre></td></tr></table></div></figure>


<p>Auf dem Rechner, den ich zum Bauen verwendet habe, geht&rsquo;s
so zurück zu den alten Versionen:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install libsqlite3-0=3.7.9* sqlite3=3.7.9*
</span><span class='line'>$ sudo apt-get install libserf1=1.0*</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Lesegeschwindigkeit von USB-Sticks]]></title>
    <link href="http://uli-heller.github.com/blog/2013/07/10/usb_speed/"/>
    <updated>2013-07-10T08:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/07/10/usb_speed</id>
    <content type="html"><![CDATA[<p>Nachfolgend ein Vergleich der Lesegeschwindigkeiten von 3 USB-Sticks,
die ich hier rumliegen habe:</p>

<ul>
<li>ein etwas älterer USB-3.0-Stick</li>
<li>ein neuer und ganz kleiner USB-2.0-Stick</li>
<li>ein neuer USB-3.0-Stick</li>
</ul>


<p>Die Lesegeschwindigkeiten messe ich mit <code>hdparm</code> unter Linux auf</p>

<ul>
<li>meinem Samsung-Laptop mit USB-2.0 und USB-3.0</li>
<li>meinem HP-Desktop mit USB-2.0</li>
<li>meinem Macbook Air mit USB-3.0</li>
</ul>


<!-- more -->


<h2>USB-Sticks</h2>

<h3>Sony Micro Vault 64 GB USB 3.0</h3>

<p>Vom Format her ein etwas größerer USB-Stick, ist auch schon etwas älter.
Bei Amazon: <a href="http://www.amazon.de/Sony-Micro-Vault-Match-Speicherstick/dp/B006EK0LZO">http://www.amazon.de/Sony-Micro-Vault-Match-Speicherstick/dp/B006EK0LZO</a></p>

<h3>Sandisk Cruzer Fit 32 GB USB 2.0</h3>

<p>Ein sehr kleiner USB-Stick, recht billig (16€ bei MediaMarkt)
aber wahrscheinlich auch etwas langsam.
Bei Amazon: <a href="http://www.amazon.de/Sandisk-Cruzer-Fit-Speicherstick-32GB/dp/B00812F7O8">http://www.amazon.de/Sandisk-Cruzer-Fit-Speicherstick-32GB/dp/B00812F7O8</a></p>

<h3>Sandisk Extreme 64 GB USB 3.0</h3>

<p>Vom Format her ein etwas größerer USB-Stick. Laut Packung</p>

<ul>
<li>bis zu 190 MB/s lesend</li>
<li>bis zu 170 MB/s schreibend</li>
</ul>


<p>Bei Amazon: <a href="http://www.amazon.de/SanDisk-Cruzer-Extreme-Speicherstick-64GB/dp/B007YXA5SI">http://www.amazon.de/SanDisk-Cruzer-Extreme-Speicherstick-64GB/dp/B007YXA5SI</a></p>

<h2>Samsung Notebook</h2>

<h3>USB-3.0</h3>

<h4>Sony</h4>

<pre><code>~$ sudo hdparm -tT /dev/sdb

/dev/sdb:
 Timing cached reads:   3894 MB in  2.00 seconds = 1947.79 MB/sec
 Timing buffered disk reads: 304 MB in  3.00 seconds = 101.20 MB/sec
</code></pre>

<h4>Sandisk 32GB</h4>

<pre><code>~$ sudo hdparm -tT /dev/sdb

/dev/sdb:
 Timing cached reads:   3878 MB in  2.00 seconds = 1939.72 MB/sec
 Timing buffered disk reads:  64 MB in  3.04 seconds =  21.08 MB/sec
</code></pre>

<h4>Sandisk 64GB</h4>

<pre><code>~$ sudo hdparm -tT /dev/sdb

/dev/sdb:
 Timing cached reads:   3994 MB in  2.00 seconds = 1997.93 MB/sec
 Timing buffered disk reads: 414 MB in  3.01 seconds = 137.37 MB/sec
</code></pre>

<h3>USB-2.0</h3>

<h4>Sony</h4>

<pre><code>~$ sudo hdparm -tT /dev/sdb

/dev/sdb:
 Timing cached reads:   3728 MB in  2.00 seconds = 1864.37 MB/sec
 Timing buffered disk reads:  96 MB in  3.00 seconds =  31.98 MB/sec
</code></pre>

<h4>Sandisk 32GB</h4>

<pre><code>~$ sudo hdparm -tT /dev/sdb

/dev/sdb:
 Timing cached reads:   3732 MB in  2.00 seconds = 1867.17 MB/sec
 Timing buffered disk reads:  62 MB in  3.02 seconds =  20.53 MB/sec
</code></pre>

<h4>Sandisk 64GB</h4>

<pre><code>~$ sudo hdparm -tT /dev/sdb

/dev/sdb:
 Timing cached reads:   3810 MB in  2.00 seconds = 1905.59 MB/sec
 Timing buffered disk reads:  96 MB in  3.01 seconds =  31.89 MB/sec
</code></pre>

<h2>HP Desktop</h2>

<p>Nur USB-2.0 verfügbar!</p>

<h3>Sony</h3>

<pre><code>~$ sudo hdparm -tT /dev/sdh

/dev/sdh:
 Timing cached reads:   19494 MB in  2.00 seconds = 9756.41 MB/sec
 Timing buffered disk reads:  98 MB in  3.04 seconds =  32.23 MB/sec
</code></pre>

<h3>Sandisk 32GB</h3>

<pre><code>~$ sudo hdparm -tT /dev/sdh

/dev/sdh:
 Timing cached reads:   19098 MB in  2.00 seconds = 9557.98 MB/sec
 Timing buffered disk reads:  64 MB in  3.06 seconds =  20.92 MB/sec
</code></pre>

<h3>Sandisk 64GB</h3>

<pre><code>~$ sudo hdparm -tT /dev/sdh

/dev/sdh:
 Timing cached reads:   19272 MB in  2.00 seconds = 9645.16 MB/sec
 Timing buffered disk reads:  98 MB in  3.01 seconds =  32.58 MB/sec
</code></pre>

<h2>Macbook Air 2013</h2>

<p>Nur USB-3.0 verfügbar!</p>

<h3>Sony</h3>

<pre><code>~$ sudo hdparm -tT /dev/sdc

/dev/sdc:
 Timing cached reads:   8598 MB in  2.00 seconds = 4302.41 MB/sec
 Timing buffered disk reads: 382 MB in  3.00 seconds = 127.20 MB/sec
</code></pre>

<h3>Sandisk 32GB</h3>

<pre><code>~$ sudo hdparm -tT /dev/sdc

/dev/sdc:
 Timing cached reads:   8518 MB in  2.00 seconds = 4262.42 MB/sec
 Timing buffered disk reads:  66 MB in  3.03 seconds =  21.78 MB/sec
</code></pre>

<h3>Sandisk 64GB</h3>

<pre><code>~$ sudo hdparm -tT /dev/sdc

/dev/sdc:
 Timing cached reads:   8834 MB in  2.00 seconds = 4421.16 MB/sec
 Timing buffered disk reads: 482 MB in  3.01 seconds = 160.34 MB/sec
</code></pre>

<h2>Fazit</h2>

<p>Der kleine billige Sandisk-USB-Ministick ist erwartungsgemäß recht langsam.
Wenn man keine USB-3.0-Schnittstelle zur Verfügung hat, fällt das nicht
sonderlich in&rsquo;s Gewicht (20 MB/sec vs 30 MB/sec). Hat man aber eine
USB-3.0-Schnittstelle, so erreichen die größeren Sticks grob mehr als
5-fachen Durchsatz vom Ministick.</p>

<p>Der neue Sandisk-Stick ist etwa 25% schneller als der alte Sony-Stick.
Das Macbook Air 2013 erreicht bei USB-3.0 auch etwa 25% höheren Durchsatz
wie mein altes Samsung-Notebook.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Markdowneditor in Eclipse]]></title>
    <link href="http://uli-heller.github.com/blog/2013/07/03/eclipse_markdown/"/>
    <updated>2013-07-03T08:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/07/03/eclipse_markdown</id>
    <content type="html"><![CDATA[<p>Gemäß <a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=329528">https://bugs.eclipse.org/bugs/show_bug.cgi?id=329528</a>
sollte Markdown von Eclipse unterstützt werden. Leider gibt&rsquo;s
in Eclipse-4.3 (Kepler) keine Spur davon&hellip;</p>

<!-- more -->


<p>Ich verwende die meiste Zeit die &ldquo;Eclipse IDE for Java EE Developers&rdquo;.
Da sind die Wiki-Edit-Tools gleich mit enthalten. Eine Datei im
.textile-Format kann problemlos editiert werden, leider aber keine
im .markdown-Format.</p>

<p>Abhilfe schafft die Installation der &ldquo;Mylyn Docs&rdquo; von
<a href="http://download.eclipse.org/mylyn/snapshots/nightly/docs/">http://download.eclipse.org/mylyn/snapshots/nightly/docs/</a>.
Ich habe einfach alle &ldquo;Mylyn Docs Features&rdquo; installiert, Eclipse neu
gestartet und danach wird bei &ldquo;Rechts-Klick&rdquo; in &ldquo;Markup Language&rdquo;
auch Markdown angezeigt.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Experimente mit CentOS-6.4]]></title>
    <link href="http://uli-heller.github.com/blog/2013/06/27/centos/"/>
    <updated>2013-06-27T08:00:00+02:00</updated>
    <id>http://uli-heller.github.com/blog/2013/06/27/centos</id>
    <content type="html"><![CDATA[<p>Heute habe ich mir vorgenommen, ein paar Experimente mit CentOS
durchzuführen. CentOS ist eine Linux-Distribution, die den Anspruch
hat, weitgehend kompatibel zu RedHat Enterprise Linux (RHEL) ist.
Meine Hoffnung ist, dass sich die Erkenntnisse, die ich heute sammle,
auch in einem anstehenden Kundenprojekt anwenden lassen, bei dem RHEL
zum Einsatz kommen wird.</p>

<!-- more -->


<h2>Grundinstallation</h2>

<script src="http://uli-heller.github.com/javascripts/fotorama/jquery-1.10.2.min.js"></script>


<p><link href="http://uli-heller.github.com/javascripts/fotorama/fotorama.css" rel="stylesheet"><script src="http://uli-heller.github.com/javascripts/fotorama/fotorama.js"></script><div class="fotorama" data-autoplay="3000" data-transition="dissolve" data-nav="thumbs" data-allow-full-screen="true" data-keyboard="true" data-width="640" data-height="480" data-thumb-with="64" data-thumb-height="48"><a href="http://uli-heller.github.com/images/galleries/centos/scaled/001-new-vm.png" data-full="/images/galleries/centos/001-new-vm.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/001-new-vm.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/002-new-vm.png" data-full="/images/galleries/centos/002-new-vm.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/002-new-vm.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/003-new-vm.png" data-full="/images/galleries/centos/003-new-vm.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/003-new-vm.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/004-new-vm-harddisk.png" data-full="/images/galleries/centos/004-new-vm-harddisk.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/004-new-vm-harddisk.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/005-new-vm-harddisk.png" data-full="/images/galleries/centos/005-new-vm-harddisk.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/005-new-vm-harddisk.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/006-new-vm-harddisk.png" data-full="/images/galleries/centos/006-new-vm-harddisk.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/006-new-vm-harddisk.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/007-vm.png" data-full="/images/galleries/centos/007-vm.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/007-vm.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/008-vm-boot-dvd.png" data-full="/images/galleries/centos/008-vm-boot-dvd.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/008-vm-boot-dvd.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/009-boot-dvd.png" data-full="/images/galleries/centos/009-boot-dvd.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/009-boot-dvd.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/010-booting-from-dvd.png" data-full="/images/galleries/centos/010-booting-from-dvd.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/010-booting-from-dvd.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/011-skip-check.png" data-full="/images/galleries/centos/011-skip-check.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/011-skip-check.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/012-welcome.png" data-full="/images/galleries/centos/012-welcome.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/012-welcome.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/013-language.png" data-full="/images/galleries/centos/013-language.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/013-language.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/014-keyboard.png" data-full="/images/galleries/centos/014-keyboard.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/014-keyboard.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/015-init-hd.png" data-full="/images/galleries/centos/015-init-hd.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/015-init-hd.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/016-timezone.png" data-full="/images/galleries/centos/016-timezone.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/016-timezone.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/017-root.png" data-full="/images/galleries/centos/017-root.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/017-root.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/018-root-is-too-short.png" data-full="/images/galleries/centos/018-root-is-too-short.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/018-root-is-too-short.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/019-rootroot.png" data-full="/images/galleries/centos/019-rootroot.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/019-rootroot.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/020-use-anyway.png" data-full="/images/galleries/centos/020-use-anyway.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/020-use-anyway.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/021-partitioning.png" data-full="/images/galleries/centos/021-partitioning.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/021-partitioning.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/022-write-to-disk.png" data-full="/images/galleries/centos/022-write-to-disk.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/022-write-to-disk.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/023-installing.png" data-full="/images/galleries/centos/023-installing.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/023-installing.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/024-booting.png" data-full="/images/galleries/centos/024-booting.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/024-booting.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/025-login.png" data-full="/images/galleries/centos/025-login.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/025-login.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/026-root-rootroot.png" data-full="/images/galleries/centos/026-root-rootroot.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/026-root-rootroot.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/027-network.png" data-full="/images/galleries/centos/027-network.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/027-network.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/028-yum-update.png" data-full="/images/galleries/centos/028-yum-update.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/028-yum-update.png" data-fit="scaledown"/></a><a href="http://uli-heller.github.com/images/galleries/centos/scaled/029-yum-update.png" data-full="/images/galleries/centos/029-yum-update.png" data-fit="scaledown"><img src="http://uli-heller.github.com/images/galleries/centos/thumbs/029-yum-update.png" data-fit="scaledown"/></a></div> <!--class="fotorama" data-nav="thumbs" --></p>

<h2>Netzwerk konfigurieren</h2>

<p>Hierzu muß die Datei /etc/sysconfig/network-scripts/ifcfg-eth0
angepasst werden:</p>

<figure class='code'><figcaption><span>/etc/sysconfig/network-scripts/ifcfg-eth0 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gd">- ONBOOT=no</span>
</span><span class='line'><span class="gi">+ ONBOOT=yes</span>
</span></code></pre></td></tr></table></div></figure>


<p>Nach einem Reboot oder nach <code>/etc/init.d/network restart</code>
 wird die Schnittstelle dann automatisch konfiguriert
via DHCP. Mit <code>ifconfig eth0</code> kann man auch die IP-Adresse abfragen.</p>

<h2>Aktualisierungen einspielen</h2>

<p>Nachdem das Netzwerk konfiguriert ist, können mit <code>yum update</code>
die Aktualisierungen eingespielt werden.</p>

<h2>Zusatzpakete einspielen</h2>

<h3>EPEL</h3>

<ul>
<li>Sichten von <a href="http://dl.fedoraproject.org/pub/epel/6/i386">http://dl.fedoraproject.org/pub/epel/6/i386</a></li>
<li>Neueste Version von EPEL identifizieren: epel-release-6-8.noarch.rpm</li>
<li>EPEL runterladen: <code>curl http://dl.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm &gt;epel-release-6-8.noarch.rpm</code></li>
<li>EPEL installieren: <code>rpm -Uvh epel-release-6-8.noarch.rpm</code></li>
</ul>


<h3>Zusatzpakete</h3>

<figure class='code'><figcaption><span>Zusatzpakete einspielen </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yum install openssh-clients
</span><span class='line'>yum install joe
</span><span class='line'>yum install httpd # apache httpd 2.2.15</span></code></pre></td></tr></table></div></figure>


<h2>Sichtung von Apache HTTPD</h2>

<h3>Version</h3>

<p>Schon bei der Einspielung der Zusatzpakete wurde klar, dass vom
Apache HTTPD die Version 2.2.15 verfügbar ist &ndash; ist also eine etwas ältere
Version.</p>

<h3>Module</h3>

<p>Nun interessieren noch die verfügbaren Erweiterungsmodule. Diese liegen
unter /etc/httpd/modules:</p>

<ul>
<li>mod_actions.so</li>
<li>mod_alias.so</li>
<li>mod_asis.so</li>
<li>mod_auth_basic.so</li>
<li>mod_auth_digest.so</li>
<li>mod_authn_alias.so</li>
<li>mod_authn_anon.so</li>
<li>mod_authn_dbd.so</li>
<li>mod_authn_dbm.so</li>
<li>mod_authn_default.so</li>
<li>mod_authn_file.so</li>
<li>mod_authnz_ldap.so</li>
<li>mod_authz_dbm.so</li>
<li>mod_authz_default.so</li>
<li>mod_authz_groupfile.so</li>
<li>mod_authz_host.so</li>
<li>mod_authz_owner.so</li>
<li>mod_authz_user.so</li>
<li>mod_autoindex.so</li>
<li>mod_cache.so</li>
<li>mod_cern_meta.so</li>
<li>mod_cgid.so</li>
<li>mod_cgi.so</li>
<li>mod_dav_fs.so</li>
<li>mod_dav.so</li>
<li>mod_dbd.so</li>
<li>mod_deflate.so</li>
<li>mod_dir.so</li>
<li>mod_disk_cache.so</li>
<li>mod_dumpio.so</li>
<li>mod_env.so</li>
<li>mod_expires.so</li>
<li>mod_ext_filter.so</li>
<li>mod_filter.so</li>
<li>mod_headers.so</li>
<li>mod_ident.so</li>
<li>mod_include.so</li>
<li>mod_info.so</li>
<li>mod_ldap.so</li>
<li>mod_log_config.so</li>
<li>mod_log_forensic.so</li>
<li>mod_logio.so</li>
<li>mod_mime_magic.so</li>
<li>mod_mime.so</li>
<li>mod_negotiation.so</li>
<li>mod_proxy_ajp.so</li>
<li>mod_proxy_balancer.so</li>
<li>mod_proxy_connect.so</li>
<li>mod_proxy_ftp.so</li>
<li>mod_proxy_http.so</li>
<li>mod_proxy_scgi.so</li>
<li>mod_proxy.so</li>
<li>mod_reqtimeout.so</li>
<li>mod_rewrite.so</li>
<li>mod_setenvif.so</li>
<li>mod_speling.so</li>
<li>mod_status.so</li>
<li>mod_substitute.so</li>
<li>mod_suexec.so</li>
<li>mod_unique_id.so</li>
<li>mod_userdir.so</li>
<li>mod_usertrack.so</li>
<li>mod_version.so</li>
<li>mod_vhost_alias.so</li>
</ul>


<h3>Automatischer Start</h3>

<figure class='code'><figcaption><span>Automatischer Start </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># chkconfig | grep httpd</span>
</span><span class='line'>httpd             0:off   1:off   2:off   3:off   4:off   5:off   6:off
</span><span class='line'><span class="c"># chkconfig httpd on</span>
</span><span class='line'><span class="c"># chkconfig | grep httpd</span>
</span><span class='line'>httpd             0:off   1:off   2:on    3:on    4:on    5:on    6:off
</span></code></pre></td></tr></table></div></figure>


<p>Danach: Reboot und Test, ob der Prozess &ldquo;httpd&rdquo; läuft.</p>

<h3>Firewall öffnen</h3>

<figure class='code'><figcaption><span>/etc/sysconfig/iptables </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gd">--- iptables~   2013-06-26 08:07:03.000000000 +0200</span>
</span><span class='line'><span class="gi">+++ iptables 2013-06-26 09:34:09.638267508 +0200</span>
</span><span class='line'><span class="gu">@@ -8,6 +8,8 @@</span>
</span><span class='line'> -A INPUT -p icmp -j ACCEPT
</span><span class='line'> -A INPUT -i lo -j ACCEPT
</span><span class='line'> -A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT
</span><span class='line'><span class="gi">+-A INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT</span>
</span><span class='line'><span class="gi">+-A INPUT -m state --state NEW -m tcp -p tcp --dport 443 -j ACCEPT</span>
</span><span class='line'> -A INPUT -j REJECT --reject-with icmp-host-prohibited
</span><span class='line'> -A FORWARD -j REJECT --reject-with icmp-host-prohibited
</span><span class='line'> COMMIT
</span></code></pre></td></tr></table></div></figure>


<p>Danach dann Neustart der Firewall mit <code>/etc/init.d/iptables restart</code>.
Jetzt sollte man im Browser die Begrüßungsseite sehen können:
<a href="http://192.168.56.101">http://192.168.56.101</a>.</p>
]]></content>
  </entry>
  
</feed>
