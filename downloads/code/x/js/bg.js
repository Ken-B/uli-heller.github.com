var g_extensionid=chrome.i18n.getMessage("@@extension_id");var storagedefault={change_enable:[false,0],log_enable:[false,0],log_config:['{"type":[],"method":""}',0],change_type:["[]",0],ua_data:['[{"ab":"IE6","name":"Internet Explorer 6","uastring":"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322)"},{"ab":"IE7","name":"Internet Explorer 7","uastring":"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30)"},{"ab":"IE8","name":"Internet Explorer 8","uastring":"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)"},{"ab":"IE9","name":"Internet Explorer 9","uastring":"Mozilla/5.0 (MSIE 9.0; Windows NT 6.1; Trident/5.0)"},{"ab":"IE10","name":"Internet Explorer 10","uastring":"Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)"},{"ab":"A2.3","name":"Android 2.3","uastring":"Mozilla/5.0 (Linux; U; Android 2.3; en-us) AppleWebKit/999+ (KHTML, like Gecko) Safari/999.9"},{"ab":"iPad","name":"iPad","uastring":"Mozilla/5.0 (iPad; U; CPU OS 3_2 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Version/4.0.4 Mobile/7B334b Safari/531.21.10"},{"ab":"iPh4","name":"iPhone 4","uastring":"Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_2 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8H7 Safari/6533.18.5"},{"ab":"NK7","name":"Nokia 7110","uastring":"Nokia 7110/1.0"},{"ab":"WP7","name":"Windows Phone 7","uastring":"Mozilla/4.0 (compatible; MSIE 7.0; Windows Phone OS 7.0; Trident/3.1; IEMobile/7.0) Asus;Galaxy6"},{"ab":"F3.6","name":"Firefox 3.6","uastring":"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.4410) Gecko/20110902 Firefox/3.6"},{"ab":"F9.0","name":"Firefox 9.0","uastring":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20100101 Firefox/9.0"},{"ab":"SF5","name":"Safari 5.0.4","uastring":"Mozilla/5.0 (Windows; U; Windows NT 6.1; tr-TR) AppleWebKit/533.20.25 (KHTML, like Gecko) Version/5.0.4 Safari/533.20.27"},{"ab":"O12","name":"Opera 12.00","uastring":"Opera/9.80 (Windows NT 6.1; U; es-ES) Presto/2.9.181 Version/12.00"},{"ab":"Gbot","name":"Googlebot","uastring":"Googlebot/2.1 (+http://www.googlebot.com/bot.html)"},{"ab":"Ybot","name":"Yahoobot","uastring":"Mozilla/5.0 (compatible; Yahoo! Slurp; http://help.yahoo.com/help/us/ysearch/slurp)"},{"ab":"Bbot","name":"BingBot","uastring":"Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)"}]',0],current_uastring:["",0],current_uaab:["",0],current_uaidx:[-1,0],viewlog_refreshhotkey:["",0],viewlog_refreshhotkey2:[118,0],viewlog_clearhotkey:["",0],viewlog_clearhotkey2:[120,0],viewlog_viewheaderautoclose:[false,0],other_autorefresh:[true,0],req_pattern_enable2:[false,0],req_pattern:['[{"pattern":"http*://www.google.*/*","type":[],"data":[{"name":"User-Agent","value":"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322)"}],"active":true}]',0]};function setStorageDefaults2(a){if(localStorage[a]==null){localStorage[a]=storagedefault[a][0]}}function setStorageDefaults_int(a){s=localStorage[a];if((s==null)||isNaN(parseInt(s))){localStorage[a]=storagedefault[a][0]}}function getStorageDefaults(a){return storagedefault[a][0]}function setStorageDefaults(){for(var b in storagedefault){if(storagedefault[b][1]==1){setStorageDefaults_int(b)}else{setStorageDefaults2(b)}}}try{setStorageDefaults()}catch(err){}var config=function(){this.log_data=[];this.load=function(){this.change_enable=toBool(localStorage.change_enable);this.log_enable=toBool(localStorage.log_enable);this.change_type=[];try{this.change_type=JSON.parse(localStorage.change_type)}catch(g){}this.ua_data=[];try{this.ua_data=JSON.parse(localStorage.ua_data)}catch(g){}this.current_uastring="";this.current_uaab="";this.current_uaidx=parseInt(localStorage.current_uaidx);if((this.current_uaidx>=0)&&(this.current_uaidx<=this.ua_data.length-1)){var d=this.ua_data[this.current_uaidx];this.current_uastring=d.uastring;this.current_uaab=d.ab}else{this.current_uaidx=-1}this.req_pattern_enable2=toBool(localStorage.req_pattern_enable2);this.req_pattern=[];try{this.req_pattern=JSON.parse(localStorage.req_pattern)}catch(g){}var f,c;for(var e=0;e<this.req_pattern.length;++e){c=this.req_pattern[e];f=c.pattern;if(f.indexOf("r/")==0){f=f.substr(2,f.length)}else{f=f.replace(/\./g,"\\.").replace(/\?/g,"\\?").replace(/\x2a/g,"(.*)");f="^"+f+"$"}c.re=null;try{c.re=new RegExp(f)}catch(g){}}}};var g_config=new config();try{g_config.load()}catch(err){}var current_tabid;function proc_gettabid(){chrome.windows.getCurrent(function(b){var a=b.id;chrome.tabs.getSelected(a,function(c){current_tabid=c.id})})}proc_gettabid();chrome.tabs.onSelectionChanged.addListener(function(b,a){current_tabid=b});function proc_intercept(g){function d(k){var c=false;if(k.length==0){c=true}else{for(var l=0;l<k.length;++l){if(k[l]==g.type){c=true;break}}}return c}function f(l){if(!l&&!g_config.log_enable){return}for(var m=0;m<g.requestHeaders.length;++m){if(g.requestHeaders[m].name=="User-Agent"){if(g_config.log_enable){var k={};var c={};k.details=g;k.data=[];c.name="User-Agent";c.value=l;k.data[0]=c;if(g_config.log_data.length>300){g_config.log_data.splice(0,1)}g_config.log_data[g_config.log_data.length]=k}if(l){g.requestHeaders[m].value=l}break}}}if(!g_config.change_enable){return}if(g_config.req_pattern_enable2){var j=g.url;var a;var b="";a=false;for(var e=0;e<g_config.req_pattern.length;e++){if(g_config.req_pattern[e].active&&g_config.req_pattern[e].re){if(j.match(g_config.req_pattern[e].re)){if(d(g_config.req_pattern[e].type)){a=true;var h=g_config.req_pattern[e].data;if(h&&(h.length>0)){b=h[0].value}}break}}}if(a){f(b);return{requestHeaders:g.requestHeaders}}}if(!d(g_config.change_type)){return}f(g_config.current_uastring);return{requestHeaders:g.requestHeaders}}var filter={urls:["<all_urls>"]};var opt_extraInfoSpec=["blocking","requestHeaders"];function proc_init(a){if(a){if((!chrome.webRequest)||(!chrome.webRequest.onBeforeSendHeaders)){alert('"'+chrome.i18n.getMessage("ext_name")+'" does not support this Chrome version.\nPlease upgrade your Chrome browser to latest version. (Chrome 18 or later)');return}}if(chrome.webRequest.onBeforeSendHeaders.hasListener(proc_intercept,filter,opt_extraInfoSpec)){chrome.webRequest.onBeforeSendHeaders.removeListener(proc_intercept,filter,opt_extraInfoSpec)}if(g_config.change_enable){chrome.webRequest.onBeforeSendHeaders.addListener(proc_intercept,filter,opt_extraInfoSpec)}proc_updateicon()}function proc_updateicon(){var a="";if(g_config.change_enable){if(g_config.current_uaidx>=0){a=g_config.current_uaab}else{a="-"}}chrome.browserAction.setBadgeBackgroundColor({color:[198,63,28,255]});chrome.browserAction.setBadgeText({text:a})}function proc_updatecurrent(b){b=parseInt(b);if(b==null||isNaN(b)){b=g_config.current_uaidx}if((b>=0)&&(b<=g_config.ua_data.length-1)){var c=g_config.ua_data[b];g_config.current_uaidx=b;g_config.current_uaab=c.ab;g_config.current_uastring=c.uastring}else{g_config.current_uaidx=-1;g_config.current_uaab="";g_config.current_uastring=""}localStorage.current_uaidx=g_config.current_uaidx;localStorage.current_uaab=g_config.current_uaab;localStorage.current_uastring=g_config.current_uastring;proc_updateicon()}var manifest;function getmanifest(){var a=new XMLHttpRequest();a.open("GET",chrome.extension.getURL("manifest.json"),false);a.onload=function(){manifest=JSON.parse(a.responseText);proc_init()};a.send(null)}getmanifest();